<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.lgyun.system.order.mapper.SelfHelpInvoiceMapper">

    <resultMap id="selfHelpInvoiceDetailsVO" type="com.lgyun.system.order.vo.SelfHelpInvoiceDetailsVO">
        <result property="id" column="id"/>
        <result property="enterpriseId" column="enterprise_id"/>
        <result property="addressId" column="address_id"/>
        <result property="invoicePeopleId" column="invoice_people_id"/>
        <result property="selfHelpInvoiceDetailId" column="self_help_invoice_detail_id"/>
        <result property="handPayId" column="hand_pay_id"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="taxNo" column="invoice_tax_no"/>
        <result property="employeeName" column="shop_user_name"/>
        <result property="phoneNo" column="invoice_tel_no"/>
        <result property="bankName" column="invoice_bank_name"/>
        <result property="bankAccount" column="invoice_account_name"/>
        <result property="chargeMoneyNum" column="charge_money_num"/>
        <result property="invoiceType" column="invoice_type"/>
        <result property="deliverSheetUrl" column="deliver_sheet_url"/>
        <result property="flowContractUrl" column="flow_contract_url"/>
        <result property="businessContractUrl" column="business_contract_url"/>
        <result property="addressName" column="address_name"/>
        <result property="addressPhone" column="address_phone"/>
        <result property="area" column="area"/>
        <result property="city" column="city"/>
        <result property="province" column="province"/>
        <result property="detailedAddress" column="detailed_address"/>
        <result property="idCardName" column="id_card_name"/>
        <result property="idCardNo" column="id_card_no"/>
        <result property="phoneNumber" column="phone_number"/>
        <result property="givePriceDate" column="give_price_date"/>
        <result property="totalTaxFee" column="total_tax_fee"/>
        <result property="basicTaxFee" column="basic_tax_fee"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.SelfHelpInvoiceStatisticsVO" id="selfHelpInvoiceStatisticsVO">
        <result property="num" column="num"/>
        <result property="monthMoney" column="month_money"/>
        <result property="yearMoney" column="year_money"/>
        <result property="allMoney" column="all_money"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.SelfHelpInvoiceListVO" id="selfHelpInvoiceListVO">
        <result property="id" column="id"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="invoiceType" column="invoice_type"/>
        <result property="invoicePrintState" column="invoice_print_state"/>
        <result property="bizType" column="biz_type"/>
        <result property="chargeMoneyNum" column="charge_money_num"/>
        <result property="flowContractUrl" column="flow_contract_url"/>
        <result property="businessContractUrl" column="business_contract_url"/>
        <result property="createTime" column="create_time"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.SelfHelpInvoiceWebVO" id="selfHelpInvoiceWebVO">
        <result property="selfHelpInvoiceId" column="self_help_invoice_id"/>
        <result property="enterpriseId" column="enterprise_id"/>
        <result property="selfHelpInvoiceDetailId" column="self_help_invoice_detail_id"/>
        <result property="addressId" column="address_id"/>
        <result property="invoicePersonId" column="invoice_person_id"/>
        <result property="selfHelpInvoiceFeeId" column="self_help_invoice_fee_id"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="invoiceType" column="invoice_type"/>
        <result property="chargeMoneyNum" column="charge_money_num"/>
        <result property="invoicePeopleName" column="invoice_people_name"/>
        <result property="idCardPic" column="id_card_pic"/>
        <result property="idCardPicBack" column="id_card_pic_back"/>
        <result property="flowContractUrl" column="flow_contract_url"/>
        <result property="businessContractUrl" column="business_contract_url"/>
        <result property="invoiceState" column="invoice_state"/>
        <result property="invoiceDate" column="invoice_date"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.SelfHelpInvoicePayVO" id="selfHelpInvoicePayVO">
        <result property="id" column="id"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="listFile" column="list_file"/>
        <result property="invoicePeopleType" column="invoice_people_type"/>
        <result property="chargeMoneyNum" column="total_pay_provider_fee"/>
        <result property="invoicePeopleName" column="invoice_people_name"/>
        <result property="flowContractUrl" column="flow_contract_url"/>
        <result property="businessContractUrl" column="business_contract_url"/>
        <result property="deliverSheetUrl" column="deliver_sheet_url"/>
        <result property="accountBalanceUrl" column="account_balance_url"/>
        <result property="createTime" column="create_time"/>
    </resultMap>

    <resultMap id="EnterpriseCrowdSourcingVOMap" type="com.lgyun.system.order.vo.SelfHelpInvoiceCrowdSourcingVO">
        <result property="enterpriseId" column="enterprise_id"/>
        <result property="selfHelpInvoiceId" column="self_help_invoice_id"/>
        <result property="selfHelpInvoiceApplyId" column="self_help_invoice_apply_id"/>
        <result property="selfHelpInvoiceApplyProviderId" column="self_help_invoice_apply_provider_id"/>
        <result property="providerSelfHelpInvoiceId" column="provider_self_help_invoice_id"/>
        <result property="selfHelpInvoiceDetailId" column="self_help_invoice_detail_id"/>
        <result property="serviceProviderId" column="service_provider_id"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="ListFile" column="List_file"/>
        <result property="invoiceScanPictures" column="invoice_scan_pictures"/>
        <result property="taxScanPictures" column="tax_scan_pictures"/>
        <result property="updateDatetime" column="update_datetime"/>
        <result property="invoicePrintState" column="invoicePrintState"/>
        <result property="expressSheetNo" column="express_sheet_no"/>
        <result property="expressCompanyName" column="express_company_name"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.YearTradeVO" id="yearTradeVO">
        <result property="janIncome" column="jan_income"/>
        <result property="febIncome" column="feb_income"/>
        <result property="marIncome" column="mar_income"/>
        <result property="aprIncome" column="apr_income"/>
        <result property="mayIncome" column="may_income"/>
        <result property="junIncome" column="jun_income"/>
        <result property="julIncome" column="jul_income"/>
        <result property="augIncome" column="aug_income"/>
        <result property="sepIncome" column="sep_income"/>
        <result property="octIncome" column="oct_income"/>
        <result property="novIncome" column="nov_income"/>
        <result property="decIncome" column="dec_income"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.MonthTradeVO" id="monthTradeVO">
        <result property="oneDayIncome" column="one_day_income"/>
        <result property="twoDayIncome" column="two_day_income"/>
        <result property="threeDayIncome" column="three_day_income"/>
        <result property="fourDayIncome" column="four_day_income"/>
        <result property="fiveDayIncome" column="five_day_income"/>
        <result property="sixDayIncome" column="six_day_income"/>
        <result property="sevenDayIncome" column="seven_day_income"/>
        <result property="eightDayIncome" column="eight_day_income"/>
        <result property="nineDayIncome" column="nine_day_income"/>
        <result property="tenDayIncome" column="ten_day_income"/>
        <result property="elevenDayIncome" column="eleven_day_income"/>
        <result property="twelveDayIncome" column="twelve_day_income"/>
        <result property="thirteenDayIncome" column="thirteen_day_income"/>
        <result property="fourteenDayIncome" column="fourteen_day_income"/>
        <result property="fifteenDayIncome" column="fifteen_day_income"/>
        <result property="sixteenDayIncome" column="sixteen_day_income"/>
        <result property="seventeenDayIncome" column="seventeen_day_income"/>
        <result property="eighteenDayIncome" column="eighteen_day_income"/>
        <result property="nineteenDayIncome" column="nineteen_day_income"/>
        <result property="twentyDayIncome" column="twenty_day_income"/>
        <result property="twentyOneDayIncome" column="twenty_one_day_income"/>
        <result property="twentyTwoDayIncome" column="twenty_two_day_income"/>
        <result property="twentyThreeDayIncome" column="twenty_three_day_income"/>
        <result property="twentyFourDayIncome" column="twenty_four_day_income"/>
        <result property="twentyFiveDayIncome" column="twenty_five_day_income"/>
        <result property="twentySixDayIncome" column="twenty_six_day_income"/>
        <result property="twentySevenDayIncome" column="twenty_seven_day_income"/>
        <result property="twentyEightDayIncome" column="twenty_eight_day_income"/>
        <result property="twentyNineDayIncome" column="twenty_nine_day_income"/>
        <result property="thirtyDayIncome" column="thirty_day_income"/>
        <result property="thirtyOneDayIncome" column="thirty_one_day_income"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.WeekTradeVO" id="weekTradeVO">
        <result property="monIncome" column="mon_income"/>
        <result property="tueIncome" column="tue_income"/>
        <result property="wedIncome" column="wed_income"/>
        <result property="thuIncome" column="thu_income"/>
        <result property="friIncome" column="fri_income"/>
        <result property="satIncome" column="sat_income"/>
        <result property="sunIncome" column="sun_income"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.DayTradeVO" id="dayTradeVO">
        <result property="oneHourIncome" column="one_hour_income"/>
        <result property="twoHourIncome" column="two_hour_income"/>
        <result property="threeHourIncome" column="three_hour_income"/>
        <result property="fourHourIncome" column="four_hour_income"/>
        <result property="fiveHourIncome" column="five_hour_income"/>
        <result property="sixHourIncome" column="six_hour_income"/>
        <result property="sevenHourIncome" column="seven_hour_income"/>
        <result property="eightHourIncome" column="eight_hour_income"/>
        <result property="nineHourIncome" column="nine_hour_income"/>
        <result property="tenHourIncome" column="ten_hour_income"/>
        <result property="elevenHourIncome" column="eleven_hour_income"/>
        <result property="twelveHourIncome" column="twelve_hour_income"/>
        <result property="thirteenHourIncome" column="thirteen_hour_income"/>
        <result property="fourteenHourIncome" column="fourteen_hour_income"/>
        <result property="fifteenHourIncome" column="fifteen_hour_income"/>
        <result property="sixteenHourIncome" column="sixteen_hour_income"/>
        <result property="seventeenHourIncome" column="seventeen_hour_income"/>
        <result property="eighteenHourIncome" column="eighteen_hour_income"/>
        <result property="nineteenHourIncome" column="nineteen_hour_income"/>
        <result property="twentyHourIncome" column="twenty_hour_income"/>
        <result property="twentyOneHourIncome" column="twenty_one_hour_income"/>
        <result property="twentyTwoHourIncome" column="twenty_two_hour_income"/>
        <result property="twentyThreeHourIncome" column="twenty_three_hour_income"/>
        <result property="twentyFourHourIncome" column="twenty_four_hour_income"/>
    </resultMap>

    <select id="getSelfHelpInvoiceDetails" resultMap="selfHelpInvoiceDetailsVO">
        SELECT zs.id, rc.id as enterprise_id, a.id as address_id, sp.id as invoice_people_id, sd.id as self_help_invoice_detail_id,
        hf.id as hand_pay_id, rc.enterprise_name, rc.invoice_tax_no, rc.shop_user_name, rc.invoice_tel_no, rc.invoice_bank_name, rc.invoice_account_name, sd.charge_money_num,
        sd.invoice_type, sd.flow_contract_url, sd.business_contract_url,sd.deliver_sheet_url, a.address_name, a.address_phone, a.area, a.city, a.province,
        a.detailed_address, sp.id_card_name, sp.id_card_no, sp.phone_number,sp.id_card_pic, sp.id_card_pic_back, hf.give_price_date, hf.total_tax_fee, hf.basic_tax_fee,
        hf.basic_tax_fee_rate, hf.invoice_fee, hf.identify_fee FROM diyi_self_help_invoice zs INNER JOIN diyi_enterprise rc
        ON rc.id = zs.enterprise_id INNER JOIN diyi_self_help_invoice_detail sd ON sd.self_help_invoice_id = zs.id
        INNER JOIN diyi_address a ON a.id = zs.address_id INNER JOIN diyi_self_help_invoice_person sp ON sp.id = sd.none_maker_invoice_person_id
        INNER JOIN diyi_self_help_invoice_fee hf ON zs.id = hf.self_help_invoice_id where zs.is_deleted = 0 AND rc.is_deleted = 0 AND sd.is_deleted = 0
        AND a.is_deleted = 0 AND sp.is_deleted = 0 AND hf.is_deleted = 0 AND zs.id = #{selfHelpInvoiceId}
    </select>

    <select id="yearMonthMoney" resultMap="selfHelpInvoiceStatisticsVO">
        SELECT IFNULL(SUM(IF(MONTH(create_time) = MONTH(NOW()), charge_money_num, 0)), 0) AS month_money,
        IFNULL(SUM(IF(YEAR(create_time) = YEAR(NOW()), charge_money_num, 0)), 0) AS year_money
        FROM diyi_self_help_invoice_detail WHERE is_deleted = 0 AND invoice_print_state = 'INVOICESUCCESS'
        AND all_kind_enterprise_id = #{param1} AND invoice_people_type = #{param2}
    </select>

    <select id="selfHelpInvoiceStatistics" resultMap="selfHelpInvoiceStatisticsVO">
        SELECT COUNT(id) AS num, IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 30, charge_money_num, 0)), 0) AS month_money,
        IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 365, charge_money_num, 0)), 0) AS year_money,
        IFNULL(SUM(charge_money_num), 0) AS all_money FROM diyi_self_help_invoice_detail WHERE is_deleted = 0 AND invoice_print_state = 'INVOICESUCCESS'
        AND all_kind_enterprise_id = #{param1} AND invoice_people_type = #{param2}
    </select>

    <select id="selfHelpInvoiceList" resultMap="selfHelpInvoiceListVO">
        SELECT t1.id, t3.enterprise_name, t1.invoice_type, t1.invoice_print_state, t1.charge_money_num, t1.flow_contract_url,
        t1.business_contract_url, t1.create_time FROM diyi_self_help_invoice_detail t1 INNER JOIN diyi_self_help_invoice t2 ON t1.self_help_invoice_id = t2.id
        INNER JOIN diyi_enterprise t3 ON t2.enterprise_id = t3.id WHERE t1.is_deleted = 0 AND t2.is_deleted = 0 AND t3.is_deleted = 0
        AND t1.all_kind_enterprise_id = #{param1} AND t1.invoice_people_type = #{param2}
    </select>

    <select id="findMakerTypeSelfHelpInvoice" resultMap="selfHelpInvoiceWebVO">
        SELECT zs.id AS self_help_invoice_id, rc.id AS enterprise_id, sd.id AS self_help_invoice_detail_id, a.id AS address_id, sp.id AS invoice_person_id,
        hf.id AS self_help_invoice_fee_id, rc.enterprise_name, sd.invoice_type, sd.charge_money_num, sd.invoice_people_name, sp.id_card_pic, sp.id_card_pic_back,
        sd.flow_contract_url, sd.business_contract_url, zs.current_state, zs.confirm_price_datetime FROM diyi_self_help_invoice zs
        INNER JOIN diyi_enterprise rc ON rc.id = zs.enterprise_id
        INNER JOIN diyi_self_help_invoice_detail sd ON sd.self_help_invoice_id = zs.id
        INNER JOIN diyi_address a ON a.id = zs.address_id
        INNER JOIN diyi_self_help_invoice_person sp ON sp.id = sd.none_maker_invoice_person_id
        INNER JOIN diyi_self_help_invoice_fee hf ON zs.id = hf.self_help_invoice_id
        WHERE zs.is_deleted = 0 AND rc.is_deleted = 0 AND sd.is_deleted = 0 AND a.is_deleted = 0 AND sp.is_deleted = 0 AND hf.is_deleted = 0 AND
         zs.apply_enterprise_id = #{param1} and zs.invoice_people_type =#{param2}
        <if test="param3 != null and param3 != ''">
             and sd.invoice_people_name like concat('%', #{param3}, '%')
        </if>
        <if test="param4 != null and param4 != ''">
            and zs.create_time > #{param4}
        </if>
        <if test="param5 != null and param5 != ''">
            and zs.create_time &lt; #{param5}
        </if>
    </select>

    <select id="getSelfHelfInvoiceByEnterpriseId" resultMap="selfHelpInvoicePayVO">
        SELECT t1.id, t3.enterprise_name, t1.list_file, t1.invoice_people_type, t1.total_pay_provider_fee, t2.invoice_people_name, t2.flow_contract_url, t2.business_contract_url,
        t2.deliver_sheet_url, t2.account_balance_url, t1.create_time FROM diyi_self_help_invoice t1 INNER JOIN diyi_self_help_invoice_detail t2 ON t1.id = t2.self_help_invoice_id
        INNER JOIN diyi_enterprise t3 ON t1.enterprise_id = t3.id WHERE t1.is_deleted = 0 AND t2.is_deleted = 0 AND t3.is_deleted = 0 AND t1.enterprise_id = #{param1}
        <if test="param2.selfHelpInvoiceId != null">
            AND t1.id = #{param2.selfHelpInvoiceId}
        </if>
        <if test="param2.beginDate != null">
            AND DATEDIFF(t1.create_time, #{param2.beginDate}) <![CDATA[ >= ]]> 0
        </if>
        <if test="param2.endDate != null">
            AND DATEDIFF(t1.create_time, #{param2.endDate}) <![CDATA[ <= ]]> 0
        </if>
    </select>

    <select id="findEnterpriseCrowdSourcing" resultMap="EnterpriseCrowdSourcingVOMap">
        SELECT e.id AS enterprise_id, si.id AS self_help_invoice_id, sa.id AS self_help_invoice_apply_id, ss.id AS self_help_invoice_apply_provider_id,
        ssd.id AS provider_self_help_invoice_id, sd.id AS self_help_invoice_detail_id, sp.id AS service_provider_id, e.enterprise_name, sp.service_provider_name,
        si.List_file, ssd.invoice_scan_pictures, ssd.tax_scan_pictures, ssd.update_datetime, sd.invoice_print_state,si.express_sheet_no, si.express_company_name
        FROM diyi_self_help_invoice si INNER JOIN diyi_self_help_invoice_apply sa ON si.id = sa.self_help_invoice_id INNER JOIN diyi_self_help_invoice_detail sd
        ON sd.self_help_invoice_id = si.id INNER JOIN diyi_self_help_invoice_sp ss ON si.id = ss.self_help_invoice_id INNER JOIN diyi_self_help_invoice_sp_detail ssd
        ON ssd.self_help_invoice_apply_provider_id = ss.id INNER JOIN diyi_enterprise e ON e.id = si.enterprise_id INNER JOIN diyi_service_provider sp
        ON sp.id = ss.service_provider_id WHERE si.is_deleted = 0 AND sa.is_deleted = 0 AND sd.is_deleted = 0 AND ss.is_deleted = 0 AND ssd.is_deleted = 0
        AND e.is_deleted = 0 and e.id =#{param1}
        <if test="param2 != null and param2 != ''">
            AND sp.service_provider_name like concat('%', #{param2}, '%')
        </if>
    </select>

    <select id="findDetailCrowdSourcing" resultMap="EnterpriseCrowdSourcingVOMap">
        SELECT e.id AS enterprise_id, si.id AS self_help_invoice_id, sa.id AS self_help_invoice_apply_id, ss.id AS self_help_invoice_apply_provider_id,
        ssd.id AS provider_self_help_invoice_id, sd.id AS self_help_invoice_detail_id, sp.id AS service_provider_id, e.enterprise_name, sp.service_provider_name,
        si.List_file, ssd.invoice_scan_pictures, ssd.tax_scan_pictures, ssd.update_datetime, sd.invoice_print_state, si.express_sheet_no, si.express_company_name
        FROM diyi_self_help_invoice si INNER JOIN diyi_self_help_invoice_apply sa ON si.id = sa.self_help_invoice_id INNER JOIN diyi_self_help_invoice_detail sd
        ON sd.self_help_invoice_id = si.id INNER JOIN diyi_self_help_invoice_sp ss ON si.id = ss.self_help_invoice_id INNER JOIN diyi_self_help_invoice_sp_detail ssd
        ON ssd.self_help_invoice_apply_provider_id = ss.id INNER JOIN diyi_enterprise e ON e.id = si.enterprise_id INNER JOIN diyi_service_provider sp
        ON sp.id = ss.service_provider_id WHERE si.is_deleted = 0 AND sa.is_deleted = 0 AND sd.is_deleted = 0 AND ss.is_deleted = 0 AND ssd.is_deleted = 0
        AND e.is_deleted = 0 and si.id =#{param1}
    </select>

    <select id="findSelfHelpInvoiceByServiceProvider" resultMap="selfHelpInvoicePayVO">
        SELECT t1.id, t5.service_provider_name, t3.enterprise_name, t1.list_file, t1.invoice_people_type, t1.total_pay_provider_fee, t2.invoice_people_name, t2.flow_contract_url, t2.business_contract_url,
        t2.deliver_sheet_url, t2.account_balance_url, t1.current_state, t1.create_time FROM diyi_self_help_invoice t1 INNER JOIN diyi_self_help_invoice_detail t2
        ON t1.id = t2.self_help_invoice_id INNER JOIN diyi_enterprise t3 ON t1.enterprise_id = t3.id INNER JOIN diyi_self_help_invoice_sp t4 ON t1.id = t4.self_help_invoice_id
        INNER JOIN diyi_service_provider t5 ON t4.service_provider_id = t5.id WHERE t1.is_deleted = 0 AND t2.is_deleted = 0 AND t3.is_deleted = 0 AND t4.is_deleted = 0
        AND t5.is_deleted = 0
        <if test="param1 != null">
            AND t5.id = #{param1}
        </if>
        <if test="param2.selfHelpInvoiceId != null">
            AND t1.id = #{param2.selfHelpInvoiceId}
        </if>
        <if test="param2.serviceProviderName != null and param2.serviceProviderName != ''">
            AND t5.service_provider_name like concat('%', #{param2.serviceProviderName}, '%')
        </if>
        <if test="param2.enterpriseName != null and param2.enterpriseName != ''">
            AND t3.enterprise_name like concat('%', #{param2.enterpriseName}, '%')
        </if>
        <if test="param2.beginDate != null">
            AND DATEDIFF(t1.create_time, #{param2.beginDate}) <![CDATA[ >= ]]> 0
        </if>
        <if test="param2.endDate != null">
            AND DATEDIFF(t1.create_time, #{param2.endDate}) <![CDATA[ <= ]]> 0
        </if>
    </select>

    <select id="queryCrowdYearTradeByEnterprise" resultMap="yearTradeVO">
        SELECT IFNULL(SUM(IF(MONTH(create_time) = 1, total_pay_provider_fee, 0)), 0) AS jan_income, IFNULL(SUM(IF(MONTH(create_time) = 2, total_pay_provider_fee, 0)), 0) AS feb_income,
        IFNULL(SUM(IF(MONTH(create_time) = 3, total_pay_provider_fee, 0)), 0) AS mar_income, IFNULL(SUM(IF(MONTH(create_time) = 4, total_pay_provider_fee, 0)), 0) AS apr_income,
        IFNULL(SUM(IF(MONTH(create_time) = 5, total_pay_provider_fee, 0)), 0) AS may_income, IFNULL(SUM(IF(MONTH(create_time) = 6, total_pay_provider_fee, 0)), 0) AS jun_income,
        IFNULL(SUM(IF(MONTH(create_time) = 7, total_pay_provider_fee, 0)), 0) AS jul_income, IFNULL(SUM(IF(MONTH(create_time) = 8, total_pay_provider_fee, 0)), 0) AS aug_income,
        IFNULL(SUM(IF(MONTH(create_time) = 9, total_pay_provider_fee, 0)), 0) AS sep_income, IFNULL(SUM(IF(MONTH(create_time) = 10, total_pay_provider_fee, 0)), 0) AS oct_income,
        IFNULL(SUM(IF(MONTH(create_time) = 11, total_pay_provider_fee, 0)), 0) AS nov_income, IFNULL(SUM(IF(MONTH(create_time) = 12, total_pay_provider_fee, 0)), 0) AS dec_income
        FROM diyi_self_help_invoice WHERE is_deleted = 0 AND current_state != 'REJECTED' AND YEAR(create_time) = YEAR(NOW()) AND enterprise_id = #{param1}
    </select>

    <select id="queryCrowdYearTradeByServiceProvider" resultMap="yearTradeVO">
        SELECT IFNULL(SUM(IF(MONTH(create_time) = 1, charge_money_num, 0)), 0) AS jan_income, IFNULL(SUM(IF(MONTH(create_time) = 2, charge_money_num, 0)), 0) AS feb_income,
        IFNULL(SUM(IF(MONTH(create_time) = 3, charge_money_num, 0)), 0) AS mar_income, IFNULL(SUM(IF(MONTH(create_time) = 4, charge_money_num, 0)), 0) AS apr_income,
        IFNULL(SUM(IF(MONTH(create_time) = 5, charge_money_num, 0)), 0) AS may_income, IFNULL(SUM(IF(MONTH(create_time) = 6, charge_money_num, 0)), 0) AS jun_income,
        IFNULL(SUM(IF(MONTH(create_time) = 7, charge_money_num, 0)), 0) AS jul_income, IFNULL(SUM(IF(MONTH(create_time) = 8, charge_money_num, 0)), 0) AS aug_income,
        IFNULL(SUM(IF(MONTH(create_time) = 9, charge_money_num, 0)), 0) AS sep_income, IFNULL(SUM(IF(MONTH(create_time) = 10, charge_money_num, 0)), 0) AS oct_income,
        IFNULL(SUM(IF(MONTH(create_time) = 11, charge_money_num, 0)), 0) AS nov_income, IFNULL(SUM(IF(MONTH(create_time) = 12, charge_money_num, 0)), 0) AS dec_income
        FROM diyi_self_help_invoice_sp WHERE is_deleted = 0 AND (apply_state = 'PASSED' OR apply_state = 'INVOICED') AND YEAR(create_time) = YEAR(NOW()) AND service_provider_id = #{param1}
    </select>

    <select id="queryCrowdMonthTradeByEnterprise" resultMap="monthTradeVO">
        SELECT IFNULL(SUM(IF(DAY(create_time) = 1, total_pay_provider_fee, 0)), 0) AS one_day_income, IFNULL(SUM(IF(DAY(create_time) = 2, total_pay_provider_fee, 0)), 0) AS two_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 3, total_pay_provider_fee, 0)), 0) AS three_day_income, IFNULL(SUM(IF(DAY(create_time) = 4, total_pay_provider_fee, 0)), 0) AS four_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 5, total_pay_provider_fee, 0)), 0) AS five_day_income, IFNULL(SUM(IF(DAY(create_time) = 6, total_pay_provider_fee, 0)), 0) AS six_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 7, total_pay_provider_fee, 0)), 0) AS seven_day_income, IFNULL(SUM(IF(DAY(create_time) = 8, total_pay_provider_fee, 0)), 0) AS eight_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 9, total_pay_provider_fee, 0)), 0) AS nine_day_income, IFNULL(SUM(IF(DAY(create_time) = 10, total_pay_provider_fee, 0)), 0) AS ten_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 11, total_pay_provider_fee, 0)), 0) AS eleven_day_income, IFNULL(SUM(IF(DAY(create_time) = 12, total_pay_provider_fee, 0)), 0) AS twelve_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 13, total_pay_provider_fee, 0)), 0) AS thirteen_day_income, IFNULL(SUM(IF(DAY(create_time) = 14, total_pay_provider_fee, 0)), 0) AS fourteen_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 15, total_pay_provider_fee, 0)), 0) AS fifteen_day_income, IFNULL(SUM(IF(DAY(create_time) = 16, total_pay_provider_fee, 0)), 0) AS sixteen_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 17, total_pay_provider_fee, 0)), 0) AS seventeen_day_income, IFNULL(SUM(IF(DAY(create_time) = 18, total_pay_provider_fee, 0)), 0) AS eighteen_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 19, total_pay_provider_fee, 0)), 0) AS nineteen_day_income, IFNULL(SUM(IF(DAY(create_time) = 20, total_pay_provider_fee, 0)), 0) AS twenty_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 21, total_pay_provider_fee, 0)), 0) AS twenty_one_day_income, IFNULL(SUM(IF(DAY(create_time) = 22, total_pay_provider_fee, 0)), 0) AS twenty_two_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 23, total_pay_provider_fee, 0)), 0) AS twenty_three_day_income, IFNULL(SUM(IF(DAY(create_time) = 24, total_pay_provider_fee, 0)), 0) AS twenty_four_day_income,
		IFNULL(SUM(IF(DAY(create_time) = 25, total_pay_provider_fee, 0)), 0) AS twenty_five_day_income, IFNULL(SUM(IF(DAY(create_time) = 26, total_pay_provider_fee, 0)), 0) AS twenty_six_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 27, total_pay_provider_fee, 0)), 0) AS twenty_seven_day_income, IFNULL(SUM(IF(DAY(create_time) = 28, total_pay_provider_fee, 0)), 0) AS twenty_eight_day_income,
        IF(DAY(LAST_DAY(NOW())) >= 29, IFNULL(SUM(IF(DAY(create_time) = 29, total_pay_provider_fee, 0)), 0), NULL) AS twenty_nine_day_income,
        IF(DAY(LAST_DAY(NOW())) >= 30, IFNULL(SUM(IF(DAY(create_time) = 30, total_pay_provider_fee, 0)), 0), NULL) AS thirty_day_income,
		IF(DAY(LAST_DAY(NOW())) >= 31, IFNULL(SUM(IF(DAY(create_time) = 31, total_pay_provider_fee, 0)), 0), NULL) AS thirty_one_day_income
        FROM diyi_self_help_invoice WHERE is_deleted = 0 AND current_state != 'REJECTED'
        AND YEAR(create_time) = YEAR(NOW()) AND MONTH(create_time) = MONTH(NOW()) AND enterprise_id = #{param1}
    </select>

    <select id="queryCrowdMonthTradeByServiceProvider" resultMap="monthTradeVO">
        SELECT IFNULL(SUM(IF(DAY(create_time) = 1, charge_money_num, 0)), 0) AS one_day_income, IFNULL(SUM(IF(DAY(create_time) = 2, charge_money_num, 0)), 0) AS two_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 3, charge_money_num, 0)), 0) AS three_day_income, IFNULL(SUM(IF(DAY(create_time) = 4, charge_money_num, 0)), 0) AS four_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 5, charge_money_num, 0)), 0) AS five_day_income, IFNULL(SUM(IF(DAY(create_time) = 6, charge_money_num, 0)), 0) AS six_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 7, charge_money_num, 0)), 0) AS seven_day_income, IFNULL(SUM(IF(DAY(create_time) = 8, charge_money_num, 0)), 0) AS eight_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 9, charge_money_num, 0)), 0) AS nine_day_income, IFNULL(SUM(IF(DAY(create_time) = 10, charge_money_num, 0)), 0) AS ten_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 11, charge_money_num, 0)), 0) AS eleven_day_income, IFNULL(SUM(IF(DAY(create_time) = 12, charge_money_num, 0)), 0) AS twelve_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 13, charge_money_num, 0)), 0) AS thirteen_day_income, IFNULL(SUM(IF(DAY(create_time) = 14, charge_money_num, 0)), 0) AS fourteen_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 15, charge_money_num, 0)), 0) AS fifteen_day_income, IFNULL(SUM(IF(DAY(create_time) = 16, charge_money_num, 0)), 0) AS sixteen_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 17, charge_money_num, 0)), 0) AS seventeen_day_income, IFNULL(SUM(IF(DAY(create_time) = 18, charge_money_num, 0)), 0) AS eighteen_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 19, charge_money_num, 0)), 0) AS nineteen_day_income, IFNULL(SUM(IF(DAY(create_time) = 20, charge_money_num, 0)), 0) AS twenty_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 21, charge_money_num, 0)), 0) AS twenty_one_day_income, IFNULL(SUM(IF(DAY(create_time) = 22, charge_money_num, 0)), 0) AS twenty_two_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 23, charge_money_num, 0)), 0) AS twenty_three_day_income, IFNULL(SUM(IF(DAY(create_time) = 24, charge_money_num, 0)), 0) AS twenty_four_day_income,
		IFNULL(SUM(IF(DAY(create_time) = 25, charge_money_num, 0)), 0) AS twenty_five_day_income, IFNULL(SUM(IF(DAY(create_time) = 26, charge_money_num, 0)), 0) AS twenty_six_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 27, charge_money_num, 0)), 0) AS twenty_seven_day_income, IFNULL(SUM(IF(DAY(create_time) = 28, charge_money_num, 0)), 0) AS twenty_eight_day_income,
        IF(DAY(LAST_DAY(NOW())) >= 29, IFNULL(SUM(IF(DAY(create_time) = 29, charge_money_num, 0)), 0), NULL) AS twenty_nine_day_income,
        IF(DAY(LAST_DAY(NOW())) >= 30, IFNULL(SUM(IF(DAY(create_time) = 30, charge_money_num, 0)), 0), NULL) AS thirty_day_income,
		IF(DAY(LAST_DAY(NOW())) >= 31, IFNULL(SUM(IF(DAY(create_time) = 31, charge_money_num, 0)), 0), NULL) AS thirty_one_day_income
        FROM diyi_self_help_invoice_sp WHERE is_deleted = 0 AND (apply_state = 'PASSED' OR apply_state = 'INVOICED')
        AND YEAR(create_time) = YEAR(NOW()) AND MONTH(create_time) = MONTH(NOW()) AND service_provider_id = #{param1}
    </select>

    <select id="queryCrowdWeekTradeByEnterprise" resultMap="weekTradeVO">
        SELECT IFNULL(SUM(IF(WEEKDAY(create_time) = 0, total_pay_provider_fee, 0)), 0) AS mon_income, IFNULL(SUM(IF(WEEKDAY(create_time) = 1, total_pay_provider_fee, 0)), 0) AS tue_income,
        IFNULL(SUM(IF(WEEKDAY(create_time) = 2, total_pay_provider_fee, 0)), 0) AS wed_income, IFNULL(SUM(IF(WEEKDAY(create_time) = 3, total_pay_provider_fee, 0)), 0) AS thu_income,
        IFNULL(SUM(IF(WEEKDAY(create_time) = 4, total_pay_provider_fee, 0)), 0) AS fri_income, IFNULL(SUM(IF(WEEKDAY(create_time) = 5, total_pay_provider_fee, 0)), 0) AS sat_income,
        IFNULL(SUM(IF(WEEKDAY(create_time) = 6, total_pay_provider_fee, 0)), 0) AS sun_income
        FROM diyi_self_help_invoice WHERE is_deleted = 0 AND current_state != 'REJECTED' AND WEEK(create_time) = WEEK(NOW()) AND enterprise_id = #{param1}
    </select>

    <select id="queryCrowdWeekTradeByServiceProvider" resultMap="weekTradeVO">
        SELECT IFNULL(SUM(IF(WEEKDAY(create_time) = 0, charge_money_num, 0)), 0) AS mon_income, IFNULL(SUM(IF(WEEKDAY(create_time) = 1, charge_money_num, 0)), 0) AS tue_income,
        IFNULL(SUM(IF(WEEKDAY(create_time) = 2, charge_money_num, 0)), 0) AS wed_income, IFNULL(SUM(IF(WEEKDAY(create_time) = 3, charge_money_num, 0)), 0) AS thu_income,
        IFNULL(SUM(IF(WEEKDAY(create_time) = 4, charge_money_num, 0)), 0) AS fri_income, IFNULL(SUM(IF(WEEKDAY(create_time) = 5, charge_money_num, 0)), 0) AS sat_income,
        IFNULL(SUM(IF(WEEKDAY(create_time) = 6, charge_money_num, 0)), 0) AS sun_income
        FROM diyi_self_help_invoice_sp WHERE is_deleted = 0 AND (apply_state = 'PASSED' OR apply_state = 'INVOICED') AND WEEK(create_time) = WEEK(NOW()) AND service_provider_id = #{param1}
    </select>

    <select id="queryCrowdDayTradeByEnterprise" resultMap="dayTradeVO">
        SELECT IFNULL(SUM(IF(HOUR(create_time) = 1, total_pay_provider_fee, 0)), 0) AS one_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 2, total_pay_provider_fee, 0)), 0) AS two_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 3, total_pay_provider_fee, 0)), 0) AS three_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 4, total_pay_provider_fee, 0)), 0) AS four_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 5, total_pay_provider_fee, 0)), 0) AS five_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 6, total_pay_provider_fee, 0)), 0) AS six_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 7, total_pay_provider_fee, 0)), 0) AS seven_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 8, total_pay_provider_fee, 0)), 0) AS eight_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 9, total_pay_provider_fee, 0)), 0) AS nine_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 10, total_pay_provider_fee, 0)), 0) AS ten_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 11, total_pay_provider_fee, 0)), 0) AS eleven_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 12, total_pay_provider_fee, 0)), 0) AS twelve_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 13, total_pay_provider_fee, 0)), 0) AS thirteen_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 14, total_pay_provider_fee, 0)), 0) AS fourteen_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 15, total_pay_provider_fee, 0)), 0) AS fifteen_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 16, total_pay_provider_fee, 0)), 0) AS sixteen_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 17, total_pay_provider_fee, 0)), 0) AS seventeen_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 18, total_pay_provider_fee, 0)), 0) AS eighteen_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 19, total_pay_provider_fee, 0)), 0) AS nineteen_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 20, total_pay_provider_fee, 0)), 0) AS twenty_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 21, total_pay_provider_fee, 0)), 0) AS twenty_one_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 22, total_pay_provider_fee, 0)), 0) AS twenty_two_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 23, total_pay_provider_fee, 0)), 0) AS twenty_three_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 0, total_pay_provider_fee, 0)), 0) AS twenty_four_hour_income
        FROM diyi_self_help_invoice WHERE is_deleted = 0 AND current_state != 'REJECTED' AND DATE(create_time) = DATE(NOW()) AND enterprise_id = #{param1}
    </select>

    <select id="queryCrowdDayTradeByServiceProvider" resultMap="dayTradeVO">
        SELECT IFNULL(SUM(IF(HOUR(create_time) = 1, charge_money_num, 0)), 0) AS one_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 2, charge_money_num, 0)), 0) AS two_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 3, charge_money_num, 0)), 0) AS three_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 4, charge_money_num, 0)), 0) AS four_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 5, charge_money_num, 0)), 0) AS five_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 6, charge_money_num, 0)), 0) AS six_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 7, charge_money_num, 0)), 0) AS seven_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 8, charge_money_num, 0)), 0) AS eight_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 9, charge_money_num, 0)), 0) AS nine_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 10, charge_money_num, 0)), 0) AS ten_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 11, charge_money_num, 0)), 0) AS eleven_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 12, charge_money_num, 0)), 0) AS twelve_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 13, charge_money_num, 0)), 0) AS thirteen_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 14, charge_money_num, 0)), 0) AS fourteen_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 15, charge_money_num, 0)), 0) AS fifteen_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 16, charge_money_num, 0)), 0) AS sixteen_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 17, charge_money_num, 0)), 0) AS seventeen_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 18, charge_money_num, 0)), 0) AS eighteen_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 19, charge_money_num, 0)), 0) AS nineteen_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 20, charge_money_num, 0)), 0) AS twenty_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 21, charge_money_num, 0)), 0) AS twenty_one_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 22, charge_money_num, 0)), 0) AS twenty_two_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 23, charge_money_num, 0)), 0) AS twenty_three_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 0, charge_money_num, 0)), 0) AS twenty_four_hour_income
        FROM diyi_self_help_invoice_sp WHERE is_deleted = 0 AND (apply_state = 'PASSED' OR apply_state = 'INVOICED') AND DATE(create_time) = DATE(NOW()) AND service_provider_id = #{param1}
    </select>

</mapper>
