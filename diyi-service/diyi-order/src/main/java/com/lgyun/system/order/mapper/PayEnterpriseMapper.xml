<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.lgyun.system.order.mapper.PayEnterpriseMapper">

    <!-- 可根据自己的需求，是否要使用 -->
    <resultMap type="com.lgyun.system.order.entity.PayEnterpriseEntity" id="enterprisePayMap">
        <result property="id" column="id"/>
        <result property="enterpriseId" column="enterprise_id"/>
        <result property="serviceProviderId" column="service_provider_id"/>
        <result property="chargeListUrl" column="charge_list_url"/>
        <result property="worksheetId" column="worksheet_id"/>
        <result property="payToPlatformAmount" column="pay_to_platform_amount"/>
        <result property="sourcingAmount" column="sourcing_amount"/>
        <result property="serviceRate" column="service_rate"/>
        <result property="totalTaxFee" column="total_tax_fee"/>
        <result property="makerNum" column="maker_num"/>
        <result property="identifyFee" column="identify_fee"/>
        <result property="serviceFee" column="service_fee"/>
        <result property="payMemo" column="pay_memo"/>
        <result property="enterprisePayState" column="enterprise_pay_state"/>
        <result property="payConfirmDateTime" column="pay_confirm_date_time"/>
        <result property="confirmDateTime" column="confirm_date_time"/>
        <result property="employeeId" column="employee_id"/>
        <result property="companyInvoiceState" column="company_invoice_state"/>
        <result property="invoicePrintDate" column="invoice_print_date"/>
        <result property="createUser" column="create_user"/>
        <result property="createTime" column="create_time"/>
        <result property="updateUser" column="update_user"/>
        <result property="updateTime" column="update_time"/>
        <result property="status" column="status"/>
        <result property="isDeleted" column="is_deleted"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.InvoiceEnterpriseVO" id="InvoiceEnterpriseVOMap">
        <result property="enterpriseId" column="enterprise_id"/>
        <result property="payListId" column="pay_list_id"/>
        <result property="payMakerId" column="pay_maker_id"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="worksheetType" column="worksheet_type"/>
        <result property="payToPlatformAmount" column="pay_to_platform_amount"/>
        <result property="makerVoiceUrl" column="maker_voice_url"/>
        <result property="makerTaxUrl" column="maker_tax_url"/>
        <result property="worksheetName" column="worksheet_name"/>
        <result property="worksheetMode" column="worksheet_mode"/>
        <result property="publishDate" column="publish_date"/>
        <result property="worksheetNo" column="worksheet_no"/>
        <result property="achievementFiles" column="achievement_files"/>
        <result property="checkMoney" column="check_money"/>
        <result property="makerNum" column="maker_num"/>
    </resultMap>
    
    <select id="getEnterpriseAll" resultMap="InvoiceEnterpriseVOMap">
        SELECT e.id AS enterprise_id, pe.id AS pay_list_id, pm.id AS pay_maker_id, e.enterprise_name AS enterprise_name FROM diyi_enterprise e
        INNER JOIN diyi_pay_enterprise pe ON e.id = pe.enterprise_id INNER JOIN diyi_pay_maker pm ON pm.pay_list_id = pe.id
        WHERE pm.maker_id = #{param1} GROUP BY e.id
    </select>

    <select id="getEnterpriseMakerIdAll" resultMap="InvoiceEnterpriseVOMap">
        SELECT e.id AS enterprise_id,pe.maker_num, pe.id AS pay_list_id, pm.id AS pay_maker_id, e.enterprise_name AS enterprise_name,
        s.service_provider_name AS service_provider_name, w.worksheet_type, pe.pay_to_platform_amount FROM diyi_enterprise e INNER JOIN diyi_pay_enterprise pe
        ON e.id = pe.enterprise_id INNER JOIN diyi_pay_maker pm ON pm.pay_list_id = pe.id INNER JOIN diyi_service_provider s ON pe.service_provider_id = s.id
        LEFT JOIN diyi_worksheet w ON w.id = pe.worksheet_id WHERE pm.maker_id = #{param1} and e.id= #{param2}
    </select>


    <select id="getEnterpriseMakerIdDetail" resultMap="InvoiceEnterpriseVOMap">
        SELECT e.id AS enterprise_id, pe.id AS pay_list_id, pm.id AS pay_maker_id, e.enterprise_name AS enterprise_name,
        s.service_provider_name AS service_provider_name, w.worksheet_type, pe.pay_to_platform_amount, mi.maker_voice_url, mtr.maker_tax_url, w.worksheet_name,
        w.worksheet_mode, w.publish_date, w.worksheet_no, wm.achievement_desc, wm.achievement_files, wm.check_money FROM diyi_enterprise e
        INNER JOIN diyi_pay_enterprise pe ON e.id = pe.enterprise_id INNER JOIN diyi_service_provider s ON pe.service_provider_id = s.id
        INNER JOIN diyi_pay_maker pm ON pm.pay_list_id = pe.id LEFT JOIN diyi_worksheet w ON w.id = pe.worksheet_id INNER JOIN diyi_maker_invoice mi
        ON mi.pay_maker_id = pm.id INNER JOIN diyi_maker_tax_record mtr ON mtr.pay_maker_id = pm.id LEFT JOIN diyi_worksheet_maker wm
        ON pe.worksheet_id = wm.worksheet_id WHERE pm.maker_id = #{param1} and e.id= #{param2} and pm.id=#{param3}
    </select>
</mapper>
