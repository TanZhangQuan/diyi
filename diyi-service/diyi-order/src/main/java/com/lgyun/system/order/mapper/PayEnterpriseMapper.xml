<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.lgyun.system.order.mapper.PayEnterpriseMapper">

    <resultMap type="com.lgyun.system.order.vo.InvoiceEnterpriseVO" id="InvoiceEnterpriseVOMap">
        <result property="enterpriseId" column="enterprise_id"/>
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="payMakerId" column="pay_maker_id"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="worksheetType" column="worksheet_type"/>
        <result property="payToPlatformAmount" column="pay_to_platform_amount"/>
        <result property="makerVoiceUrl" column="maker_voice_url"/>
        <result property="makerTaxUrl" column="maker_tax_url"/>
        <result property="worksheetName" column="worksheet_name"/>
        <result property="worksheetMode" column="worksheet_mode"/>
        <result property="createTime" column="create_time"/>
        <result property="worksheetNo" column="worksheet_no"/>
        <result property="achievementFiles" column="achievement_files"/>
        <result property="checkMoney" column="check_money"/>
        <result property="makerNum" column="maker_num"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.PayEnterpriseListVO" id="payEnterpriseMakersListVO">
        <result property="id" column="id"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="chargeListUrl" column="charge_list_url"/>
        <result property="enterprisePayReceiptUrls" column="enterprise_pay_receipt_urls"/>
        <result property="worksheetId" column="worksheet_id"/>
        <result property="acceptPaysheetUrls" column="accept_paysheet_urls"/>
        <result property="auditState" column="audit_state"/>
        <result property="createTime" column="create_time"/>
    </resultMap>

    <resultMap id="EnterpriseSubcontractSummaryMap" type="com.lgyun.system.order.vo.EnterpriseSubcontractInvoiceVO">
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="serviceProviderId" column="service_provider_id"/>
        <result property="makerTotalInvoiceId" column="maker_total_invoice_id"/>
        <result property="invoiceSerialNo" column="invoice_serial_no"/>
        <result property="companyInvoiceUrl" column="company_invoice_url"/>
        <result property="makerTaxUrl" column="maker_tax_url"/>
        <result property="subcontractingInvoiceState" column="subcontracting_invoice_state"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="invoicePrintDate" column="invoice_print_date"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="makerInvoiceType" column="maker_invoice_type"/>
    </resultMap>

    <resultMap id="EnterpriseSubcontractSummaryDetailMap" type="com.lgyun.system.order.vo.EnterpriseSubcontractInvoiceVO">
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="serviceProviderId" column="service_provider_id"/>
        <result property="makerTotalInvoiceId" column="maker_total_invoice_id"/>
        <result property="invoiceSerialNo" column="invoice_serial_no"/>
        <result property="companyInvoiceUrl" column="company_invoice_url"/>
        <result property="makerTaxUrl" column="maker_tax_url"/>
        <result property="subcontractingInvoiceState" column="subcontracting_invoice_state"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="invoicePrintDate" column="invoice_print_date"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="chargeListUrl" column="charge_list_url"/>
        <result property="worksheetId" column="worksheet_id"/>
        <result property="companyVoiceUploadDatetime" column="create_time"/>
        <result property="acceptPaysheetUrl" column="accept_paysheet_url"/>
        <result property="acceptPaysheetId" column="accept_paysheet_id"/>
    </resultMap>


    <resultMap id="EnterpriseSubcontractPortalMap" type="com.lgyun.system.order.vo.EnterpriseSubcontractPortalVO">
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="serviceProviderId" column="service_provider_id"/>
        <result property="payMakerId" column="pay_maker_id"/>
        <result property="makerInvoiceId" column="maker_invoice_id"/>
        <result property="makerTaxRecordId" column="maker_tax_record_id"/>
        <result property="voiceSerialNo" column="voice_serial_no"/>
        <result property="makerVoiceUrl" column="maker_voice_url"/>
        <result property="makerTaxUrl" column="maker_tax_url"/>
        <result property="companyInvoiceState" column="company_invoice_state"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="invoicePrintDate" column="invoice_print_date"/>
    </resultMap>

    <resultMap id="EnterpriseSubcontractPortalDetailMap" type="com.lgyun.system.order.vo.EnterpriseSubcontractPortalVO">
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="serviceProviderId" column="service_provider_id"/>
        <result property="payMakerId" column="pay_maker_id"/>
        <result property="makerInvoiceId" column="maker_invoice_id"/>
        <result property="makerTaxRecordId" column="maker_tax_record_id"/>
        <result property="voiceSerialNo" column="voice_serial_no"/>
        <result property="makerVoiceUrl" column="maker_voice_url"/>
        <result property="makerTaxUrl" column="maker_tax_url"/>
        <result property="companyInvoiceState" column="company_invoice_state"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="invoicePrintDate" column="invoice_print_date"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="chargeListUrl" column="charge_list_url"/>
        <result property="worksheetId" column="worksheet_id"/>
        <result property="acceptPaysheetUrl" column="accept_paysheet_url"/>
        <result property="acceptPaysheetId" column="accept_paysheet_id"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.PayMakerListInvoiceVO" id="payMakerListInvoiceVO">
        <result property="id" column="id"/>
        <result property="name" column="name"/>
        <result property="idcardNo" column="idcard_no"/>
        <result property="makerNetIncome" column="maker_net_income"/>
        <result property="makerTaxFee" column="maker_tax_fee"/>
        <result property="auditFee" column="audit_fee"/>
        <result property="payFee" column="pay_fee"/>
        <result property="totalFee" column="total_fee"/>
        <result property="serviceRate" column="service_rate"/>
        <result property="makerVoiceUrl" column="maker_voice_url"/>
        <result property="makerTaxUrl" column="maker_tax_url"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.PayMakerListServiceProviderVO" id="payMakerListsVO">
        <result property="payMakerId" column="pay_maker_id"/>
        <result property="makerId" column="maker_id"/>
        <result property="name" column="name"/>
        <result property="idcardNo" column="idcard_no"/>
        <result property="makerNetIncome" column="maker_net_income"/>
        <result property="makerTaxFee" column="maker_tax_fee"/>
        <result property="auditFee" column="audit_fee"/>
        <result property="payFee" column="pay_fee"/>
        <result property="totalFee" column="total_fee"/>
        <result property="serviceRate" column="service_rate"/>
        <result property="makerVoiceUrl" column="maker_voice_url"/>
        <result property="makerTaxUrl" column="maker_tax_url"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.PayMakerListWebVO" id="payMakerListServiceProviderVO">
        <result property="id" column="id"/>
        <result property="name" column="name"/>
        <result property="idcardNo" column="idcard_no"/>
        <result property="makerNetIncome" column="maker_net_income"/>
        <result property="makerTaxFee" column="maker_tax_fee"/>
        <result property="auditFee" column="audit_fee"/>
        <result property="payFee" column="pay_fee"/>
        <result property="totalFee" column="total_fee"/>
        <result property="serviceRate" column="service_rate"/>
        <result property="boolAcceptSheet" column="bool_accept_sheet"/>
        <result property="makerPayReceiptUrls" column="maker_pay_receipt_urls"/>
        <result property="invoiceUrl" column="invoice_url"/>
        <result property="taxUrl" column="tax_url"/>
    </resultMap>

    <resultMap type="com.lgyun.system.user.vo.TransactionVO" id="transactionVO">
        <result property="totalSubMonthPay" column="total_sub_month_pay"/>
        <result property="totalSubYearPay" column="total_sub_year_pay"/>
        <result property="totalSubAllPay" column="total_sub_all_pay"/>
        <result property="crowdMonthPay" column="crowd_month_pay"/>
        <result property="crowdYearPay" column="crowd_year_pay"/>
        <result property="crowdAllPay" column="crowd_all_pay"/>
        <result property="makerNum" column="maker_num"/>
        <result property="enterpriseNum" column="enterprise_num"/>
        <result property="serviceProviderNum" column="service_provider_num"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.YearTradeVO" id="yearTradeVO">
        <result property="janIncome" column="jan_income"/>
        <result property="febIncome" column="feb_income"/>
        <result property="marIncome" column="mar_income"/>
        <result property="aprIncome" column="apr_income"/>
        <result property="mayIncome" column="may_income"/>
        <result property="junIncome" column="jun_income"/>
        <result property="julIncome" column="jul_income"/>
        <result property="augIncome" column="aug_income"/>
        <result property="sepIncome" column="sep_income"/>
        <result property="octIncome" column="oct_income"/>
        <result property="novIncome" column="nov_income"/>
        <result property="decIncome" column="dec_income"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.MonthTradeVO" id="monthTradeVO">
        <result property="oneDayIncome" column="one_day_income"/>
        <result property="twoDayIncome" column="two_day_income"/>
        <result property="threeDayIncome" column="three_day_income"/>
        <result property="fourDayIncome" column="four_day_income"/>
        <result property="fiveDayIncome" column="five_day_income"/>
        <result property="sixDayIncome" column="six_day_income"/>
        <result property="sevenDayIncome" column="seven_day_income"/>
        <result property="eightDayIncome" column="eight_day_income"/>
        <result property="nineDayIncome" column="nine_day_income"/>
        <result property="tenDayIncome" column="ten_day_income"/>
        <result property="elevenDayIncome" column="eleven_day_income"/>
        <result property="twelveDayIncome" column="twelve_day_income"/>
        <result property="thirteenDayIncome" column="thirteen_day_income"/>
        <result property="fourteenDayIncome" column="fourteen_day_income"/>
        <result property="fifteenDayIncome" column="fifteen_day_income"/>
        <result property="sixteenDayIncome" column="sixteen_day_income"/>
        <result property="seventeenDayIncome" column="seventeen_day_income"/>
        <result property="eighteenDayIncome" column="eighteen_day_income"/>
        <result property="nineteenDayIncome" column="nineteen_day_income"/>
        <result property="twentyDayIncome" column="twenty_day_income"/>
        <result property="twentyOneDayIncome" column="twenty_one_day_income"/>
        <result property="twentyTwoDayIncome" column="twenty_two_day_income"/>
        <result property="twentyThreeDayIncome" column="twenty_three_day_income"/>
        <result property="twentyFourDayIncome" column="twenty_four_day_income"/>
        <result property="twentyFiveDayIncome" column="twenty_five_day_income"/>
        <result property="twentySixDayIncome" column="twenty_six_day_income"/>
        <result property="twentySevenDayIncome" column="twenty_seven_day_income"/>
        <result property="twentyEightDayIncome" column="twenty_eight_day_income"/>
        <result property="twentyNineDayIncome" column="twenty_nine_day_income"/>
        <result property="thirtyDayIncome" column="thirty_day_income"/>
        <result property="thirtyOneDayIncome" column="thirty_one_day_income"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.WeekTradeVO" id="weekTradeVO">
        <result property="monIncome" column="mon_income"/>
        <result property="tueIncome" column="tue_income"/>
        <result property="wedIncome" column="wed_income"/>
        <result property="thuIncome" column="thu_income"/>
        <result property="friIncome" column="fri_income"/>
        <result property="satIncome" column="sat_income"/>
        <result property="sunIncome" column="sun_income"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.DayTradeVO" id="dayTradeVO">
        <result property="oneHourIncome" column="one_hour_income"/>
        <result property="twoHourIncome" column="two_hour_income"/>
        <result property="threeHourIncome" column="three_hour_income"/>
        <result property="fourHourIncome" column="four_hour_income"/>
        <result property="fiveHourIncome" column="five_hour_income"/>
        <result property="sixHourIncome" column="six_hour_income"/>
        <result property="sevenHourIncome" column="seven_hour_income"/>
        <result property="eightHourIncome" column="eight_hour_income"/>
        <result property="nineHourIncome" column="nine_hour_income"/>
        <result property="tenHourIncome" column="ten_hour_income"/>
        <result property="elevenHourIncome" column="eleven_hour_income"/>
        <result property="twelveHourIncome" column="twelve_hour_income"/>
        <result property="thirteenHourIncome" column="thirteen_hour_income"/>
        <result property="fourteenHourIncome" column="fourteen_hour_income"/>
        <result property="fifteenHourIncome" column="fifteen_hour_income"/>
        <result property="sixteenHourIncome" column="sixteen_hour_income"/>
        <result property="seventeenHourIncome" column="seventeen_hour_income"/>
        <result property="eighteenHourIncome" column="eighteen_hour_income"/>
        <result property="nineteenHourIncome" column="nineteen_hour_income"/>
        <result property="twentyHourIncome" column="twenty_hour_income"/>
        <result property="twentyOneHourIncome" column="twenty_one_hour_income"/>
        <result property="twentyTwoHourIncome" column="twenty_two_hour_income"/>
        <result property="twentyThreeHourIncome" column="twenty_three_hour_income"/>
        <result property="twentyFourHourIncome" column="twenty_four_hour_income"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.InvoiceServiceLumpVO" id="invoiceServiceLumpMap">
        <result property="invoiceApplicationPayListId" column="invoice_application_pay_list_id"/>
        <result property="invoiceApplicationId" column="invoice_application_id"/>
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="applicationState" column="application_state"/>
        <result property="companyInvoiceState" column="company_invoice_state"/>
        <result property="createTime" column="create_time"/>
        <result property="applicationDesc" column="application_desc"/>
        <result property="applyState" column="apply_state"/>
        <result property="invoicePrintId" column="invoice_print_id"/>
    </resultMap>

    <resultMap id="invoiceServiceSubcontractMap" type="com.lgyun.system.order.vo.InvoiceServiceSubVO">
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="enterpriseId" column="enterprise_id"/>
        <result property="makerInvoiceType" column="maker_invoice_type"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="chargeListUrl" column="charge_list_url"/>
        <result property="isPayEnterpriseReceipt" column="isPayEnterpriseReceipt"/>
        <result property="subcontractingInvoiceState" column="subcontracting_invoice_state"/>
        <result property="createTime" column="create_time"/>
    </resultMap>

    <resultMap id="totalInvoiceListEnterVOMap" type="com.lgyun.system.order.vo.TotalInvoiceListEnterVO">
        <result column="platform_invoice_pay_list_id" property="platformInvoicePayListId"/>
        <result column="invoice_print_id" property="invoicePrintId"/>
        <result column="invoice_application_pay_list_id" property="invoiceApplicationPayListId"/>
        <result column="application_id" property="applicationId"/>
        <result column="enterprise_name" property="enterpriseName"/>
        <result column="service_provider_name" property="serviceProviderName"/>
        <result column="company_invoice_state" property="companyInvoiceState"/>
        <result column="application_state" property="applicationState"/>
        <result column="create_time" property="createTime"/>
        <result column="apply_state" property="applyState"/>
        <result column="company_invoice_state" property="companyInvoiceState"/>
        <result column="application_state" property="applicationState"/>
        <result column="pay_to_platform_amount" property="payToPlatformAmount"/>
    </resultMap>


    <resultMap id="relationEnterpriseServiceVOMap" type="com.lgyun.system.order.vo.RelationEnterpriseServiceVO">
        <result column="service_provider_id" property="serviceProviderId"/>
        <result column="service_provider_name" property="serviceProviderName"/>
        <result column="cooperate_status" property="cooperateStatus"/>
    </resultMap>

    <resultMap id="enterpriseServicePayListVOMap" type="com.lgyun.system.order.vo.EnterpriseServicePayListVO">
        <result column="pay_enterprise_id" property="payEnterpriseId"/>
        <result column="service_provider_name" property="serviceProviderName"/>
        <result column="create_time" property="createTime"/>
        <result column="charge_list_url" property="chargeListUrl"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.InvoiceServiceDetailSummaryVO" id="InvoiceServiceDetailSummaryVO">
        <result column="pay_enterprise_id" property="payEnterpriseId"/>
        <result column="enterprise_id" property="enterpriseId"/>
        <result column="pay_to_platform_amount" property="payToPlatformAmount"/>
        <result column="enterprise_name" property="enterpriseName"/>
        <result column="invoice_tax_no" property="invoiceTaxNo"/>
        <result property="invoiceAddressPhone" column="invoice_address_phone"/>
        <result property="invoiceBankNameAccount" column="invoice_bank_name_account"/>
        <result column="service_provider_name" property="serviceProviderName"/>
        <result column="charge_list_url" property="chargeListUrl"/>
        <result column="worksheet_id" property="worksheetId"/>
        <result column="subcontracting_invoice_state" property="subcontractingInvoiceState"/>
        <result column="create_time" property="createTime"/>
        <result column="company_invoice_url" property="companyInvoiceUrl"/>
        <result column="maker_tax_url" property="makerTaxUrl"/>
        <result column="maker_invoice_type" property="makerInvoiceType"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.PayEnterpriseDetailVO" id="payEnterpriseDetailVO">
        <result property="id" column="id"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="chargeListUrl" column="charge_list_url"/>
        <result property="enterprisePayReceiptUrls" column="enterprise_pay_receipt_urls"/>
        <result property="worksheetId" column="worksheet_id"/>
        <result property="acceptPaysheetUrls" column="accept_paysheet_urls"/>
        <result property="auditState" column="audit_state"/>
        <result property="createTime" column="create_time"/>
        <result property="makerInvoiceType" column="maker_invoice_type"/>
        <result property="payState" column="pay_state"/>
        <result property="companyInvoiceState" column="company_invoice_state"/>
        <result property="subcontractingInvoiceState" column="subcontracting_invoice_state"/>
        <result property="payToPlatformAmount" column="pay_to_platform_amount"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.PayEnterpriseUpdateDetailVO" id="payEnterpriseUpdateDetailVO">
        <result property="id" column="id"/>
        <result property="serviceProviderId" column="service_provider_id"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="makerType" column="maker_type"/>
        <result property="chargeListUrl" column="charge_list_url"/>
        <result property="worksheetId" column="worksheet_id"/>
        <result property="worksheetNo" column="worksheet_no"/>
        <result property="worksheetName" column="worksheet_name"/>
        <result property="worksheetCreateTime" column="worksheet_create_time"/>
        <result property="payToPlatformAmount" column="pay_to_platform_amount"/>
        <result property="totalTaxFee" column="total_tax_fee"/>
        <result property="totalMakerNetIncome" column="total_maker_net_income"/>
        <result property="serviceRate" column="service_rate"/>
        <result property="sourcingAmount" column="sourcing_amount"/>
        <result property="enterpriseBusinessAnnualFee" column="enterprise_business_annual_fee"/>
        <result property="identifyFee" column="identify_fee"/>
        <result property="serviceFee" column="service_fee"/>
        <result property="makerNum" column="maker_num"/>
        <result property="payMemo" column="pay_memo"/>
        <result property="enterprisePayReceiptUrls" column="enterprise_pay_receipt_urls"/>
    </resultMap>


    <resultMap type="com.lgyun.system.order.vo.EnterpriseApplyDetailVO" id="enterpriseApplyDetailVoMap">
        <result property="invoiceApplicationId" column="invoice_application_id"/>
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="chargeListUrl" column="charge_list_url"/>
        <result property="enterprisePayReceiptUrl" column="enterprise_pay_receipt_url"/>
        <result property="worksheetId" column="worksheet_id"/>
        <result property="acceptPaysheetUrl" column="accept_paysheet_url"/>
        <result property="applyState" column="apply_state"/>
        <result property="applicationDesc" column="application_desc"/>
        <result property="invoiceCatalogName" column="invoice_catalog_name"/>
        <result property="payToPlatformAmount" column="pay_to_platform_amount"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="applicationState" column="application_state"/>
        <result property="createTime" column="create_time"/>
        <result property="invoiceEnterpriseName" column="invoice_enterprise_name"/>
        <result property="invoiceTaxNo" column="invoice_tax_no"/>
        <result property="invoiceAddressPhone" column="invoice_address_phone"/>
        <result property="invoiceBankNameAccount" column="invoice_bank_name_account"/>
        <result property="addressName" column="address_name"/>
        <result property="addressPhone" column="address_phone"/>
        <result property="area" column="area"/>
        <result property="city" column="city"/>
        <result property="province" column="province"/>
        <result property="detailedAddress" column="detailed_address"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.EnterpriseInvoiceDetailVO" id="enterpriseInvoiceDetailVoMap">
        <result property="invoicePrintId" column="invoice_print_id"/>
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="chargeListUrl" column="charge_list_url"/>
        <result property="enterprisePayReceiptUrl" column="enterprise_pay_receipt_url"/>
        <result property="worksheetId" column="worksheet_id"/>
        <result property="acceptPaysheetUrl" column="accept_paysheet_url"/>
        <result property="applyState" column="apply_state"/>
        <result property="invoiceDesc" column="invoice_desc"/>
        <result property="invoiceCategory" column="invoice_category"/>
        <result property="payToPlatformAmount" column="pay_to_platform_amount"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="companyInvoiceState" column="company_invoice_state"/>
        <result property="createTime" column="create_time"/>
        <result property="invoiceEnterpriseName" column="invoice_enterprise_name"/>
        <result property="invoiceTaxNo" column="invoice_tax_no"/>
        <result property="invoiceAddressPhone" column="invoice_address_phone"/>
        <result property="invoiceBankNameAccount" column="invoice_bank_name_account"/>
        <result property="addressName" column="address_name"/>
        <result property="addressPhone" column="address_phone"/>
        <result property="area" column="area"/>
        <result property="city" column="city"/>
        <result property="province" column="province"/>
        <result property="detailedAddress" column="detailed_address"/>
         <result property="companyInvoiceUrl" column="company_invoice_url"/>
        <result property="expressSheetNo" column="express_sheet_no"/>
        <result property="expressCompanyName" column="express_company_name"/>
        <result property="openedInvoiceTotalAmount" column="opened_invoice_total_amount"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.TotalMergeInvoiceVO" id="totalMergeInvoiceVoMap">
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="chargeListUrl" column="charge_list_url"/>
        <result property="enterprisePayReceiptUrl" column="enterprise_pay_receipt_url"/>
        <result property="worksheetId" column="worksheet_id"/>
        <result property="acceptPaysheetUrl" column="accept_paysheet_url"/>
        <result property="payToPlatformAmount" column="pay_to_platform_amount"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="companyInvoiceState" column="company_invoice_state"/>
        <result property="createTime" column="create_time"/>
        <result property="invoiceEnterpriseName" column="invoice_enterprise_name"/>
        <result property="invoiceTaxNo" column="invoice_tax_no"/>
        <result property="invoiceAddressPhone" column="invoice_address_phone"/>
        <result property="invoiceBankNameAccount" column="invoice_bank_name_account"/>
        <result property="addressName" column="address_name"/>
        <result property="addressPhone" column="address_phone"/>
        <result property="area" column="area"/>
        <result property="city" column="city"/>
        <result property="province" column="province"/>
        <result property="detailedAddress" column="detailed_address"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.PayEnterpriseListSimpleVO" id="payEnterpriseListSimpleVO">
        <result property="id" column="id"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="makerNum" column="maker_num"/>
        <result property="payToPlatformAmount" column="pay_to_platform_amount"/>
        <result property="auditState" column="audit_state"/>
        <result property="createTime" column="create_time"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.PayEnterpriseExpressVO" id="payEnterpriseExpressVO">
        <result property="expressCompanyName" column="express_company_name"/>
        <result property="expressSheetNo" column="express_sheet_no"/>
        <result property="receiptWorkingAddress" column="receipt_working_address"/>
        <result property="receiptWorkingRelName" column="receipt_working_rel_name"/>
        <result property="receiptWorkingRelPhone" column="receipt_working_rel_phone"/>
        <result property="sendWorkingAddress" column="send_working_address"/>
        <result property="sendWorkingRelName" column="send_working_rel_name"/>
        <result property="sendWorkingRelPhone" column="send_working_rel_phone"/>
    </resultMap>

    <select id="getEnterpriseAll" resultMap="InvoiceEnterpriseVOMap">
        SELECT e.id AS enterprise_id, pe.id AS pay_enterprise_id, pm.id AS pay_maker_id, e.enterprise_name AS enterprise_name FROM diyi_enterprise e
        INNER JOIN diyi_pay_enterprise pe ON e.id = pe.enterprise_id INNER JOIN diyi_pay_maker pm ON pm.pay_enterprise_id = pe.id
        WHERE e.bool_deleted = 0 AND pe.bool_deleted = 0 AND pm.bool_deleted = 0 AND pm.maker_id = #{param1} GROUP BY e.id
    </select>

    <select id="getEnterpriseMakerIdAll" resultMap="InvoiceEnterpriseVOMap">
        SELECT e.id AS enterprise_id,pe.maker_num, pe.id AS pay_enterprise_id, pm.id AS pay_maker_id, e.enterprise_name AS enterprise_name,
        s.service_provider_name AS service_provider_name, w.worksheet_type, pe.pay_to_platform_amount FROM diyi_enterprise e INNER JOIN diyi_pay_enterprise pe
        ON e.id = pe.enterprise_id INNER JOIN diyi_pay_maker pm ON pm.pay_enterprise_id = pe.id INNER JOIN diyi_service_provider s ON pe.service_provider_id = s.id
        LEFT JOIN diyi_worksheet w ON w.id = pe.worksheet_id AND w.bool_deleted = 0 WHERE e.bool_deleted = 0 AND pe.bool_deleted = 0 AND pm.bool_deleted = 0 AND
        s.bool_deleted = 0 AND pm.maker_id = #{param1} and e.id= #{param2}
    </select>

    <select id="getEnterpriseMakerIdDetail" resultMap="InvoiceEnterpriseVOMap">
        SELECT e.id AS enterprise_id, pe.id AS pay_enterprise_id, pm.id AS pay_maker_id, e.enterprise_name AS enterprise_name,
        s.service_provider_name AS service_provider_name, w.worksheet_type, pe.pay_to_platform_amount, mi.maker_voice_url, mtr.maker_tax_url, w.worksheet_name,
        w.worksheet_mode, w.create_time, w.worksheet_no, wm.achievement_desc, wm.achievement_files, wm.check_money FROM diyi_enterprise e
        INNER JOIN diyi_pay_enterprise pe ON e.id = pe.enterprise_id INNER JOIN diyi_service_provider s ON pe.service_provider_id = s.id
        INNER JOIN diyi_pay_maker pm ON pm.pay_enterprise_id = pe.id LEFT JOIN diyi_worksheet w ON w.id = pe.worksheet_id AND w.bool_deleted = 0
        INNER JOIN diyi_maker_invoice mi ON mi.pay_maker_id = pm.id INNER JOIN diyi_maker_tax_record mtr ON mtr.pay_maker_id = pm.id LEFT JOIN diyi_worksheet_maker wm
        ON pe.worksheet_id = wm.worksheet_id AND wm.bool_deleted = 0 WHERE e.bool_deleted = 0 AND pe.bool_deleted = 0 AND s.bool_deleted = 0 AND pm.bool_deleted = 0 AND
        mi.bool_deleted = 0 and mtr.bool_deleted = 0 and pm.maker_id = #{param1} and e.id= #{param2} and pm.id=#{param3}
    </select>

    <select id="getPayEnterpriseList" resultMap="payEnterpriseMakersListVO">
        SELECT t1.id, t2.enterprise_name, t3.service_provider_name, t1.charge_list_url, t1.worksheet_id, t1.audit_state, t1.create_time,
        (SELECT GROUP_CONCAT(enterprise_pay_receipt_url) FROM diyi_pay_enterprise_receipt WHERE bool_deleted = 0 AND pay_enterprise_id = t1.id) AS enterprise_pay_receipt_urls,
        (SELECT GROUP_CONCAT(accept_paysheet_url) FROM diyi_accept_paysheet WHERE bool_deleted = 0 AND pay_enterprise_id = t1.id) AS accept_paysheet_urls
        FROM diyi_pay_enterprise t1 INNER JOIN diyi_enterprise t2 ON t1.enterprise_id = t2.id INNER JOIN diyi_service_provider t3 ON t1.service_provider_id = t3.id
        WHERE t1.bool_deleted = 0 AND t2.bool_deleted = 0 AND t3.bool_deleted = 0
        <if test="param1 != null">
            AND t1.enterprise_id = #{param1}
        </if>
        <if test="param2 != null">
            AND t1.service_provider_id = #{param2}
            AND t1.audit_state <![CDATA[ <> ]]> 'EDITING'
        </if>
        <if test="param3.serviceProviderName != null and param3.serviceProviderName.trim() != ''">
            AND t3.service_provider_name LIKE concat('%', #{param3.serviceProviderName}, '%')
        </if>
        <if test="param3.enterpriseName != null and param3.enterpriseName.trim() != ''">
            AND t2.enterprise_name LIKE concat('%', #{param3.enterpriseName}, '%')
        </if>
        <if test="param3.payEnterpriseAuditState != null">
            AND t1.pay_enterprise_audit_state = #{param3.payEnterpriseAuditState}
        </if>
        <if test="param3.beginDate != null">
            AND DATEDIFF(t1.create_time, #{param3.beginDate}) <![CDATA[ >= ]]> 0
        </if>
        <if test="param3.endDate != null">
            AND DATEDIFF(t1.create_time, #{param3.endDate}) <![CDATA[ <= ]]> 0
        </if>
    </select>

    <select id="findEnterpriseSubcontractSummary" resultMap="EnterpriseSubcontractSummaryMap">
        SELECT pe.id AS pay_enterprise_id, mt.id AS maker_total_invoice_id, sp.id AS service_provider_id, mt.invoice_serial_no, mt.company_invoice_url,
        mt.maker_tax_url, pe.subcontracting_invoice_state, sp.service_provider_name, mt.create_time as invoice_print_date, e.enterprise_name
        FROM diyi_pay_enterprise pe INNER JOIN diyi_maker_total_invoice mt ON mt.pay_enterprise_id = pe.id INNER JOIN diyi_service_provider sp
        ON sp.id = pe.service_provider_id INNER JOIN diyi_enterprise e ON pe.enterprise_id = e.id WHERE pe.bool_deleted = 0 AND mt.bool_deleted = 0
        AND sp.bool_deleted = 0 AND pe.subcontracting_invoice_state = 'OPENED' and pe.enterprise_id = #{param1}
        <if test="param2 != null and param2 != ''">
            AND sp.service_provider_name LIKE concat('%', #{param2}, '%')
        </if>
    </select>

    <select id="findEnterpriseSubcontractPortal" resultMap="EnterpriseSubcontractPortalMap">
        SELECT pe.id AS pay_enterprise_id,sp.id as service_provider_id, pm.id AS pay_maker_id, mi.id AS
        maker_invoice_id, mtr.id AS maker_tax_record_id,
        mi.voice_serial_no, mi.maker_voice_url, mtr.maker_tax_url, pe.company_invoice_state, sp.service_provider_name,
        pe.invoice_print_date
        FROM diyi_pay_enterprise pe INNER JOIN diyi_pay_maker pm ON pm.pay_enterprise_id = pe.id INNER JOIN
        diyi_maker_invoice mi ON mi.pay_maker_id = pm.id
        INNER JOIN diyi_service_provider sp ON pe.service_provider_id = sp.id LEFT JOIN diyi_maker_tax_record mtr ON
        pm.id = mtr.pay_maker_id AND mtr.bool_deleted = 0
        WHERE pe.bool_deleted = 0 AND pm.bool_deleted = 0 AND mi.bool_deleted = 0 AND sp.bool_deleted = 0 and pe.enterprise_id =
        #{param1}
        <if test="param2 != null and param2 != ''">
            AND sp.service_provider_name LIKE concat('%', #{param2}, '%')
        </if>
    </select>

    <select id="findDetailSummary" resultMap="EnterpriseSubcontractSummaryDetailMap">
        SELECT pe.id AS pay_enterprise_id, mt.id AS maker_total_invoice_id, sp.id AS service_provider_id, mt.invoice_serial_no, mt.company_invoice_url,
        mt.maker_tax_url, pe.subcontracting_invoice_state, sp.service_provider_name, pe.invoice_print_date, e.enterprise_name, pe.charge_list_url, pe.worksheet_id,
        mt.create_time, ap.accept_paysheet_url,ap.id as accept_paysheet_id FROM diyi_pay_enterprise pe INNER JOIN diyi_enterprise e ON pe.enterprise_id = e.id
        INNER JOIN diyi_maker_total_invoice mt ON mt.pay_enterprise_id = pe.id INNER JOIN diyi_service_provider sp ON sp.id = pe.service_provider_id
        LEFT JOIN diyi_accept_paysheet ap ON ap.pay_enterprise_id = pe.id AND ap.accept_paysheet_type = 'MANY'
         where pe.bool_deleted= 0 and mt.bool_deleted = 0 and sp.bool_deleted = 0 and mt.id = #{param1}
    </select>

    <select id="findDetailSubcontractPortal" resultMap="EnterpriseSubcontractPortalDetailMap">
        SELECT pe.id AS pay_enterprise_id, sp.id AS service_provider_id, pm.id AS pay_maker_id, mi.id AS maker_invoice_id, mtr.id AS maker_tax_record_id,
        mi.voice_serial_no, mi.maker_voice_url, mtr.maker_tax_url, pe.company_invoice_state, sp.service_provider_name, pe.invoice_print_date, e.enterprise_name,
        pe.charge_list_url, pe.worksheet_id, ap.accept_paysheet_url,ap.id as accept_paysheet_id FROM diyi_pay_enterprise pe INNER JOIN diyi_enterprise e ON e.id = pe.enterprise_id
        INNER JOIN diyi_pay_maker pm ON pm.pay_enterprise_id = pe.id INNER JOIN diyi_maker_invoice mi ON mi.pay_maker_id = pm.id INNER JOIN diyi_service_provider sp
        ON pe.service_provider_id = sp.id LEFT JOIN diyi_accept_paysheet ap ON ap.pay_enterprise_id = pe.id AND ap.accept_paysheet_type = 'MANY'
        LEFT JOIN diyi_maker_tax_record mtr ON pm.id = mtr.pay_maker_id AND mtr.bool_deleted = 0 WHERE pe.bool_deleted = 0 AND pm.bool_deleted = 0 AND mi.bool_deleted = 0
        AND sp.bool_deleted = 0 and mi.id = #{param1}
    </select>

    <select id="queryPayMakerListInvoice" resultMap="payMakerListInvoiceVO">
        SELECT t2.id, t2.name, t2.idcard_no, t1.maker_net_income, t1.maker_tax_fee, t1.audit_fee, t1.pay_fee, t1.total_fee, t1.service_rate, mi.maker_voice_url,
        mt.maker_tax_url FROM diyi_pay_maker t1 INNER JOIN diyi_maker t2 ON t1.maker_id = t2.id LEFT JOIN diyi_maker_invoice mi ON mi.pay_maker_id = t1.id
        LEFT JOIN diyi_maker_tax_record mt ON mt.pay_maker_id = t1.id AND t2.bool_deleted = 0 WHERE t1.bool_deleted = 0 AND t1.pay_enterprise_id = #{param1}
    </select>

    <select id="getPayMakerListByPayEnterprise" resultMap="payMakerListServiceProviderVO">
        SELECT t1.id, t2.name, t2.idcard_no, t1.maker_net_income, t1.maker_tax_fee, t1.audit_fee, t1.pay_fee, t1.total_fee, t1.service_rate,
        IF(((SELECT COUNT(id) FROM diyi_accept_paysheet WHERE bool_deleted = 0 AND pay_maker_id = t1.id) > 0 OR (SELECT COUNT(id) FROM diyi_accept_paysheet_list
        WHERE bool_deleted = 0 AND pay_maker_id = t1.id) > 0), TRUE, FALSE) AS bool_accept_sheet, (SELECT GROUP_CONCAT(maker_pay_receipt_url)
        FROM diyi_pay_maker_receipt WHERE bool_deleted = 0 AND pay_maker_id = t1.id) AS maker_pay_receipt_urls,
        (CASE t3.maker_invoice_type WHEN 'NATURALPERSONALLOPEN' THEN (SELECT company_invoice_url FROM diyi_maker_total_invoice WHERE bool_deleted = 0 AND pay_enterprise_id = t1.pay_enterprise_id)
        WHEN 'NATURALPERSONSINGLEOPEN' THEN (SELECT maker_voice_url FROM diyi_maker_invoice WHERE bool_deleted = 0 AND pay_maker_id = t1.id) ELSE '' END)
        AS invoice_url, (CASE t3.maker_invoice_type WHEN 'NATURALPERSONALLOPEN' THEN (SELECT maker_tax_url FROM diyi_maker_total_invoice WHERE bool_deleted = 0 AND pay_enterprise_id = t1.pay_enterprise_id)
        WHEN 'NATURALPERSONSINGLEOPEN' THEN (SELECT maker_tax_url FROM diyi_maker_tax_record WHERE bool_deleted = 0 AND pay_maker_id = t1.id) ELSE '' END)
        AS tax_url FROM diyi_pay_maker t1 INNER JOIN diyi_maker t2 ON t1.maker_id = t2.id INNER JOIN diyi_pay_enterprise t3 ON t1.pay_enterprise_id = t3.id
        WHERE t1.bool_deleted = 0 AND t2.bool_deleted = 0 AND t3.bool_deleted = 0 AND t1.pay_enterprise_id = #{param1}
    </select>

    <select id="queryEnterpriseTransaction" resultMap="transactionVO">
        SELECT t1.month_pay AS total_sub_month_pay, t1.year_pay AS total_sub_year_pay, t1.all_pay AS total_sub_all_pay, t2.month_pay AS crowd_month_pay,
        t2.year_pay AS crowd_year_pay, t2.all_pay AS crowd_all_pay, (SELECT COUNT(DISTINCT id) FROM diyi_maker_enterprise WHERE bool_deleted = 0
        AND relationship_type = 'RELEVANCE' AND enterprise_id = #{param1}) AS maker_num, (SELECT COUNT(id) FROM diyi_enterprise_service_provider WHERE bool_deleted = 0
        AND cooperate_status = 'COOPERATING' AND enterprise_id = #{param1}) AS service_provider_num FROM (SELECT IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 30,
        pay_to_platform_amount, 0)), 0) AS month_pay, IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 365, pay_to_platform_amount, 0)), 0) AS year_pay,
        IFNULL(SUM(pay_to_platform_amount), 0) AS all_pay FROM diyi_pay_enterprise WHERE bool_deleted = 0 AND audit_state = 'APPROVED'
        AND enterprise_id = #{param1}) t1, (SELECT IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 30, total_pay_provider_fee, 0)), 0) AS month_pay,
        IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 365, total_pay_provider_fee, 0)), 0) AS year_pay, IFNULL(SUM(total_pay_provider_fee), 0) AS all_pay
        FROM diyi_self_help_invoice WHERE bool_deleted = 0 AND (current_state = 'PAID' AND current_state = 'INVOICED') AND apply_enterprise_id = #{param1}) t2
    </select>

    <select id="queryServiceProviderTransaction" resultMap="transactionVO">
        SELECT t1.month_pay AS total_sub_month_pay, t1.year_pay AS total_sub_year_pay, t1.all_pay AS total_sub_all_pay,
        t2.month_pay AS crowd_month_pay, t2.year_pay AS crowd_year_pay, t2.all_pay AS crowd_all_pay,
        (SELECT COUNT(DISTINCT id) FROM diyi_service_provider_maker WHERE bool_deleted = 0 AND service_provider_id = #{param1}) AS maker_num,
        (SELECT COUNT(id) FROM diyi_enterprise_service_provider WHERE bool_deleted = 0 AND cooperate_status = 'COOPERATING' AND service_provider_id = #{param1})
        AS enterprise_num FROM (SELECT IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 30, pay_to_platform_amount, 0)), 0) AS month_pay,
        IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 365, pay_to_platform_amount, 0)), 0) AS year_pay,
        IFNULL(SUM(pay_to_platform_amount), 0) AS all_pay FROM diyi_pay_enterprise WHERE bool_deleted = 0 AND
        audit_state = 'APPROVED' AND service_provider_id = #{param1}) t1,
        (SELECT IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 30, charge_money_num, 0)), 0) AS month_pay,
        IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 365, charge_money_num, 0)), 0) AS year_pay,
        IFNULL(SUM(charge_money_num), 0) AS all_pay FROM diyi_self_help_invoice_sp WHERE bool_deleted = 0
        AND (apply_state = 'SUBMITTED' OR apply_state = 'INVOICED') AND service_provider_id = #{param1}) t2
    </select>

    <select id="queryAgentMainEnterpriseTransaction" resultMap="transactionVO">
        SELECT t1.month_pay AS total_sub_month_pay, t1.year_pay AS total_sub_year_pay, t1.all_pay AS total_sub_all_pay, t2.month_pay AS crowd_month_pay, t2.year_pay AS crowd_year_pay,
        t2.all_pay AS crowd_all_pay, (SELECT COUNT(DISTINCT t3.id) FROM diyi_maker_enterprise t3 WHERE t3.bool_deleted = 0 AND t3.relationship_type = 'RELEVANCE'
        AND EXISTS(SELECT t4.id FROM diyi_agent_main_enterprise t4 WHERE t4.bool_deleted = 0 AND t4.cooperate_status = 'COOPERATING' AND t3.enterprise_id = t4.enterprise_id
        AND t4.agent_main_id = #{param1})) AS maker_num, (SELECT COUNT(id) FROM diyi_agent_main_enterprise WHERE bool_deleted = 0 AND cooperate_status = 'COOPERATING'
        AND agent_main_id = #{param1}) AS enterprise_num FROM (SELECT IFNULL(SUM(IF(DATEDIFF(NOW(), t5.create_time) <![CDATA[ < ]]> 30, t5.pay_to_platform_amount, 0)), 0)
        AS month_pay, IFNULL(SUM(IF(DATEDIFF(NOW(), t5.create_time) <![CDATA[ < ]]> 365, t5.pay_to_platform_amount, 0)), 0) AS year_pay, IFNULL(SUM(t5.pay_to_platform_amount), 0)
        AS all_pay FROM diyi_pay_enterprise t5 WHERE t5.bool_deleted = 0 AND t5.audit_state = 'APPROVED' AND EXISTS(SELECT t6.id FROM diyi_agent_main_enterprise t6
        WHERE t6.bool_deleted = 0 AND t6.cooperate_status = 'COOPERATING' AND t5.enterprise_id = t6.enterprise_id AND t6.agent_main_id = #{param1})) t1,
        (SELECT IFNULL(SUM(IF(DATEDIFF(NOW(), t7.create_time) <![CDATA[ < ]]> 30, t7.total_pay_provider_fee, 0)), 0) AS month_pay, IFNULL(SUM(IF(DATEDIFF(NOW(),
        t7.create_time) <![CDATA[ < ]]> 365, t7.total_pay_provider_fee, 0)), 0) AS year_pay, IFNULL(SUM(t7.total_pay_provider_fee), 0) AS all_pay FROM diyi_self_help_invoice t7
        WHERE t7.bool_deleted = 0 AND (t7.current_state = 'PAID' AND t7.current_state = 'INVOICED') AND EXISTS(SELECT t8.id FROM diyi_agent_main_enterprise t8
        WHERE t8.bool_deleted = 0 AND t8.cooperate_status = 'COOPERATING' AND t7.apply_enterprise_id = t8.enterprise_id AND t8.agent_main_id = #{param1})) t2
    </select>

    <select id="queryAgentMainServiceProviderTransaction" resultMap="transactionVO">
        SELECT t1.month_pay AS total_sub_month_pay, t1.year_pay AS total_sub_year_pay, t1.all_pay AS total_sub_all_pay, t2.month_pay AS crowd_month_pay, t2.year_pay AS crowd_year_pay,
        t2.all_pay AS crowd_all_pay, (SELECT COUNT(DISTINCT t3.id) FROM diyi_service_provider_maker t3 WHERE t3.bool_deleted = 0 AND EXISTS(SELECT t4.id FROM diyi_agent_main_service_provider t4
        WHERE t4.bool_deleted = 0 AND t4.cooperate_status = 'COOPERATING' AND t3.service_provider_id = t4.service_provider_id AND t4.agent_main_id = #{param1})) AS maker_num,
        (SELECT COUNT(id) FROM diyi_agent_main_service_provider WHERE bool_deleted = 0 AND cooperate_status = 'COOPERATING' AND agent_main_id = #{param1})
        AS service_provider_num FROM (SELECT IFNULL(SUM(IF(DATEDIFF(NOW(), t5.create_time) <![CDATA[ < ]]> 30, t5.pay_to_platform_amount, 0)), 0) AS month_pay,
        IFNULL(SUM(IF(DATEDIFF(NOW(), t5.create_time) <![CDATA[ < ]]> 365, t5.pay_to_platform_amount, 0)), 0) AS year_pay, IFNULL(SUM(t5.pay_to_platform_amount), 0) AS all_pay
        FROM diyi_pay_enterprise t5 WHERE t5.bool_deleted = 0 AND t5.audit_state = 'APPROVED' AND EXISTS(SELECT t6.id FROM diyi_agent_main_service_provider t6
        WHERE t6.bool_deleted = 0 AND t6.cooperate_status = 'COOPERATING' AND t5.service_provider_id = t6.service_provider_id AND t6.agent_main_id = #{param1})) t1,
        (SELECT IFNULL(SUM(IF(DATEDIFF(NOW(), t7.create_time) <![CDATA[ < ]]> 30, t7.charge_money_num, 0)), 0) AS month_pay, IFNULL(SUM(IF(DATEDIFF(NOW(), t7.create_time) <![CDATA[ < ]]> 365,
        t7.charge_money_num, 0)), 0) AS year_pay, IFNULL(SUM(t7.charge_money_num), 0) AS all_pay FROM diyi_self_help_invoice_sp t7 WHERE t7.bool_deleted = 0
        AND (t7.apply_state = 'SUBMITTED' OR t7.apply_state = 'INVOICED') AND EXISTS(SELECT t8.id FROM diyi_agent_main_service_provider t8 WHERE t8.bool_deleted = 0
        AND t8.cooperate_status = 'COOPERATING' AND t7.service_provider_id = t8.service_provider_id AND t8.agent_main_id = #{param1})) t2
    </select>

    <select id="queryPartnerEnterpriseTransaction" resultMap="transactionVO">
        SELECT t1.month_pay AS total_sub_month_pay, t1.year_pay AS total_sub_year_pay, t1.all_pay AS total_sub_all_pay, t2.month_pay AS crowd_month_pay, t2.year_pay AS crowd_year_pay,
        t2.all_pay AS crowd_all_pay, (SELECT COUNT(DISTINCT t3.id) FROM diyi_maker_enterprise t3 WHERE t3.bool_deleted = 0 AND t3.relationship_type = 'RELEVANCE'
        AND EXISTS(SELECT t4.id FROM diyi_partner_enterprise t4 WHERE t4.bool_deleted = 0 AND t4.cooperate_status = 'COOPERATING' AND t3.enterprise_id = t4.enterprise_id
        AND t4.partner_id = #{param1})) AS maker_num, (SELECT COUNT(id) FROM diyi_partner_enterprise WHERE bool_deleted = 0 AND cooperate_status = 'COOPERATING'
        AND partner_id = #{param1}) AS enterprise_num FROM (SELECT IFNULL(SUM(IF(DATEDIFF(NOW(), t5.create_time) <![CDATA[ < ]]> 30, t5.pay_to_platform_amount, 0)), 0)
        AS month_pay, IFNULL(SUM(IF(DATEDIFF(NOW(), t5.create_time) <![CDATA[ < ]]> 365, t5.pay_to_platform_amount, 0)), 0) AS year_pay, IFNULL(SUM(t5.pay_to_platform_amount), 0)
        AS all_pay FROM diyi_pay_enterprise t5 WHERE t5.bool_deleted = 0 AND t5.audit_state = 'APPROVED' AND EXISTS(SELECT t6.id FROM diyi_partner_enterprise t6
        WHERE t6.bool_deleted = 0 AND t6.cooperate_status = 'COOPERATING' AND t5.enterprise_id = t6.enterprise_id AND t6.partner_id = #{param1})) t1,
        (SELECT IFNULL(SUM(IF(DATEDIFF(NOW(), t7.create_time) <![CDATA[ < ]]> 30, t7.total_pay_provider_fee, 0)), 0) AS month_pay, IFNULL(SUM(IF(DATEDIFF(NOW(),
        t7.create_time) <![CDATA[ < ]]> 365, t7.total_pay_provider_fee, 0)), 0) AS year_pay, IFNULL(SUM(t7.total_pay_provider_fee), 0) AS all_pay FROM diyi_self_help_invoice t7
        WHERE t7.bool_deleted = 0 AND (t7.current_state = 'PAID' AND t7.current_state = 'INVOICED') AND EXISTS(SELECT t8.id FROM diyi_partner_enterprise t8
        WHERE t8.bool_deleted = 0 AND t8.cooperate_status = 'COOPERATING' AND t7.apply_enterprise_id = t8.enterprise_id AND t8.partner_id = #{param1})) t2
    </select>

    <select id="queryRelBureauServiceProviderTransaction" resultMap="transactionVO">
        SELECT t1.month_pay AS total_sub_month_pay, t1.year_pay AS total_sub_year_pay, t1.all_pay AS total_sub_all_pay, t2.month_pay AS crowd_month_pay, t2.year_pay AS crowd_year_pay,
        t2.all_pay AS crowd_all_pay, (SELECT COUNT(DISTINCT t3.id) FROM diyi_service_provider_maker t3 WHERE t3.bool_deleted = 0 AND EXISTS(SELECT t4.id FROM diyi_rel_bureau_service_provider t4
        WHERE t4.bool_deleted = 0 AND t4.cooperate_status = 'COOPERATING' AND t3.service_provider_id = t4.service_provider_id AND t4.rel_bureau_id = #{param1})) AS maker_num,
        (SELECT COUNT(id) FROM diyi_rel_bureau_service_provider WHERE bool_deleted = 0 AND cooperate_status = 'COOPERATING' AND rel_bureau_id = #{param1})
        AS service_provider_num, (SELECT COUNT(t9.id) FROM diyi_enterprise_service_provider t9 INNER JOIN diyi_rel_bureau_service_provider t10 ON t9.service_provider_id = t10.service_provider_id
        WHERE t9.bool_deleted = 0 AND t10.bool_deleted = 0 AND t9.cooperate_status = 'COOPERATING' AND t10.cooperate_status = 'COOPERATING' AND t10.rel_bureau_id = #{param1})
        AS enterprise_num FROM (SELECT IFNULL(SUM(IF(DATEDIFF(NOW(), t5.create_time) <![CDATA[ < ]]> 30, t5.pay_to_platform_amount, 0)), 0) AS month_pay,
        IFNULL(SUM(IF(DATEDIFF(NOW(), t5.create_time) <![CDATA[ < ]]> 365, t5.pay_to_platform_amount, 0)), 0) AS year_pay, IFNULL(SUM(t5.pay_to_platform_amount), 0) AS all_pay
        FROM diyi_pay_enterprise t5 WHERE t5.bool_deleted = 0 AND t5.audit_state = 'APPROVED' AND EXISTS(SELECT t6.id FROM diyi_rel_bureau_service_provider t6
        WHERE t6.bool_deleted = 0 AND t6.cooperate_status = 'COOPERATING' AND t5.service_provider_id = t6.service_provider_id AND t6.rel_bureau_id = #{param1})) t1,
        (SELECT IFNULL(SUM(IF(DATEDIFF(NOW(), t7.create_time) <![CDATA[ < ]]> 30, t7.charge_money_num, 0)), 0) AS month_pay, IFNULL(SUM(IF(DATEDIFF(NOW(), t7.create_time) <![CDATA[ < ]]> 365,
        t7.charge_money_num, 0)), 0) AS year_pay, IFNULL(SUM(t7.charge_money_num), 0) AS all_pay FROM diyi_self_help_invoice_sp t7 WHERE t7.bool_deleted = 0
        AND (t7.apply_state = 'SUBMITTED' OR t7.apply_state = 'INVOICED') AND EXISTS(SELECT t8.id FROM diyi_rel_bureau_service_provider t8 WHERE t8.bool_deleted = 0
        AND t8.cooperate_status = 'COOPERATING' AND t7.service_provider_id = t8.service_provider_id AND t8.rel_bureau_id = #{param1})) t2
    </select>

    <select id="queryTotalSubYearTradeByEnterprise" resultMap="yearTradeVO">
        SELECT IFNULL(SUM(IF(MONTH(create_time) = 1, pay_to_platform_amount, 0)), 0) AS jan_income, IFNULL(SUM(IF(MONTH(create_time) = 2, pay_to_platform_amount, 0)), 0) AS feb_income,
        IFNULL(SUM(IF(MONTH(create_time) = 3, pay_to_platform_amount, 0)), 0) AS mar_income, IFNULL(SUM(IF(MONTH(create_time) = 4, pay_to_platform_amount, 0)), 0) AS apr_income,
        IFNULL(SUM(IF(MONTH(create_time) = 5, pay_to_platform_amount, 0)), 0) AS may_income, IFNULL(SUM(IF(MONTH(create_time) = 6, pay_to_platform_amount, 0)), 0) AS jun_income,
        IFNULL(SUM(IF(MONTH(create_time) = 7, pay_to_platform_amount, 0)), 0) AS jul_income, IFNULL(SUM(IF(MONTH(create_time) = 8, pay_to_platform_amount, 0)), 0) AS aug_income,
        IFNULL(SUM(IF(MONTH(create_time) = 9, pay_to_platform_amount, 0)), 0) AS sep_income, IFNULL(SUM(IF(MONTH(create_time) = 10, pay_to_platform_amount, 0)), 0) AS oct_income,
        IFNULL(SUM(IF(MONTH(create_time) = 11, pay_to_platform_amount, 0)), 0) AS nov_income, IFNULL(SUM(IF(MONTH(create_time) = 12, pay_to_platform_amount, 0)), 0) AS dec_income
        FROM diyi_pay_enterprise WHERE bool_deleted = 0 AND audit_state = 'APPROVED' AND YEAR(create_time) = YEAR(NOW()) AND enterprise_id = #{param1}
    </select>

    <select id="queryTotalSubYearTradeByServiceProvider" resultMap="yearTradeVO">
        SELECT IFNULL(SUM(IF(MONTH(t1.create_time) = 1, t1.pay_to_platform_amount, 0)), 0) AS jan_income, IFNULL(SUM(IF(MONTH(t1.create_time) = 2, t1.pay_to_platform_amount, 0)), 0) AS feb_income,
        IFNULL(SUM(IF(MONTH(t1.create_time) = 3, t1.pay_to_platform_amount, 0)), 0) AS mar_income, IFNULL(SUM(IF(MONTH(t1.create_time) = 4, t1.pay_to_platform_amount, 0)), 0) AS apr_income,
        IFNULL(SUM(IF(MONTH(t1.create_time) = 5, t1.pay_to_platform_amount, 0)), 0) AS may_income, IFNULL(SUM(IF(MONTH(t1.create_time) = 6, t1.pay_to_platform_amount, 0)), 0) AS jun_income,
        IFNULL(SUM(IF(MONTH(t1.create_time) = 7, t1.pay_to_platform_amount, 0)), 0) AS jul_income, IFNULL(SUM(IF(MONTH(t1.create_time) = 8, t1.pay_to_platform_amount, 0)), 0) AS aug_income,
        IFNULL(SUM(IF(MONTH(t1.create_time) = 9, t1.pay_to_platform_amount, 0)), 0) AS sep_income, IFNULL(SUM(IF(MONTH(t1.create_time) = 10, t1.pay_to_platform_amount, 0)), 0) AS oct_income,
        IFNULL(SUM(IF(MONTH(t1.create_time) = 11, t1.pay_to_platform_amount, 0)), 0) AS nov_income, IFNULL(SUM(IF(MONTH(t1.create_time) = 12, t1.pay_to_platform_amount, 0)), 0) AS dec_income
        FROM diyi_pay_enterprise t1
        <if test="param2 != null">
            INNER JOIN diyi_rel_bureau_service_provider t2 ON t1.service_provider_id = t2.service_provider_id AND t2.bool_deleted = 0 AND t2.rel_bureau_id = #{param2}
        </if>
        WHERE t1.bool_deleted = 0 AND t1.audit_state = 'APPROVED' AND YEAR(t1.create_time) = YEAR(NOW())
        <if test="param1 != null">
            AND t1.service_provider_id = #{param1}
        </if>
    </select>

    <select id="queryTotalSubMonthTradeByEnterprise" resultMap="monthTradeVO">
        SELECT IFNULL(SUM(IF(DAY(create_time) = 1, pay_to_platform_amount, 0)), 0) AS one_day_income, IFNULL(SUM(IF(DAY(create_time) = 2, pay_to_platform_amount, 0)), 0) AS two_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 3, pay_to_platform_amount, 0)), 0) AS three_day_income, IFNULL(SUM(IF(DAY(create_time) = 4, pay_to_platform_amount, 0)), 0) AS four_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 5, pay_to_platform_amount, 0)), 0) AS five_day_income, IFNULL(SUM(IF(DAY(create_time) = 6, pay_to_platform_amount, 0)), 0) AS six_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 7, pay_to_platform_amount, 0)), 0) AS seven_day_income, IFNULL(SUM(IF(DAY(create_time) = 8, pay_to_platform_amount, 0)), 0) AS eight_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 9, pay_to_platform_amount, 0)), 0) AS nine_day_income, IFNULL(SUM(IF(DAY(create_time) = 10, pay_to_platform_amount, 0)), 0) AS ten_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 11, pay_to_platform_amount, 0)), 0) AS eleven_day_income, IFNULL(SUM(IF(DAY(create_time) = 12, pay_to_platform_amount, 0)), 0) AS twelve_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 13, pay_to_platform_amount, 0)), 0) AS thirteen_day_income, IFNULL(SUM(IF(DAY(create_time) = 14, pay_to_platform_amount, 0)), 0) AS fourteen_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 15, pay_to_platform_amount, 0)), 0) AS fifteen_day_income, IFNULL(SUM(IF(DAY(create_time) = 16, pay_to_platform_amount, 0)), 0) AS sixteen_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 17, pay_to_platform_amount, 0)), 0) AS seventeen_day_income, IFNULL(SUM(IF(DAY(create_time) = 18, pay_to_platform_amount, 0)), 0) AS eighteen_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 19, pay_to_platform_amount, 0)), 0) AS nineteen_day_income, IFNULL(SUM(IF(DAY(create_time) = 20, pay_to_platform_amount, 0)), 0) AS twenty_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 21, pay_to_platform_amount, 0)), 0) AS twenty_one_day_income, IFNULL(SUM(IF(DAY(create_time) = 22, pay_to_platform_amount, 0)), 0) AS twenty_two_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 23, pay_to_platform_amount, 0)), 0) AS twenty_three_day_income, IFNULL(SUM(IF(DAY(create_time) = 24, pay_to_platform_amount, 0)), 0) AS twenty_four_day_income,
		IFNULL(SUM(IF(DAY(create_time) = 25, pay_to_platform_amount, 0)), 0) AS twenty_five_day_income, IFNULL(SUM(IF(DAY(create_time) = 26, pay_to_platform_amount, 0)), 0) AS twenty_six_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 27, pay_to_platform_amount, 0)), 0) AS twenty_seven_day_income, IFNULL(SUM(IF(DAY(create_time) = 28, pay_to_platform_amount, 0)), 0) AS twenty_eight_day_income,
        IF(DAY(LAST_DAY(NOW())) >= 29, IFNULL(SUM(IF(DAY(create_time) = 29, pay_to_platform_amount, 0)), 0), NULL) AS twenty_nine_day_income,
        IF(DAY(LAST_DAY(NOW())) >= 30, IFNULL(SUM(IF(DAY(create_time) = 30, pay_to_platform_amount, 0)), 0), NULL) AS thirty_day_income,
		IF(DAY(LAST_DAY(NOW())) >= 31, IFNULL(SUM(IF(DAY(create_time) = 31, pay_to_platform_amount, 0)), 0), NULL) AS thirty_one_day_income
        FROM diyi_pay_enterprise WHERE bool_deleted = 0 AND audit_state = 'APPROVED' AND YEAR(create_time) = YEAR(NOW())
		AND MONTH(create_time) = MONTH(NOW()) AND enterprise_id = #{param1}
    </select>

    <select id="queryTotalSubMonthTradeByServiceProvider" resultMap="monthTradeVO">
        SELECT IFNULL(SUM(IF(DAY(t1.create_time) = 1, t1.pay_to_platform_amount, 0)), 0) AS one_day_income, IFNULL(SUM(IF(DAY(t1.create_time) = 2, t1.pay_to_platform_amount, 0)), 0) AS two_day_income,
        IFNULL(SUM(IF(DAY(t1.create_time) = 3, t1.pay_to_platform_amount, 0)), 0) AS three_day_income, IFNULL(SUM(IF(DAY(t1.create_time) = 4, t1.pay_to_platform_amount, 0)), 0) AS four_day_income,
        IFNULL(SUM(IF(DAY(t1.create_time) = 5, t1.pay_to_platform_amount, 0)), 0) AS five_day_income, IFNULL(SUM(IF(DAY(t1.create_time) = 6, t1.pay_to_platform_amount, 0)), 0) AS six_day_income,
        IFNULL(SUM(IF(DAY(t1.create_time) = 7, t1.pay_to_platform_amount, 0)), 0) AS seven_day_income, IFNULL(SUM(IF(DAY(t1.create_time) = 8, t1.pay_to_platform_amount, 0)), 0) AS eight_day_income,
        IFNULL(SUM(IF(DAY(t1.create_time) = 9, t1.pay_to_platform_amount, 0)), 0) AS nine_day_income, IFNULL(SUM(IF(DAY(t1.create_time) = 10, t1.pay_to_platform_amount, 0)), 0) AS ten_day_income,
        IFNULL(SUM(IF(DAY(t1.create_time) = 11, t1.pay_to_platform_amount, 0)), 0) AS eleven_day_income, IFNULL(SUM(IF(DAY(t1.create_time) = 12, t1.pay_to_platform_amount, 0)), 0) AS twelve_day_income,
        IFNULL(SUM(IF(DAY(t1.create_time) = 13, t1.pay_to_platform_amount, 0)), 0) AS thirteen_day_income, IFNULL(SUM(IF(DAY(t1.create_time) = 14, t1.pay_to_platform_amount, 0)), 0) AS fourteen_day_income,
        IFNULL(SUM(IF(DAY(t1.create_time) = 15, t1.pay_to_platform_amount, 0)), 0) AS fifteen_day_income, IFNULL(SUM(IF(DAY(t1.create_time) = 16, t1.pay_to_platform_amount, 0)), 0) AS sixteen_day_income,
        IFNULL(SUM(IF(DAY(t1.create_time) = 17, t1.pay_to_platform_amount, 0)), 0) AS seventeen_day_income, IFNULL(SUM(IF(DAY(t1.create_time) = 18, t1.pay_to_platform_amount, 0)), 0) AS eighteen_day_income,
        IFNULL(SUM(IF(DAY(t1.create_time) = 19, t1.pay_to_platform_amount, 0)), 0) AS nineteen_day_income, IFNULL(SUM(IF(DAY(t1.create_time) = 20, t1.pay_to_platform_amount, 0)), 0) AS twenty_day_income,
        IFNULL(SUM(IF(DAY(t1.create_time) = 21, t1.pay_to_platform_amount, 0)), 0) AS twenty_one_day_income, IFNULL(SUM(IF(DAY(t1.create_time) = 22, t1.pay_to_platform_amount, 0)), 0) AS twenty_two_day_income,
        IFNULL(SUM(IF(DAY(t1.create_time) = 23, t1.pay_to_platform_amount, 0)), 0) AS twenty_three_day_income, IFNULL(SUM(IF(DAY(t1.create_time) = 24, t1.pay_to_platform_amount, 0)), 0) AS twenty_four_day_income,
		IFNULL(SUM(IF(DAY(t1.create_time) = 25, t1.pay_to_platform_amount, 0)), 0) AS twenty_five_day_income, IFNULL(SUM(IF(DAY(t1.create_time) = 26, t1.pay_to_platform_amount, 0)), 0) AS twenty_six_day_income,
        IFNULL(SUM(IF(DAY(t1.create_time) = 27, t1.pay_to_platform_amount, 0)), 0) AS twenty_seven_day_income, IFNULL(SUM(IF(DAY(t1.create_time) = 28, t1.pay_to_platform_amount, 0)), 0) AS twenty_eight_day_income,
        IF(DAY(LAST_DAY(NOW())) >= 29, IFNULL(SUM(IF(DAY(t1.create_time) = 29, t1.pay_to_platform_amount, 0)), 0), NULL) AS twenty_nine_day_income,
        IF(DAY(LAST_DAY(NOW())) >= 30, IFNULL(SUM(IF(DAY(t1.create_time) = 30, t1.pay_to_platform_amount, 0)), 0), NULL) AS thirty_day_income,
		IF(DAY(LAST_DAY(NOW())) >= 31, IFNULL(SUM(IF(DAY(t1.create_time) = 31, t1.pay_to_platform_amount, 0)), 0), NULL) AS thirty_one_day_income
        FROM diyi_pay_enterprise t1
		<if test="param2 != null">
            INNER JOIN diyi_rel_bureau_service_provider t2 ON t1.service_provider_id = t2.service_provider_id AND t2.bool_deleted = 0 AND t2.rel_bureau_id = #{param2}
        </if>
        WHERE t1.bool_deleted = 0 AND t1.audit_state = 'APPROVED' AND YEAR(t1.create_time) = YEAR(NOW()) AND MONTH(t1.create_time) = MONTH(NOW())
        <if test="param1 != null">
            AND t1.service_provider_id = #{param1}
        </if>
    </select>

    <select id="queryTotalSubWeekTradeByEnterprise" resultMap="weekTradeVO">
        SELECT IFNULL(SUM(IF(WEEKDAY(create_time) = 0, pay_to_platform_amount, 0)), 0) AS mon_income, IFNULL(SUM(IF(WEEKDAY(create_time) = 1, pay_to_platform_amount, 0)), 0) AS tue_income,
        IFNULL(SUM(IF(WEEKDAY(create_time) = 2, pay_to_platform_amount, 0)), 0) AS wed_income, IFNULL(SUM(IF(WEEKDAY(create_time) = 3, pay_to_platform_amount, 0)), 0) AS thu_income,
        IFNULL(SUM(IF(WEEKDAY(create_time) = 4, pay_to_platform_amount, 0)), 0) AS fri_income, IFNULL(SUM(IF(WEEKDAY(create_time) = 5, pay_to_platform_amount, 0)), 0) AS sat_income,
        IFNULL(SUM(IF(WEEKDAY(create_time) = 6, pay_to_platform_amount, 0)), 0) AS sun_income
        FROM diyi_pay_enterprise WHERE bool_deleted = 0 AND audit_state = 'APPROVED' AND WEEK(create_time) = WEEK(NOW()) AND enterprise_id = #{param1}
    </select>

    <select id="queryTotalSubWeekTradeByServiceProvider" resultMap="weekTradeVO">
        SELECT IFNULL(SUM(IF(WEEKDAY(t1.create_time) = 0, t1.pay_to_platform_amount, 0)), 0) AS mon_income, IFNULL(SUM(IF(WEEKDAY(t1.create_time) = 1, t1.pay_to_platform_amount, 0)), 0) AS tue_income,
        IFNULL(SUM(IF(WEEKDAY(t1.create_time) = 2, t1.pay_to_platform_amount, 0)), 0) AS wed_income, IFNULL(SUM(IF(WEEKDAY(t1.create_time) = 3, t1.pay_to_platform_amount, 0)), 0) AS thu_income,
        IFNULL(SUM(IF(WEEKDAY(t1.create_time) = 4, t1.pay_to_platform_amount, 0)), 0) AS fri_income, IFNULL(SUM(IF(WEEKDAY(t1.create_time) = 5, t1.pay_to_platform_amount, 0)), 0) AS sat_income,
        IFNULL(SUM(IF(WEEKDAY(t1.create_time) = 6, t1.pay_to_platform_amount, 0)), 0) AS sun_income
        FROM diyi_pay_enterprise t1
        <if test="param2 != null">
            INNER JOIN diyi_rel_bureau_service_provider t2 ON t1.service_provider_id = t2.service_provider_id AND t2.bool_deleted = 0 AND t2.rel_bureau_id = #{param2}
        </if>
        WHERE t1.bool_deleted = 0 AND t1.audit_state = 'APPROVED' AND WEEK(t1.create_time) = WEEK(NOW())
        <if test="param1 != null">
            AND t1.service_provider_id = #{param1}
        </if>
    </select>

    <select id="queryTotalSubDayTradeByEnterprise" resultMap="dayTradeVO">
        SELECT IFNULL(SUM(IF(HOUR(create_time) = 1, pay_to_platform_amount, 0)), 0) AS one_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 2, pay_to_platform_amount, 0)), 0) AS two_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 3, pay_to_platform_amount, 0)), 0) AS three_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 4, pay_to_platform_amount, 0)), 0) AS four_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 5, pay_to_platform_amount, 0)), 0) AS five_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 6, pay_to_platform_amount, 0)), 0) AS six_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 7, pay_to_platform_amount, 0)), 0) AS seven_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 8, pay_to_platform_amount, 0)), 0) AS eight_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 9, pay_to_platform_amount, 0)), 0) AS nine_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 10, pay_to_platform_amount, 0)), 0) AS ten_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 11, pay_to_platform_amount, 0)), 0) AS eleven_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 12, pay_to_platform_amount, 0)), 0) AS twelve_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 13, pay_to_platform_amount, 0)), 0) AS thirteen_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 14, pay_to_platform_amount, 0)), 0) AS fourteen_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 15, pay_to_platform_amount, 0)), 0) AS fifteen_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 16, pay_to_platform_amount, 0)), 0) AS sixteen_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 17, pay_to_platform_amount, 0)), 0) AS seventeen_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 18, pay_to_platform_amount, 0)), 0) AS eighteen_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 19, pay_to_platform_amount, 0)), 0) AS nineteen_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 20, pay_to_platform_amount, 0)), 0) AS twenty_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 21, pay_to_platform_amount, 0)), 0) AS twenty_one_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 22, pay_to_platform_amount, 0)), 0) AS twenty_two_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 23, pay_to_platform_amount, 0)), 0) AS twenty_three_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 0, pay_to_platform_amount, 0)), 0) AS twenty_four_hour_income
        FROM diyi_pay_enterprise WHERE bool_deleted = 0 AND audit_state = 'APPROVED' AND DATE(create_time) = DATE(NOW()) AND enterprise_id = #{param1}
    </select>

    <select id="queryTotalSubDayTradeByServiceProvider" resultMap="dayTradeVO">
        SELECT IFNULL(SUM(IF(HOUR(t1.create_time) = 1, t1.pay_to_platform_amount, 0)), 0) AS one_hour_income, IFNULL(SUM(IF(HOUR(t1.create_time) = 2, t1.pay_to_platform_amount, 0)), 0) AS two_hour_income,
        IFNULL(SUM(IF(HOUR(t1.create_time) = 3, t1.pay_to_platform_amount, 0)), 0) AS three_hour_income, IFNULL(SUM(IF(HOUR(t1.create_time) = 4, t1.pay_to_platform_amount, 0)), 0) AS four_hour_income,
        IFNULL(SUM(IF(HOUR(t1.create_time) = 5, t1.pay_to_platform_amount, 0)), 0) AS five_hour_income, IFNULL(SUM(IF(HOUR(t1.create_time) = 6, t1.pay_to_platform_amount, 0)), 0) AS six_hour_income,
        IFNULL(SUM(IF(HOUR(t1.create_time) = 7, t1.pay_to_platform_amount, 0)), 0) AS seven_hour_income, IFNULL(SUM(IF(HOUR(t1.create_time) = 8, t1.pay_to_platform_amount, 0)), 0) AS eight_hour_income,
        IFNULL(SUM(IF(HOUR(t1.create_time) = 9, t1.pay_to_platform_amount, 0)), 0) AS nine_hour_income, IFNULL(SUM(IF(HOUR(t1.create_time) = 10, t1.pay_to_platform_amount, 0)), 0) AS ten_hour_income,
        IFNULL(SUM(IF(HOUR(t1.create_time) = 11, t1.pay_to_platform_amount, 0)), 0) AS eleven_hour_income, IFNULL(SUM(IF(HOUR(t1.create_time) = 12, t1.pay_to_platform_amount, 0)), 0) AS twelve_hour_income,
        IFNULL(SUM(IF(HOUR(t1.create_time) = 13, t1.pay_to_platform_amount, 0)), 0) AS thirteen_hour_income, IFNULL(SUM(IF(HOUR(t1.create_time) = 14, t1.pay_to_platform_amount, 0)), 0) AS fourteen_hour_income,
        IFNULL(SUM(IF(HOUR(t1.create_time) = 15, t1.pay_to_platform_amount, 0)), 0) AS fifteen_hour_income, IFNULL(SUM(IF(HOUR(t1.create_time) = 16, t1.pay_to_platform_amount, 0)), 0) AS sixteen_hour_income,
        IFNULL(SUM(IF(HOUR(t1.create_time) = 17, t1.pay_to_platform_amount, 0)), 0) AS seventeen_hour_income, IFNULL(SUM(IF(HOUR(t1.create_time) = 18, t1.pay_to_platform_amount, 0)), 0) AS eighteen_hour_income,
        IFNULL(SUM(IF(HOUR(t1.create_time) = 19, t1.pay_to_platform_amount, 0)), 0) AS nineteen_hour_income, IFNULL(SUM(IF(HOUR(t1.create_time) = 20, t1.pay_to_platform_amount, 0)), 0) AS twenty_hour_income,
        IFNULL(SUM(IF(HOUR(t1.create_time) = 21, t1.pay_to_platform_amount, 0)), 0) AS twenty_one_hour_income, IFNULL(SUM(IF(HOUR(t1.create_time) = 22, t1.pay_to_platform_amount, 0)), 0) AS twenty_two_hour_income,
        IFNULL(SUM(IF(HOUR(t1.create_time) = 23, t1.pay_to_platform_amount, 0)), 0) AS twenty_three_hour_income, IFNULL(SUM(IF(HOUR(t1.create_time) = 0, t1.pay_to_platform_amount, 0)), 0) AS twenty_four_hour_income
        FROM diyi_pay_enterprise t1
        <if test="param2 != null">
            INNER JOIN diyi_rel_bureau_service_provider t2 ON t1.service_provider_id = t2.service_provider_id AND t2.bool_deleted = 0 AND t2.rel_bureau_id = #{param2}
        </if>
        WHERE t1.bool_deleted = 0 AND t1.audit_state = 'APPROVED' AND DATE(t1.create_time) = DATE(NOW())
        <if test="param1 != null">
            AND t1.service_provider_id = #{param1}
        </if>
    </select>

    <select id="getServiceSummaryInvoice" resultMap="invoiceServiceSubcontractMap">
        SELECT pe.id AS pay_enterprise_id, e.id AS enterprise_id, pe.maker_invoice_type, e.enterprise_name,
        pe.charge_list_url, IF (( SELECT COUNT(*) FROM diyi_PAY_ENTERPRISE_RECEIPT per WHERE per.pay_enterprise_id =
        pe.id ) > 0, '', '' ) AS isPayEnterpriseReceipt, pe.subcontracting_invoice_state, pe.create_time FROM
        diyi_pay_enterprise pe INNER JOIN diyi_enterprise e ON e.id = pe.enterprise_id INNER JOIN
        diyi_MAKER_TOTAL_INVOICE m ON m.pay_enterprise_id = pe.id
        where pe.subcontracting_invoice_state = 'OPENED'
        <if test="param1 != null">
            AND pe.service_provider_id = #{param1}
        </if>
        <if test="param2 != null and param2 != ''">
            AND e.enterprise_name LIKE concat('%', #{param2}, '%')
        </if>
        <if test="param3 != null">
            AND DATEDIFF(pe.create_time, #{param3}) <![CDATA[ >= ]]> 0
        </if>
        <if test="param4 != null">
            AND DATEDIFF(pe.create_time, #{param4}) <![CDATA[ <= ]]> 0
        </if>
    </select>

    <select id="queryTotalInvoiceListEnterprise" resultMap="totalInvoiceListEnterVOMap">
        SELECT * FROM ( SELECT a.id AS invoice_application_pay_list_id, b.id AS application_id, null AS platform_invoice_pay_list_id, null AS invoice_print_id,
        d.enterprise_name, e.service_provider_name, b.application_state, null AS company_invoice_state, b.create_time, 1 AS apply_state,
        (SELECT sum(pay_to_platform_amount) FROM diyi_invoice_application t1 INNER JOIN diyi_invoice_application_pay_list t2 ON t1.id = t2.application_id
        INNER JOIN diyi_pay_enterprise t3 ON t3.id = t2.pay_enterprise_id WHERE t1.id = b.id ) AS pay_to_platform_amount FROM diyi_INVOICE_APPLICATION_PAY_LIST a
        INNER JOIN diyi_INVOICE_APPLICATION b ON b.id = a.application_id INNER JOIN diyi_pay_enterprise c ON c.id = a.pay_enterprise_id INNER JOIN diyi_enterprise d
        ON d.id = c.enterprise_id INNER JOIN diyi_service_provider e ON e.id = c.service_provider_id WHERE d.id = #{param1}
        AND b.application_state = 'APPLYING' AND c.audit_state = 'APPROVED' GROUP BY b.id UNION ALL SELECT null AS invoice_application_pay_list_id,
        null AS invoice_application_id, a.id AS platform_invoice_pay_list_id, b.id AS invoice_print_id, d.enterprise_name, e.service_provider_name,
        0 AS application_state, c.company_invoice_state, b.create_time, if(b.application_id is null,0,1) as  apply_state, ( SELECT sum(pay_to_platform_amount)
        FROM diyi_platform_invoice t1 INNER JOIN diyi_platform_invoice_pay_list t2 ON t1.id = t2.invoice_print_id INNER JOIN diyi_pay_enterprise t3
        ON t3.id = t2.pay_enterprise_id WHERE t1.id = b.id ) AS pay_to_platform_amount FROM diyi_platform_invoice_pay_list a INNER JOIN diyi_platform_invoice b
        ON a.invoice_print_id = b.id INNER JOIN diyi_pay_enterprise c ON c.id = a.pay_enterprise_id INNER JOIN diyi_enterprise d ON d.id = c.enterprise_id
        INNER JOIN diyi_service_provider e ON e.id = c.service_provider_id WHERE d.id = #{param1} AND c.company_invoice_state = 'OPENED'
        AND c.audit_state = 'APPROVED' GROUP BY b.id) AS tmp WHERE 1 = 1
<!--        <if test="param2 != null and param2 != ''">-->
<!--             AND enterprise_name like concat('%', #{param2}, '%')-->
<!--        </if>-->
        <if test="param2 != null and param2 != ''">
            AND service_provider_name like concat('%', #{param2}, '%')
        </if>
    </select>

    <select id="queryRelationEnterpriseService" resultMap="relationEnterpriseServiceVOMap">
        SELECT a.service_provider_id, b.service_provider_name, a.cooperate_status FROM diyi_enterprise_service_provider a INNER JOIN diyi_service_provider b
        ON a.service_provider_id = b.id WHERE cooperate_status = 'COOPERATING' AND a.enterprise_id = #{param1}
        <if test="param2 != null and param2 != ''">
             AND b.service_provider_name like concat('%', #{param2}, '%')
        </if>
    </select>

    <select id="queryEnterpriseServicePayList" resultMap="enterpriseServicePayListVOMap">
        SELECT a.id pay_enterprise_id, y.service_provider_name, a.create_time, a.charge_list_url FROM diyi_pay_enterprise a INNER JOIN diyi_service_provider y
        ON a.service_provider_id = y.id WHERE a.service_provider_id = #{param2} AND a.enterprise_id = #{param1} AND a.audit_state = 'APPROVED'
        AND a.company_invoice_state = 'UNOPEN' AND a.id NOT IN ( SELECT IF ( GROUP_CONCAT(d.pay_enterprise_id) IS NULL ,- 1, GROUP_CONCAT(d.pay_enterprise_id))
        FROM diyi_invoice_application c INNER JOIN diyi_invoice_application_pay_list d ON c.id = d.application_id WHERE c.application_state = 'APPLYING'
        OR c.application_state = 'ISSUEDINFULL' OR c.application_state = 'PARTIALLYISSUED' )
    </select>

    <select id="getServiceLumpSumInvoice" resultMap="invoiceServiceLumpMap">
        SELECT * FROM ( SELECT a.id AS invoice_application_pay_list_id, b.id AS invoice_application_id, null AS pay_enterprise_id, d.enterprise_name,
        e.service_provider_name, b.application_state, null AS company_invoice_state, b.create_time, b.application_desc, 1 AS apply_state,null as invoice_print_id
        FROM diyi_INVOICE_APPLICATION_PAY_LIST a INNER JOIN diyi_INVOICE_APPLICATION b ON b.id = a.application_id INNER JOIN diyi_pay_enterprise c
        ON c.id = a.pay_enterprise_id INNER JOIN diyi_enterprise d ON d.id = c.enterprise_id INNER JOIN diyi_service_provider e ON e.id = c.service_provider_id
        WHERE 1=1
        <if test="param1 != null">
            and e.id = #{param1}
        </if>
        AND b.application_state = 'APPLYING' and c.audit_state = 'APPROVED' GROUP BY b.create_time UNION ALL SELECT null AS invoice_application_pay_list_id, null AS invoice_application_id, a.id AS pay_enterprise_id, b.enterprise_name, c.service_provider_name, null AS application_state, a.company_invoice_state, a.create_time, null AS application_desc, 0 AS apply_state,null as invoice_print_id FROM diyi_pay_enterprise a INNER JOIN diyi_enterprise b ON b.id = a.enterprise_id INNER JOIN diyi_service_provider c ON c.id = a.service_provider_id WHERE a.company_invoice_state = 'UNOPEN' and a.audit_state = 'APPROVED' AND a.id NOT IN ( SELECT d.pay_enterprise_id FROM diyi_invoice_application c INNER JOIN diyi_invoice_application_pay_list d ON c.id = d.application_id WHERE c.application_state IN ( 'APPLYING', 'ISSUEDINFULL', 'PARTIALLYISSUED' ))
        <if test="param1 != null">
            AND a.service_provider_id = #{param1}
        </if>
        ) AS tmp where 1 = 1
        <if test="param2 != null and param2 != ''">
            AND tmp.enterprise_name LIKE concat('%', #{param2}, '%')
        </if>
        <if test="param3 != null">
            AND DATEDIFF(tmp.create_time, #{param3}) <![CDATA[ >= ]]> 0
        </if>
        <if test="param4 != null">
            AND DATEDIFF(tmp.create_time, #{param4}) <![CDATA[ <= ]]> 0
        </if>
    </select>

    <select id="getServiceOpenedLumpSumInvoice" resultMap="invoiceServiceLumpMap">
       SELECT null AS invoice_application_pay_list_id, tmp.application_id AS invoice_application_id, t3.id AS pay_enterprise_id, b.enterprise_name,
       c.service_provider_name, null AS application_state, t3.company_invoice_state, tmp.create_time, tmp.invoice_desc AS application_desc, IF ( tmp.application_id
       IS NULL, 0, 1 ) AS apply_state, tmp.id AS invoice_print_id FROM diyi_platform_invoice tmp INNER JOIN diyi_platform_invoice_pay_list t2
       ON tmp.id = t2.invoice_print_id INNER JOIN diyi_pay_enterprise t3 ON t3.id = t2.pay_enterprise_id INNER JOIN diyi_enterprise b ON b.id = t3.enterprise_id
       INNER JOIN diyi_service_provider c ON c.id = t3.service_provider_id INNER JOIN diyi_platform_invoice_list t4 ON t4.invoice_print_id = tmp.id WHERE 1 = 1
        <if test="param1 != null ">
            and c.id = #{param1}
        </if>
        <if test="param2 != null and param2 != ''">
            AND b.enterprise_name LIKE concat('%', #{param2}, '%')
        </if>
        <if test="param3 != null">
            AND DATEDIFF(tmp.create_time, #{param3}) <![CDATA[ >= ]]> 0
        </if>
        <if test="param4 != null">
            AND DATEDIFF(tmp.create_time, #{param4}) <![CDATA[ <= ]]> 0
        </if>
        GROUP BY tmp.id
    </select>

    <select id="findServiceSubcontractSummary" resultMap="EnterpriseSubcontractSummaryMap">
        SELECT pe.id AS pay_enterprise_id, mt.id AS maker_total_invoice_id, sp.id AS service_provider_id, mt.invoice_serial_no, mt.company_invoice_url,
        mt.maker_tax_url, pe.subcontracting_invoice_state, sp.service_provider_name, mt.create_time AS invoice_print_date, e.enterprise_name, pe.maker_invoice_type
        FROM diyi_pay_enterprise pe INNER JOIN diyi_service_provider sp ON sp.id = pe.service_provider_id INNER JOIN diyi_enterprise e ON e.id = pe.enterprise_id
        LEFT JOIN diyi_maker_total_invoice mt ON mt.pay_enterprise_id = pe.id AND mt.bool_deleted = 0 WHERE pe.bool_deleted = 0 AND sp.bool_deleted = 0
        and pe.audit_state ='APPROVED' AND sp.id = #{param1} and pe.subcontracting_invoice_state = #{param3}
        <if test="param2 != null and param2 != ''">
            AND e.enterprise_name LIKE concat('%', #{param2}, '%')
        </if>

    </select>

    <select id="findServiceDetailSummary" resultMap="InvoiceServiceDetailSummaryVO">
        SELECT a.id AS pay_enterprise_id, b.id AS enterprise_id, a.pay_to_platform_amount, b.enterprise_name, b.invoice_tax_no, b.invoice_address_phone,
        b.invoice_bank_name_account, c.service_provider_name, a.charge_list_url, a.worksheet_id, a.subcontracting_invoice_state, a.create_time,
        e.company_invoice_url, e.maker_tax_url, a.maker_invoice_type FROM diyi_pay_enterprise a INNER JOIN diyi_enterprise b ON a.enterprise_id = b.id
        INNER JOIN diyi_service_provider c ON c.id = a.service_provider_id LEFT JOIN diyi_maker_total_invoice e ON e.pay_enterprise_id = a.id WHERE a.id = #{param1}
    </select>

    <select id="getPayMakerLists" resultMap="payMakerListsVO">
        SELECT t1.id AS pay_maker_id, t2.id AS maker_id, t2.name, t2.idcard_no, t1.maker_net_income, t1.maker_tax_fee, t1.audit_fee, t1.pay_fee, t1.total_fee,
        t1.service_rate, mi.maker_voice_url, mt.maker_tax_url FROM diyi_pay_maker t1 INNER JOIN diyi_maker t2 ON t1.maker_id = t2.id
        LEFT JOIN diyi_maker_invoice mi ON mi.pay_maker_id = t1.id LEFT JOIN diyi_maker_tax_record mt ON mt.pay_maker_id = t1.id AND t2.bool_deleted = 0
        WHERE t1.bool_deleted = 0 AND t1.pay_enterprise_id in (#{param1})
    </select>

    <select id="queryPayEnterpriseDetail" resultMap="payEnterpriseDetailVO">
        SELECT t1.id, t2.enterprise_name, t3.service_provider_name, t1.charge_list_url, t1.worksheet_id, t1.audit_state, t1.create_time, t1.maker_invoice_type,
        t1.pay_state, t1.company_invoice_state, t1.subcontracting_invoice_state, t1.pay_to_platform_amount, (SELECT GROUP_CONCAT(enterprise_pay_receipt_url)
        FROM diyi_pay_enterprise_receipt WHERE bool_deleted = 0 AND pay_enterprise_id = t1.id) AS enterprise_pay_receipt_urls, (SELECT GROUP_CONCAT(accept_paysheet_url)
        FROM diyi_accept_paysheet WHERE bool_deleted = 0 AND pay_enterprise_id = t1.id) AS accept_paysheet_urls FROM diyi_pay_enterprise t1 INNER JOIN diyi_enterprise t2
        ON t1.enterprise_id = t2.id INNER JOIN diyi_service_provider t3 ON t1.service_provider_id = t3.id WHERE t1.bool_deleted = 0 AND t2.bool_deleted = 0
        AND t3.bool_deleted = 0 AND t1.id = #{param1}
    </select>

    <select id="queryPayEnterpriseUpdateDetail" resultMap="payEnterpriseUpdateDetailVO">
        SELECT t1.id, t2.id AS service_provider_id, t2.service_provider_name, t1.maker_type, t1.charge_list_url, t1.worksheet_id, t3.worksheet_no, t3.worksheet_name,
        t3.create_time AS worksheet_create_time, t1.pay_to_platform_amount, t1.total_tax_fee, t1.total_maker_net_income, t1.service_rate, t1.sourcing_amount, t1.enterprise_business_annual_fee,
        t1.identify_fee, t1.service_fee, t1.maker_num, t1.pay_memo, (SELECT GROUP_CONCAT(enterprise_pay_receipt_url) FROM diyi_pay_enterprise_receipt WHERE bool_deleted = 0
        AND pay_enterprise_id = t1.id) AS enterprise_pay_receipt_urls FROM diyi_pay_enterprise t1 INNER JOIN diyi_service_provider t2 ON t1.service_provider_id = t2.id
        LEFT JOIN diyi_worksheet t3 ON t1.worksheet_id = t3.id AND t3.bool_deleted = 0 WHERE t1.bool_deleted = 0 AND t2.bool_deleted = 0 AND t1.id = #{param1}
    </select>

    <select id="queryTotalInvoiceListEnterpriseApplyDetails" resultMap="enterpriseApplyDetailVoMap">
        SELECT t1.id AS invoice_application_id, t3.id AS pay_enterprise_id, t4.enterprise_name, t3.charge_list_url,
        (SELECT GROUP_CONCAT( per.enterprise_pay_receipt_url ) FROM diyi_pay_enterprise_receipt per WHERE t3.id = per.pay_enterprise_id )
        AS enterprise_pay_receipt_url, t3.worksheet_id, ( SELECT GROUP_CONCAT(ap.accept_paysheet_url) FROM diyi_accept_paysheet ap WHERE accept_paysheet_type = 'MANY'
        AND ap.pay_enterprise_id = t3.id ) AS accept_paysheet_url, 1 AS apply_state, t1.application_desc, ( SELECT invoice_catalog_name
        FROM diyi_enterprise_service_provider_invoice_catalogs esp WHERE t1.invoice_catalog_id = esp.id ) AS invoice_catalog_name, t3.pay_to_platform_amount,
        t5.service_provider_name, t1.application_state, t1.create_time, t4.invoice_enterprise_name, t4.invoice_tax_no, t4.invoice_address_phone,
        t4.invoice_bank_name_account, t6.address_name, t6.address_phone, t6.area, t6.city, t6.province, t6.detailed_address FROM diyi_invoice_application t1
        INNER JOIN diyi_invoice_application_pay_list t2 ON t2.application_id = t1.id INNER JOIN diyi_pay_enterprise t3 ON t3.id = t2.pay_enterprise_id
        INNER JOIN diyi_enterprise t4 ON t4.id = t3.enterprise_id INNER JOIN diyi_service_provider t5 ON t5.id = t3.service_provider_id left JOIN diyi_address t6
        ON t6.object_id = t4.id AND t6.object_type = 'ENTERPRISEPEOPLE' AND t6.bool_default = 1 AND t6.bool_deleted = 0 WHERE t1.bool_deleted = 0 AND t2.bool_deleted = 0
        AND t3.bool_deleted = 0 AND t4.bool_deleted = 0 AND t5.bool_deleted = 0 and t1.id = #{param1}
    </select>

    <select id="queryTotalInvoiceListEnterpriseInvoiceDetails" resultMap="enterpriseInvoiceDetailVoMap">
        SELECT t1.id AS invoice_print_id, t3.id AS pay_enterprise_id, t4.enterprise_name, t3.charge_list_url, (SELECT GROUP_CONCAT( per.enterprise_pay_receipt_url )
        FROM diyi_pay_enterprise_receipt per WHERE t3.id = per.pay_enterprise_id ) AS enterprise_pay_receipt_url, t3.worksheet_id,
        (SELECT GROUP_CONCAT(ap.accept_paysheet_url) FROM diyi_accept_paysheet ap WHERE accept_paysheet_type = 'MANY' AND ap.pay_enterprise_id = t3.id )
        AS accept_paysheet_url, ( IF ( t1.application_id IS NULL, 0, 1 )) AS apply_state, t1.invoice_desc, ( SELECT invoice_category FROM diyi_platform_invoice_list esp
        WHERE t1.id = esp.invoice_print_id ) AS invoice_category, t3.pay_to_platform_amount, t5.service_provider_name, t3.company_invoice_state, t1.create_time,
        t4.invoice_enterprise_name, t4.invoice_tax_no, t4.invoice_address_phone, t4.invoice_bank_name_account, t6.address_name, t6.address_phone, t6.area, t6.city,
        t6.province, t6.detailed_address, ( SELECT GROUP_CONCAT(company_invoice_url) FROM diyi_platform_invoice_list pli WHERE pli.invoice_print_id = t1.id )
        AS company_invoice_url, t1.express_sheet_no, t1.express_company_name,t1.opened_invoice_total_amount FROM diyi_platform_invoice t1 INNER JOIN diyi_platform_invoice_pay_list t2
        ON t1.id = t2.invoice_print_id INNER JOIN diyi_pay_enterprise t3 ON t3.id = t2.pay_enterprise_id INNER JOIN diyi_enterprise t4 ON t4.id = t3.enterprise_id
        INNER JOIN diyi_service_provider t5 ON t5.id = t3.service_provider_id left JOIN diyi_address t6 ON t6.object_id = t4.id AND t6.object_type = 'ENTERPRISEPEOPLE'
        AND t6.bool_default = 1 AND t6.bool_deleted = 0 WHERE t1.bool_deleted = 0 AND t2.bool_deleted = 0 AND t3.bool_deleted = 0 AND t4.bool_deleted = 0 AND t5.bool_deleted = 0
        AND t1.id = #{param1}
    </select>

    <select id="queryTotalMergeInvoice" resultMap="totalMergeInvoiceVoMap">
        SELECT t3.id AS pay_enterprise_id, t4.enterprise_name, t3.charge_list_url, ( SELECT GROUP_CONCAT( per.enterprise_pay_receipt_url )
        FROM diyi_pay_enterprise_receipt per WHERE t3.id = per.pay_enterprise_id ) AS enterprise_pay_receipt_url, t3.worksheet_id,
        (SELECT GROUP_CONCAT(ap.accept_paysheet_url) FROM diyi_accept_paysheet ap WHERE accept_paysheet_type = 'MANY' AND ap.pay_enterprise_id = t3.id )
        AS accept_paysheet_url, t3.pay_to_platform_amount, t5.service_provider_name, t4.invoice_enterprise_name, t4.invoice_tax_no, t4.invoice_address_phone,
        t4.invoice_bank_name_account, t6.address_name, t6.address_phone, t6.area, t6.city, t6.province, t6.detailed_address, t3.company_invoice_state, t3.create_time
        FROM diyi_pay_enterprise t3 INNER JOIN diyi_enterprise t4 ON t4.id = t3.enterprise_id INNER JOIN diyi_service_provider t5 ON t5.id = t3.service_provider_id
        left JOIN diyi_address t6 ON t6.object_id = t4.id AND t6.object_type = 'ENTERPRISEPEOPLE' AND t6.bool_default = 1 AND t6.bool_deleted = 0
        WHERE t3.bool_deleted = 0 AND t4.bool_deleted = 0 AND t5.bool_deleted = 0 AND t3.id IN (#{param1})
    </select>

    <select id="queryPayEnterpriseListAgentMain" resultMap="payEnterpriseListSimpleVO">
        SELECT t1.id, t2.enterprise_name, t3.service_provider_name, t1.pay_to_platform_amount, t1.audit_state, t1.create_time,
        (SELECT COUNT(id) FROM diyi_pay_maker WHERE bool_deleted = 0 AND pay_enterprise_id = t1.id) AS maker_num
        FROM diyi_pay_enterprise t1 INNER JOIN diyi_enterprise t2 ON t1.enterprise_id = t2.id INNER JOIN diyi_service_provider t3 ON t1.service_provider_id = t3.id
        WHERE t1.bool_deleted = 0 AND t2.bool_deleted = 0 AND t3.bool_deleted = 0
        <if test="param1 != null">
            AND t1.enterprise_id = #{param1}
        </if>
        <if test="param2 != null">
            AND t1.service_provider_id = #{param2}
        </if>
        <if test="param3.enterpriseName != null and param3.enterpriseName != ''">
            AND t2.enterprise_name LIKE concat('%', #{param3.enterpriseName}, '%')
        </if>
        <if test="param3.serviceProviderName != null and param3.serviceProviderName != ''">
            AND t3.service_provider_name LIKE concat('%', #{param3.serviceProviderName}, '%')
        </if>
        <if test="param3.beginDate != null">
            AND DATEDIFF(t1.create_time, #{param3.beginDate}) <![CDATA[ >= ]]> 0
        </if>
        <if test="param3.endDate != null">
            AND DATEDIFF(t1.create_time, #{param3.endDate}) <![CDATA[ <= ]]> 0
        </if>
    </select>

    <select id="queryPayEnterpriseExpress" resultMap="payEnterpriseExpressVO">
        SELECT t5.express_company_name, t5.express_sheet_no, t2.working_address AS receipt_working_address, t2.working_rel_name AS receipt_working_rel_name,
        t2.working_rel_phone AS receipt_working_rel_phone, t3.working_address AS send_working_address, t3.working_rel_name AS send_working_rel_name,
        t3.working_rel_phone AS send_working_rel_phone FROM diyi_pay_enterprise t1 INNER JOIN diyi_enterprise t2 ON t1.enterprise_id = t2.id
        INNER JOIN diyi_service_provider t3 ON t1.service_provider_id = t3.id INNER JOIN diyi_platform_invoice_pay_list t4 ON t1.id = t4.pay_enterprise_id
        INNER JOIN diyi_platform_invoice t5 ON t4.invoice_print_id = t5.id WHERE t1.bool_deleted = 0 AND t2.bool_deleted = 0 AND t3.bool_deleted = 0 AND t4.bool_deleted = 0
        AND t5.bool_deleted = 0 AND t1.id = #{param1} LIMIT 1
    </select>

</mapper>

