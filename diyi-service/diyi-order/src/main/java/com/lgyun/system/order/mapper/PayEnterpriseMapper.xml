<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.lgyun.system.order.mapper.PayEnterpriseMapper">

    <resultMap type="com.lgyun.system.order.vo.InvoiceEnterpriseVO" id="InvoiceEnterpriseVOMap">
        <result property="enterpriseId" column="enterprise_id"/>
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="payMakerId" column="pay_maker_id"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="worksheetType" column="worksheet_type"/>
        <result property="payToPlatformAmount" column="pay_to_platform_amount"/>
        <result property="makerVoiceUrl" column="maker_voice_url"/>
        <result property="makerTaxUrl" column="maker_tax_url"/>
        <result property="worksheetName" column="worksheet_name"/>
        <result property="worksheetMode" column="worksheet_mode"/>
        <result property="createTime" column="create_time"/>
        <result property="worksheetNo" column="worksheet_no"/>
        <result property="achievementFiles" column="achievement_files"/>
        <result property="checkMoney" column="check_money"/>
        <result property="makerNum" column="maker_num"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.PayEnterpriseListVO" id="payEnterpriseMakersListVO">
        <result property="id" column="id"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="chargeListUrl" column="charge_list_url"/>
        <result property="enterprisePayReceiptUrls" column="enterprise_pay_receipt_urls"/>
        <result property="worksheetId" column="worksheet_id"/>
        <result property="acceptPaysheetUrls" column="accept_paysheet_urls"/>
        <result property="auditState" column="audit_state"/>
        <result property="createTime" column="create_time"/>
    </resultMap>

    <resultMap id="EnterpriseLumpSumInvoiceMap" type="com.lgyun.system.order.vo.EnterpriseLumpSumInvoiceVO">
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="invoicePrintId" column="invoice_print_id"/>
        <result property="worksheetId" column="worksheet_id"/>
        <result property="enterpriseId" column="enterprise_id"/>
        <result property="serviceProviderId" column="service_provider_id"/>
        <result property="applicationId" column="application_id"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="chargeListUrl" column="charge_list_url"/>
        <result property="invoiceSerialNo" column="invoice_serial_no"/>
        <result property="companyInvoiceState" column="company_invoice_state"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="invoicePrintDate" column="invoice_print_date"/>
        <result property="expressSheetNo" column="express_sheet_no"/>
        <result property="expressCompanyName" column="express_company_name"/>
    </resultMap>

    <resultMap id="EnterprisePaymentListMap" type="com.lgyun.system.order.vo.EnterprisePaymentListVO">
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="serviceProviderId" column="service_provider_id"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="chargeListUrl" column="charge_list_url"/>
        <result property="createTime" column="create_time"/>
    </resultMap>

    <resultMap id="EnterpriseSubcontractSummaryMap" type="com.lgyun.system.order.vo.EnterpriseSubcontractInvoiceVO">
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="serviceProviderId" column="service_provider_id"/>
        <result property="makerTotalInvoiceId" column="maker_total_invoice_id"/>
        <result property="invoiceSerialNo" column="invoice_serial_no"/>
        <result property="companyInvoiceUrl" column="company_invoice_url"/>
        <result property="makerTaxUrl" column="maker_tax_url"/>
        <result property="subcontractingInvoiceState" column="subcontracting_invoice_state"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="invoicePrintDate" column="invoice_print_date"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="makerInvoiceType" column="maker_invoice_type"/>
    </resultMap>

    <resultMap id="EnterpriseSubcontractSummaryDetailMap" type="com.lgyun.system.order.vo.EnterpriseSubcontractInvoiceVO">
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="serviceProviderId" column="service_provider_id"/>
        <result property="makerTotalInvoiceId" column="maker_total_invoice_id"/>
        <result property="invoiceSerialNo" column="invoice_serial_no"/>
        <result property="companyInvoiceUrl" column="company_invoice_url"/>
        <result property="makerTaxUrl" column="maker_tax_url"/>
        <result property="subcontractingInvoiceState" column="subcontracting_invoice_state"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="invoicePrintDate" column="invoice_print_date"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="chargeListUrl" column="charge_list_url"/>
        <result property="worksheetId" column="worksheet_id"/>
        <result property="companyVoiceUploadDatetime" column="company_voice_upload_datetime"/>
        <result property="acceptPaysheetUrl" column="accept_paysheet_url"/>
        <result property="acceptPaysheetId" column="accept_paysheet_id"/>
    </resultMap>


    <resultMap id="EnterpriseSubcontractPortalMap" type="com.lgyun.system.order.vo.EnterpriseSubcontractPortalVO">
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="serviceProviderId" column="service_provider_id"/>
        <result property="payMakerId" column="pay_maker_id"/>
        <result property="makerInvoiceId" column="maker_invoice_id"/>
        <result property="makerTaxRecordId" column="maker_tax_record_id"/>
        <result property="voiceSerialNo" column="voice_serial_no"/>
        <result property="makerVoiceUrl" column="maker_voice_url"/>
        <result property="makerTaxUrl" column="maker_tax_url"/>
        <result property="companyInvoiceState" column="company_invoice_state"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="invoicePrintDate" column="invoice_print_date"/>
    </resultMap>

    <resultMap id="EnterpriseSubcontractPortalDetailMap" type="com.lgyun.system.order.vo.EnterpriseSubcontractPortalVO">
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="serviceProviderId" column="service_provider_id"/>
        <result property="payMakerId" column="pay_maker_id"/>
        <result property="makerInvoiceId" column="maker_invoice_id"/>
        <result property="makerTaxRecordId" column="maker_tax_record_id"/>
        <result property="voiceSerialNo" column="voice_serial_no"/>
        <result property="makerVoiceUrl" column="maker_voice_url"/>
        <result property="makerTaxUrl" column="maker_tax_url"/>
        <result property="companyInvoiceState" column="company_invoice_state"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="invoicePrintDate" column="invoice_print_date"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="chargeListUrl" column="charge_list_url"/>
        <result property="worksheetId" column="worksheet_id"/>
        <result property="acceptPaysheetUrl" column="accept_paysheet_url"/>
        <result property="acceptPaysheetId" column="accept_paysheet_id"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.PayMakerListInvoiceVO" id="payMakerListInvoiceVO">
        <result property="id" column="id"/>
        <result property="name" column="name"/>
        <result property="idcardNo" column="idcard_no"/>
        <result property="makerNetIncome" column="maker_net_income"/>
        <result property="makerTaxFee" column="maker_tax_fee"/>
        <result property="auditFee" column="audit_fee"/>
        <result property="payFee" column="pay_fee"/>
        <result property="totalFee" column="total_fee"/>
        <result property="serviceRate" column="service_rate"/>
        <result property="makerVoiceUrl" column="maker_voice_url"/>
        <result property="makerTaxUrl" column="maker_tax_url"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.PayMakerListServiceProviderVO" id="payMakerListsVO">
        <result property="payMakerId" column="pay_maker_id"/>
        <result property="makerId" column="maker_id"/>
        <result property="name" column="name"/>
        <result property="idcardNo" column="idcard_no"/>
        <result property="makerNetIncome" column="maker_net_income"/>
        <result property="makerTaxFee" column="maker_tax_fee"/>
        <result property="auditFee" column="audit_fee"/>
        <result property="payFee" column="pay_fee"/>
        <result property="totalFee" column="total_fee"/>
        <result property="serviceRate" column="service_rate"/>
        <result property="makerVoiceUrl" column="maker_voice_url"/>
        <result property="makerTaxUrl" column="maker_tax_url"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.PayMakerListWebVO" id="payMakerListServiceProviderVO">
        <result property="id" column="id"/>
        <result property="name" column="name"/>
        <result property="idcardNo" column="idcard_no"/>
        <result property="makerNetIncome" column="maker_net_income"/>
        <result property="makerTaxFee" column="maker_tax_fee"/>
        <result property="auditFee" column="audit_fee"/>
        <result property="payFee" column="pay_fee"/>
        <result property="totalFee" column="total_fee"/>
        <result property="serviceRate" column="service_rate"/>
        <result property="boolAcceptSheet" column="bool_accept_sheet"/>
        <result property="makerPayReceiptUrls" column="maker_pay_receipt_urls"/>
    </resultMap>

    <resultMap type="com.lgyun.system.user.vo.TransactionVO" id="transactionVO">
        <result property="totalSubMonthPay" column="total_sub_month_pay"/>
        <result property="totalSubYearPay" column="total_sub_year_pay"/>
        <result property="totalSubAllPay" column="total_sub_all_pay"/>
        <result property="crowdMonthPay" column="crowd_month_pay"/>
        <result property="crowdYearPay" column="crowd_year_pay"/>
        <result property="crowdAllPay" column="crowd_all_pay"/>
        <result property="makerNum" column="maker_num"/>
        <result property="enterpriseNum" column="enterprise_num"/>
        <result property="serviceProviderNum" column="service_provider_num"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.YearTradeVO" id="yearTradeVO">
        <result property="janIncome" column="jan_income"/>
        <result property="febIncome" column="feb_income"/>
        <result property="marIncome" column="mar_income"/>
        <result property="aprIncome" column="apr_income"/>
        <result property="mayIncome" column="may_income"/>
        <result property="junIncome" column="jun_income"/>
        <result property="julIncome" column="jul_income"/>
        <result property="augIncome" column="aug_income"/>
        <result property="sepIncome" column="sep_income"/>
        <result property="octIncome" column="oct_income"/>
        <result property="novIncome" column="nov_income"/>
        <result property="decIncome" column="dec_income"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.MonthTradeVO" id="monthTradeVO">
        <result property="oneDayIncome" column="one_day_income"/>
        <result property="twoDayIncome" column="two_day_income"/>
        <result property="threeDayIncome" column="three_day_income"/>
        <result property="fourDayIncome" column="four_day_income"/>
        <result property="fiveDayIncome" column="five_day_income"/>
        <result property="sixDayIncome" column="six_day_income"/>
        <result property="sevenDayIncome" column="seven_day_income"/>
        <result property="eightDayIncome" column="eight_day_income"/>
        <result property="nineDayIncome" column="nine_day_income"/>
        <result property="tenDayIncome" column="ten_day_income"/>
        <result property="elevenDayIncome" column="eleven_day_income"/>
        <result property="twelveDayIncome" column="twelve_day_income"/>
        <result property="thirteenDayIncome" column="thirteen_day_income"/>
        <result property="fourteenDayIncome" column="fourteen_day_income"/>
        <result property="fifteenDayIncome" column="fifteen_day_income"/>
        <result property="sixteenDayIncome" column="sixteen_day_income"/>
        <result property="seventeenDayIncome" column="seventeen_day_income"/>
        <result property="eighteenDayIncome" column="eighteen_day_income"/>
        <result property="nineteenDayIncome" column="nineteen_day_income"/>
        <result property="twentyDayIncome" column="twenty_day_income"/>
        <result property="twentyOneDayIncome" column="twenty_one_day_income"/>
        <result property="twentyTwoDayIncome" column="twenty_two_day_income"/>
        <result property="twentyThreeDayIncome" column="twenty_three_day_income"/>
        <result property="twentyFourDayIncome" column="twenty_four_day_income"/>
        <result property="twentyFiveDayIncome" column="twenty_five_day_income"/>
        <result property="twentySixDayIncome" column="twenty_six_day_income"/>
        <result property="twentySevenDayIncome" column="twenty_seven_day_income"/>
        <result property="twentyEightDayIncome" column="twenty_eight_day_income"/>
        <result property="twentyNineDayIncome" column="twenty_nine_day_income"/>
        <result property="thirtyDayIncome" column="thirty_day_income"/>
        <result property="thirtyOneDayIncome" column="thirty_one_day_income"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.WeekTradeVO" id="weekTradeVO">
        <result property="monIncome" column="mon_income"/>
        <result property="tueIncome" column="tue_income"/>
        <result property="wedIncome" column="wed_income"/>
        <result property="thuIncome" column="thu_income"/>
        <result property="friIncome" column="fri_income"/>
        <result property="satIncome" column="sat_income"/>
        <result property="sunIncome" column="sun_income"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.DayTradeVO" id="dayTradeVO">
        <result property="oneHourIncome" column="one_hour_income"/>
        <result property="twoHourIncome" column="two_hour_income"/>
        <result property="threeHourIncome" column="three_hour_income"/>
        <result property="fourHourIncome" column="four_hour_income"/>
        <result property="fiveHourIncome" column="five_hour_income"/>
        <result property="sixHourIncome" column="six_hour_income"/>
        <result property="sevenHourIncome" column="seven_hour_income"/>
        <result property="eightHourIncome" column="eight_hour_income"/>
        <result property="nineHourIncome" column="nine_hour_income"/>
        <result property="tenHourIncome" column="ten_hour_income"/>
        <result property="elevenHourIncome" column="eleven_hour_income"/>
        <result property="twelveHourIncome" column="twelve_hour_income"/>
        <result property="thirteenHourIncome" column="thirteen_hour_income"/>
        <result property="fourteenHourIncome" column="fourteen_hour_income"/>
        <result property="fifteenHourIncome" column="fifteen_hour_income"/>
        <result property="sixteenHourIncome" column="sixteen_hour_income"/>
        <result property="seventeenHourIncome" column="seventeen_hour_income"/>
        <result property="eighteenHourIncome" column="eighteen_hour_income"/>
        <result property="nineteenHourIncome" column="nineteen_hour_income"/>
        <result property="twentyHourIncome" column="twenty_hour_income"/>
        <result property="twentyOneHourIncome" column="twenty_one_hour_income"/>
        <result property="twentyTwoHourIncome" column="twenty_two_hour_income"/>
        <result property="twentyThreeHourIncome" column="twenty_three_hour_income"/>
        <result property="twentyFourHourIncome" column="twenty_four_hour_income"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.InvoiceServiceLumpVO" id="invoiceServiceLumpMap">
        <result property="invoiceApplicationPayListId" column="invoice_application_pay_list_id"/>
        <result property="invoiceApplicationId" column="invoice_application_id"/>
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="applicationState" column="application_state"/>
        <result property="companyInvoiceState" column="company_invoice_state"/>
        <result property="createTime" column="create_time"/>
        <result property="applicationDesc" column="application_desc"/>
        <result property="applyState" column="apply_state"/>
        <result property="invoicePrintId" column="invoice_print_id"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.InvoiceServiceLumpDetailsVO" id="InvoiceServiceLumpDetailsMap">
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="enterpriseId" column="enterprise_id"/>
        <result property="addressId" column="address_id"/>
        <result property="invoicePrintId" column="invoice_print_id"/>
        <result property="invoiceDetailId" column="invoice_detail_id"/>
        <result property="payToPlatformAmount" column="pay_to_platform_amount"/>
        <result property="invoiceCatalogName" column="invoice_catalog_name"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="invoiceTaxNo" column="invoice_tax_no"/>
        <result property="invoiceEnterpriseName" column="invoice_enterprise_name"/>
        <result property="invoiceAddressPhone" column="invoice_address_phone"/>
        <result property="invoiceBankNameAccount" column="invoice_bank_name_account"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="chargeListUrl" column="charge_list_url"/>
        <result property="worksheetId" column="worksheet_id"/>
        <result property="companyInvoiceState" column="company_invoice_state"/>
        <result property="createTime" column="create_time"/>
        <result property="addressName" column="address_name"/>
        <result property="addressPhone" column="address_phone"/>
        <result property="area" column="area"/>
        <result property="city" column="city"/>
        <result property="province" column="province"/>
        <result property="detailedAddress" column="detailed_address"/>
        <result property="expressSheetNo" column="express_sheet_no"/>
        <result property="expressCompanyName" column="express_company_name"/>
        <result property="companyInvoiceUrl" column="company_invoice_url"/>
        <result property="invoiceTypeNo" column="invoice_type_no"/>
        <result property="invoiceSerialNo" column="invoice_serial_no"/>
        <result property="invoiceCategory" column="invoice_category"/>
        <result property="invoiceDesc" column="invoice_desc"/>
    </resultMap>

    <resultMap id="invoiceServiceSubcontractMap" type="com.lgyun.system.order.vo.InvoiceServiceSubVO">
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="enterpriseId" column="enterprise_id"/>
        <result property="makerInvoiceType" column="maker_invoice_type"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="chargeListUrl" column="charge_list_url"/>
        <result property="isPayEnterpriseReceipt" column="isPayEnterpriseReceipt"/>
        <result property="subcontractingInvoiceState" column="subcontracting_invoice_state"/>
        <result property="createTime" column="create_time"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.InvoiceServiceSubDetailsVO" id="invoiceServiceSubDetailsMap">
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="enterpriseId" column="enterprise_id"/>
        <result property="payToPlatformAmount" column="pay_to_platform_amount"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="invoiceTaxNo" column="invoice_tax_no"/>
        <result property="invoiceAddressPhone" column="invoice_address_phone"/>
        <result property="invoiceBankNameAccount" column="invoice_bank_name_account"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="chargeListUrl" column="charge_list_url"/>
        <result property="worksheetId" column="worksheet_id"/>
        <result property="subcontractingInvoiceState" column="subcontracting_invoice_state"/>
        <result property="createTime" column="create_time"/>
    </resultMap>


    <resultMap type="com.lgyun.system.order.vo.TransactionByBureauServiceProviderInfoVO" id="transactionByBureauServiceProviderInfoVO">
        <result column="id" property="serviceProviderId" />
        <result column="bureau_service_provider_id" property="bureauServiceProviderId" />
        <result column="service_provider_name" property="serviceProviderName" />
        <result column="total_money" property="totalMoney" />
        <result column="bureau_service_provider_status" property="bureauServiceProviderStatus" />
        <result column="create_time" property="createTime" />
    </resultMap>

    <resultMap type="com.lgyun.system.user.vo.AgentMainTransactionVO" id="agentMainTransactionVO">
        <result property="totalSubMonthPay" column="total_sub_month_pay"/>
        <result property="totalSubYearPay" column="total_sub_year_pay"/>
        <result property="totalSubAllPay" column="total_sub_all_pay"/>
        <result property="crowdMonthPay" column="crowd_month_pay"/>
        <result property="crowdYearPay" column="crowd_year_pay"/>
        <result property="crowdAllPay" column="crowd_all_pay"/>
        <result property="makerNum" column="maker_num"/>
        <result property="serviceProviderNum" column="service_provider_num"/>
    </resultMap>

    <resultMap id="adminAgentMainServiceProviderListVO" type="com.lgyun.system.user.vo.AdminAgentMainServiceProviderListVO">
        <result column="id" property="id"/>
        <result column="service_provider_id" property="serviceProviderId"/>
        <result column="service_provider_name" property="serviceProviderName"/>
        <result column="total_money" property="amount"/>
        <result column="cooperate_status" property="cooperateStatus"/>
        <result column="start_datetime" property="startDatetime"/>
    </resultMap>

    <resultMap id="partnerServiceProviderListVO" type="com.lgyun.system.user.vo.PartnerServiceProviderListVO">
        <result column="service_provider_id" property="serviceProviderId"/>
        <result column="service_provider_name" property="serviceProviderName"/>
        <result column="total_money" property="amount"/>
        <result column="create_time" property="createTime"/>
    </resultMap>

    <resultMap id="totalInvoiceListEnterVOMap" type="com.lgyun.system.order.vo.TotalInvoiceListEnterVO">
        <result column="platform_invoice_pay_list_id" property="platformInvoicePayListId"/>
        <result column="invoice_print_id" property="invoicePrintId"/>
        <result column="invoice_application_pay_list_id" property="invoiceApplicationPayListId"/>
        <result column="application_id" property="applicationId"/>
        <result column="enterprise_name" property="enterpriseName"/>
        <result column="service_provider_name" property="serviceProviderName"/>
        <result column="company_invoice_state" property="companyInvoiceState"/>
        <result column="application_state" property="applicationState"/>
        <result column="create_time" property="createTime"/>
        <result column="apply_state" property="applyState"/>
        <result column="company_invoice_state" property="companyInvoiceState"/>
        <result column="application_state" property="applicationState"/>
        <result column="pay_to_platform_amount" property="payToPlatformAmount"/>
    </resultMap>


    <resultMap id="relationEnterpriseServiceVOMap" type="com.lgyun.system.order.vo.RelationEnterpriseServiceVO">
        <result column="service_provider_id" property="serviceProviderId"/>
        <result column="service_provider_name" property="serviceProviderName"/>
        <result column="cooperate_status" property="cooperateStatus"/>
    </resultMap>

    <resultMap id="enterpriseServicePayListVOMap" type="com.lgyun.system.order.vo.EnterpriseServicePayListVO">
        <result column="pay_enterprise_id" property="payEnterpriseId"/>
        <result column="service_provider_name" property="serviceProviderName"/>
        <result column="create_time" property="createTime"/>
        <result column="charge_list_url" property="chargeListUrl"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.InvoiceServiceDetailSummaryVO" id="InvoiceServiceDetailSummaryVO">
        <result column="pay_enterprise_id" property="payEnterpriseId"/>
        <result column="enterprise_id" property="enterpriseId"/>
        <result column="pay_to_platform_amount" property="payToPlatformAmount"/>
        <result column="enterprise_name" property="enterpriseName"/>
        <result column="invoice_tax_no" property="invoiceTaxNo"/>
        <result property="invoiceAddressPhone" column="invoice_address_phone"/>
        <result property="invoiceBankNameAccount" column="invoice_bank_name_account"/>
        <result column="service_provider_name" property="serviceProviderName"/>
        <result column="charge_list_url" property="chargeListUrl"/>
        <result column="worksheet_id" property="worksheetId"/>
        <result column="subcontracting_invoice_state" property="subcontractingInvoiceState"/>
        <result column="create_time" property="createTime"/>
        <result column="company_invoice_url" property="companyInvoiceUrl"/>
        <result column="maker_tax_url" property="makerTaxUrl"/>
        <result column="maker_invoice_type" property="makerInvoiceType"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.PayEnterpriseDetailVO" id="payEnterpriseDetailVO">
        <result property="id" column="id"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="chargeListUrl" column="charge_list_url"/>
        <result property="enterprisePayReceiptUrls" column="enterprise_pay_receipt_urls"/>
        <result property="worksheetId" column="worksheet_id"/>
        <result property="acceptPaysheetUrls" column="accept_paysheet_urls"/>
        <result property="auditState" column="audit_state"/>
        <result property="createTime" column="create_time"/>
        <result property="makerInvoiceType" column="maker_invoice_type"/>
        <result property="payState" column="pay_state"/>
        <result property="companyInvoiceState" column="company_invoice_state"/>
        <result property="subcontractingInvoiceState" column="subcontracting_invoice_state"/>
        <result property="payToPlatformAmount" column="pay_to_platform_amount"/>
    </resultMap>

    <resultMap type="com.lgyun.system.order.vo.PayEnterpriseUpdateDetailVO" id="payEnterpriseUpdateDetailVO">
        <result property="id" column="id"/>
        <result property="serviceProviderId" column="service_provider_id"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="makerType" column="maker_type"/>
        <result property="chargeListUrl" column="charge_list_url"/>
        <result property="worksheetId" column="worksheet_id"/>
        <result property="worksheetNo" column="worksheet_no"/>
        <result property="worksheetName" column="worksheet_name"/>
        <result property="worksheetCreateTime" column="worksheet_create_time"/>
        <result property="payToPlatformAmount" column="pay_to_platform_amount"/>
        <result property="totalTaxFee" column="total_tax_fee"/>
        <result property="totalMakerNetIncome" column="total_maker_net_income"/>
        <result property="serviceRate" column="service_rate"/>
        <result property="sourcingAmount" column="sourcing_amount"/>
        <result property="enterpriseBusinessAnnualFee" column="enterprise_business_annual_fee"/>
        <result property="identifyFee" column="identify_fee"/>
        <result property="serviceFee" column="service_fee"/>
        <result property="makerNum" column="maker_num"/>
        <result property="payMemo" column="pay_memo"/>
        <result property="enterprisePayReceiptUrls" column="enterprise_pay_receipt_urls"/>
    </resultMap>


    <resultMap type="com.lgyun.system.order.vo.EnterpriseApplyDetailVO" id="enterpriseApplyDetailVoMap">
        <result property="invoiceApplicationId" column="invoice_application_id"/>
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="chargeListUrl" column="charge_list_url"/>
        <result property="enterprisePayReceiptUrl" column="enterprise_pay_receipt_url"/>
        <result property="worksheetId" column="worksheet_id"/>
        <result property="acceptPaysheetUrl" column="accept_paysheet_url"/>
        <result property="applyState" column="apply_state"/>
        <result property="applicationDesc" column="application_desc"/>
        <result property="invoiceCatalogName" column="invoice_catalog_name"/>
        <result property="payToPlatformAmount" column="pay_to_platform_amount"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="applicationState" column="application_state"/>
        <result property="createTime" column="create_time"/>
        <result property="invoiceEnterpriseName" column="invoice_enterprise_name"/>
        <result property="invoiceTaxNo" column="invoice_tax_no"/>
        <result property="invoiceAddressPhone" column="invoice_address_phone"/>
        <result property="invoiceBankNameAccount" column="invoice_bank_name_account"/>
        <result property="addressName" column="address_name"/>
        <result property="addressPhone" column="address_phone"/>
        <result property="area" column="area"/>
        <result property="city" column="city"/>
        <result property="province" column="province"/>
        <result property="detailedAddress" column="detailed_address"/>
    </resultMap>


     <resultMap type="com.lgyun.system.order.vo.EnterpriseInvoiceDetailVO" id="enterpriseInvoiceDetailVoMap">
        <result property="invoicePrintId" column="invoice_print_id"/>
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="chargeListUrl" column="charge_list_url"/>
        <result property="enterprisePayReceiptUrl" column="enterprise_pay_receipt_url"/>
        <result property="worksheetId" column="worksheet_id"/>
        <result property="acceptPaysheetUrl" column="accept_paysheet_url"/>
        <result property="applyState" column="apply_state"/>
        <result property="invoiceDesc" column="invoice_desc"/>
        <result property="invoiceCategory" column="invoice_category"/>
        <result property="payToPlatformAmount" column="pay_to_platform_amount"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="companyInvoiceState" column="company_invoice_state"/>
        <result property="createTime" column="create_time"/>
        <result property="invoiceEnterpriseName" column="invoice_enterprise_name"/>
        <result property="invoiceTaxNo" column="invoice_tax_no"/>
        <result property="invoiceAddressPhone" column="invoice_address_phone"/>
        <result property="invoiceBankNameAccount" column="invoice_bank_name_account"/>
        <result property="addressName" column="address_name"/>
        <result property="addressPhone" column="address_phone"/>
        <result property="area" column="area"/>
        <result property="city" column="city"/>
        <result property="province" column="province"/>
        <result property="detailedAddress" column="detailed_address"/>
         <result property="companyInvoiceUrl" column="company_invoice_url"/>
        <result property="expressSheetNo" column="express_sheet_no"/>
        <result property="expressCompanyName" column="express_company_name"/>
    </resultMap>

     <resultMap type="com.lgyun.system.order.vo.TotalMergeInvoiceVO" id="totalMergeInvoiceVoMap">
        <result property="payEnterpriseId" column="pay_enterprise_id"/>
        <result property="enterpriseName" column="enterprise_name"/>
        <result property="chargeListUrl" column="charge_list_url"/>
        <result property="enterprisePayReceiptUrl" column="enterprise_pay_receipt_url"/>
        <result property="worksheetId" column="worksheet_id"/>
        <result property="acceptPaysheetUrl" column="accept_paysheet_url"/>
        <result property="payToPlatformAmount" column="pay_to_platform_amount"/>
        <result property="serviceProviderName" column="service_provider_name"/>
        <result property="companyInvoiceState" column="company_invoice_state"/>
        <result property="createTime" column="create_time"/>
        <result property="invoiceEnterpriseName" column="invoice_enterprise_name"/>
        <result property="invoiceTaxNo" column="invoice_tax_no"/>
        <result property="invoiceAddressPhone" column="invoice_address_phone"/>
        <result property="invoiceBankNameAccount" column="invoice_bank_name_account"/>
        <result property="addressName" column="address_name"/>
        <result property="addressPhone" column="address_phone"/>
        <result property="area" column="area"/>
        <result property="city" column="city"/>
        <result property="province" column="province"/>
        <result property="detailedAddress" column="detailed_address"/>
    </resultMap>

    <select id="getEnterpriseAll" resultMap="InvoiceEnterpriseVOMap">
        SELECT e.id AS enterprise_id, pe.id AS pay_enterprise_id, pm.id AS pay_maker_id, e.enterprise_name AS enterprise_name FROM diyi_enterprise e
        INNER JOIN diyi_pay_enterprise pe ON e.id = pe.enterprise_id INNER JOIN diyi_pay_maker pm ON pm.pay_enterprise_id = pe.id
        WHERE e.is_deleted = 0 AND pe.is_deleted = 0 AND pm.is_deleted = 0 AND pm.maker_id = #{param1} GROUP BY e.id
    </select>

    <select id="getEnterpriseMakerIdAll" resultMap="InvoiceEnterpriseVOMap">
        SELECT e.id AS enterprise_id,pe.maker_num, pe.id AS pay_enterprise_id, pm.id AS pay_maker_id, e.enterprise_name AS enterprise_name,
        s.service_provider_name AS service_provider_name, w.worksheet_type, pe.pay_to_platform_amount FROM diyi_enterprise e INNER JOIN diyi_pay_enterprise pe
        ON e.id = pe.enterprise_id INNER JOIN diyi_pay_maker pm ON pm.pay_enterprise_id = pe.id INNER JOIN diyi_service_provider s ON pe.service_provider_id = s.id
        LEFT JOIN diyi_worksheet w ON w.id = pe.worksheet_id AND w.is_deleted = 0 WHERE e.is_deleted = 0 AND pe.is_deleted = 0 AND pm.is_deleted = 0 AND
        s.is_deleted = 0 AND pm.maker_id = #{param1} and e.id= #{param2}
    </select>

    <select id="getEnterpriseMakerIdDetail" resultMap="InvoiceEnterpriseVOMap">
        SELECT e.id AS enterprise_id, pe.id AS pay_enterprise_id, pm.id AS pay_maker_id, e.enterprise_name AS enterprise_name,
        s.service_provider_name AS service_provider_name, w.worksheet_type, pe.pay_to_platform_amount, mi.maker_voice_url, mtr.maker_tax_url, w.worksheet_name,
        w.worksheet_mode, w.create_time, w.worksheet_no, wm.achievement_desc, wm.achievement_files, wm.check_money FROM diyi_enterprise e
        INNER JOIN diyi_pay_enterprise pe ON e.id = pe.enterprise_id INNER JOIN diyi_service_provider s ON pe.service_provider_id = s.id
        INNER JOIN diyi_pay_maker pm ON pm.pay_enterprise_id = pe.id LEFT JOIN diyi_worksheet w ON w.id = pe.worksheet_id AND w.is_deleted = 0
        INNER JOIN diyi_maker_invoice mi ON mi.pay_maker_id = pm.id INNER JOIN diyi_maker_tax_record mtr ON mtr.pay_maker_id = pm.id LEFT JOIN diyi_worksheet_maker wm
        ON pe.worksheet_id = wm.worksheet_id AND wm.is_deleted = 0 WHERE e.is_deleted = 0 AND pe.is_deleted = 0 AND s.is_deleted = 0 AND pm.is_deleted = 0 AND
        mi.is_deleted = 0 and mtr.is_deleted = 0 and pm.maker_id = #{param1} and e.id= #{param2} and pm.id=#{param3}
    </select>

    <select id="getPayEnterpriseList" resultMap="payEnterpriseMakersListVO">
        SELECT t1.id, t2.enterprise_name, t3.service_provider_name, t1.charge_list_url, t1.worksheet_id, t1.audit_state, t1.create_time,
        (SELECT GROUP_CONCAT(enterprise_pay_receipt_url) FROM diyi_pay_enterprise_receipt WHERE is_deleted = 0 AND pay_enterprise_id = t1.id) AS enterprise_pay_receipt_urls,
        (SELECT GROUP_CONCAT(accept_paysheet_url) FROM diyi_accept_paysheet WHERE is_deleted = 0 AND pay_enterprise_id = t1.id) AS accept_paysheet_urls
        FROM diyi_pay_enterprise t1 INNER JOIN diyi_enterprise t2 ON t1.enterprise_id = t2.id INNER JOIN diyi_service_provider t3 ON t1.service_provider_id = t3.id
        WHERE t1.is_deleted = 0 AND t2.is_deleted = 0 AND t3.is_deleted = 0
        <if test="param1 != null">
            AND t1.enterprise_id = #{param1}
        </if>
        <if test="param2 != null">
            AND t1.service_provider_id = #{param2}
            AND t1.audit_state <![CDATA[ <> ]]> 'EDITING'
        </if>
        <if test="param3.serviceProviderName != null and param3.serviceProviderName.trim() != ''">
            AND t3.service_provider_name LIKE concat('%', #{param3.serviceProviderName}, '%')
        </if>
        <if test="param3.enterpriseName != null and param3.enterpriseName.trim() != ''">
            AND t2.enterprise_name LIKE concat('%', #{param3.enterpriseName}, '%')
        </if>
        <if test="param3.payEnterpriseAuditState != null">
            AND t1.pay_enterprise_audit_state = #{param3.payEnterpriseAuditState}
        </if>
        <if test="param3.beginDate != null">
            AND DATEDIFF(t1.create_time, #{param3.beginDate}) <![CDATA[ >= ]]> 0
        </if>
        <if test="param3.endDate != null">
            AND DATEDIFF(t1.create_time, #{param3.endDate}) <![CDATA[ <= ]]> 0
        </if>
    </select>

    <select id="findEnterpriseLumpSumInvoice" resultMap="EnterpriseLumpSumInvoiceMap">
        SELECT pe.id AS pay_enterprise_id, pi.id AS invoice_print_id, e.id AS enterprise_id, sp.id AS
        service_provider_id, ia.id AS application_id, e.enterprise_name,pe.worksheet_id, sp.service_provider_name,
        pe.charge_list_url, pil.invoice_serial_no, pil.company_invoice_url, pe.company_invoice_state,
        pe.invoice_print_date, pi.express_sheet_no, pi.express_company_name FROM diyi_PLATFORM_INVOICE_PAY_LIST pipl
        INNER JOIN diyi_pay_enterprise pe ON pe.id = pipl.pay_enterprise_id INNER JOIN diyi_platform_invoice pi ON pi.id
        = pipl.invoice_print_id INNER JOIN diyi_platform_invoice_list pil ON pil.invoice_print_id = pi.id INNER JOIN
        diyi_enterprise e ON e.id = pe.enterprise_id INNER JOIN diyi_service_provider sp ON sp.id =
        pe.service_provider_id LEFT JOIN diyi_INVOICE_APPLICATION ia ON ia.id = pi.application_id AND ia.is_deleted = 0
        and ia.application_state != 'CANCELLED' and ia.application_state !='REJECTED'
        WHERE pipl.is_deleted = 0 AND pe.is_deleted = 0 AND pi.is_deleted = 0 AND pil.is_deleted = 0 AND e.is_deleted =
        0 AND sp.is_deleted = 0 and pe.enterprise_id = #{param5}
        <if test="param1 != null and param1 != ''">
            AND pil.invoice_serial_no LIKE concat('%', #{param1}, '%')
        </if>
        <if test="param2 != null and param2 != ''">
            AND sp.service_provider_name LIKE concat('%', #{param2}, '%')
        </if>
        <if test="param3 != null and param3 != ''">
            AND DATEDIFF(pe.create_time, #{param3}) <![CDATA[ >= ]]> 0
        </if>
        <if test="param4 != null and param4 != ''">
            AND DATEDIFF(pe.create_time, #{param4}) <![CDATA[ <= ]]> 0
        </if>
    </select>

    <select id="findPayEnterpriseDetails" resultMap="EnterpriseLumpSumInvoiceMap">
        SELECT pe.id AS pay_enterprise_id, pi.id AS invoice_print_id, e.id AS enterprise_id, sp.id AS service_provider_id, ia.id AS application_id,
        e.enterprise_name, sp.service_provider_name, pe.charge_list_url, pil.invoice_serial_no, pil.company_invoice_url, pe.company_invoice_state,
        pe.invoice_print_date, pe.worksheet_id, pi.express_sheet_no, pi.express_company_name FROM diyi_PLATFORM_INVOICE_PAY_LIST pipl INNER JOIN diyi_pay_enterprise
        pe ON pe.id = pipl.pay_enterprise_id INNER JOIN diyi_platform_invoice pi ON pi.id = pipl.invoice_print_id INNER JOIN diyi_platform_invoice_list pil
        ON pil.invoice_print_id = pi.id INNER JOIN diyi_enterprise e ON e.id = pe.enterprise_id INNER JOIN diyi_service_provider sp ON sp.id = pe.service_provider_id
        LEFT JOIN diyi_INVOICE_APPLICATION ia ON ia.id = pi.application_id AND ia.is_deleted = 0 AND ia.application_state != 'CANCELLED' and ia.application_state !='REJECTED' WHERE pipl.is_deleted = 0
        AND pe.is_deleted = 0 AND pi.is_deleted = 0 AND pil.is_deleted = 0 AND e.is_deleted = 0 AND sp.is_deleted = 0 AND pe.id = #{param1}
    </select>

    <select id="findEnterprisePaymentList" resultMap="EnterprisePaymentListMap">
        SELECT pe.id AS pay_enterprise_id, sp.id AS service_provider_id, sp.service_provider_name, pe.charge_list_url,
        pe.create_time AS create_time
        FROM diyi_pay_enterprise pe INNER JOIN diyi_service_provider sp ON pe.service_provider_id = sp.id INNER JOIN
        diyi_platform_invoice_pay_list pl on pl.pay_enterprise_id = pe.id
        where pe.company_invoice_state != 'OPENED' and pe.enterprise_id = #{param1}
        <if test="param2 != null and param2 != ''">
            AND sp.service_provider_name LIKE concat('%', #{param2}, '%')
        </if>
    </select>

    <select id="findEnterpriseSubcontractSummary" resultMap="EnterpriseSubcontractSummaryMap">
        SELECT pe.id AS pay_enterprise_id, mt.id AS maker_total_invoice_id, sp.id AS service_provider_id, mt.invoice_serial_no, mt.company_invoice_url, mt.maker_tax_url, pe.subcontracting_invoice_state, sp.service_provider_name, mt.create_time as invoice_print_date, e.enterprise_name FROM diyi_pay_enterprise pe INNER JOIN diyi_maker_total_invoice mt ON mt.pay_enterprise_id = pe.id INNER JOIN diyi_service_provider sp ON sp.id = pe.service_provider_id INNER JOIN diyi_enterprise e ON pe.enterprise_id = e.id WHERE pe.is_deleted = 0 AND mt.is_deleted = 0 AND sp.is_deleted = 0 AND pe.subcontracting_invoice_state = 'OPENED' and pe.enterprise_id = #{param1}
        <if test="param2 != null and param2 != ''">
            AND sp.service_provider_name LIKE concat('%', #{param2}, '%')
        </if>
    </select>

    <select id="findEnterpriseSubcontractPortal" resultMap="EnterpriseSubcontractPortalMap">
        SELECT pe.id AS pay_enterprise_id,sp.id as service_provider_id, pm.id AS pay_maker_id, mi.id AS
        maker_invoice_id, mtr.id AS maker_tax_record_id,
        mi.voice_serial_no, mi.maker_voice_url, mtr.maker_tax_url, pe.company_invoice_state, sp.service_provider_name,
        pe.invoice_print_date
        FROM diyi_pay_enterprise pe INNER JOIN diyi_pay_maker pm ON pm.pay_enterprise_id = pe.id INNER JOIN
        diyi_maker_invoice mi ON mi.pay_maker_id = pm.id
        INNER JOIN diyi_service_provider sp ON pe.service_provider_id = sp.id LEFT JOIN diyi_maker_tax_record mtr ON
        pm.id = mtr.pay_maker_id AND mtr.is_deleted = 0
        WHERE pe.is_deleted = 0 AND pm.is_deleted = 0 AND mi.is_deleted = 0 AND sp.is_deleted = 0 and pe.enterprise_id =
        #{param1}
        <if test="param2 != null and param2 != ''">
            AND sp.service_provider_name LIKE concat('%', #{param2}, '%')
        </if>
    </select>

    <select id="findDetailSummary" resultMap="EnterpriseSubcontractSummaryDetailMap">
        SELECT pe.id AS pay_enterprise_id, mt.id AS maker_total_invoice_id, sp.id AS service_provider_id, mt.invoice_serial_no, mt.company_invoice_url,
        mt.maker_tax_url, pe.subcontracting_invoice_state, sp.service_provider_name, pe.invoice_print_date, e.enterprise_name, pe.charge_list_url, pe.worksheet_id,
        mt.company_voice_upload_datetime, ap.accept_paysheet_url,ap.id as accept_paysheet_id FROM diyi_pay_enterprise pe INNER JOIN diyi_enterprise e ON pe.enterprise_id = e.id
        INNER JOIN diyi_maker_total_invoice mt ON mt.pay_enterprise_id = pe.id INNER JOIN diyi_service_provider sp ON sp.id = pe.service_provider_id
        LEFT JOIN diyi_accept_paysheet ap ON ap.pay_enterprise_id = pe.id AND ap.accept_paysheet_type = 'MANY'
         where pe.is_deleted= 0 and mt.is_deleted = 0 and sp.is_deleted = 0 and mt.id = #{param1}
    </select>

    <select id="findDetailSubcontractPortal" resultMap="EnterpriseSubcontractPortalDetailMap">
        SELECT pe.id AS pay_enterprise_id, sp.id AS service_provider_id, pm.id AS pay_maker_id, mi.id AS maker_invoice_id, mtr.id AS maker_tax_record_id,
        mi.voice_serial_no, mi.maker_voice_url, mtr.maker_tax_url, pe.company_invoice_state, sp.service_provider_name, pe.invoice_print_date, e.enterprise_name,
        pe.charge_list_url, pe.worksheet_id, ap.accept_paysheet_url,ap.id as accept_paysheet_id FROM diyi_pay_enterprise pe INNER JOIN diyi_enterprise e ON e.id = pe.enterprise_id
        INNER JOIN diyi_pay_maker pm ON pm.pay_enterprise_id = pe.id INNER JOIN diyi_maker_invoice mi ON mi.pay_maker_id = pm.id INNER JOIN diyi_service_provider sp
        ON pe.service_provider_id = sp.id LEFT JOIN diyi_accept_paysheet ap ON ap.pay_enterprise_id = pe.id AND ap.accept_paysheet_type = 'MANY'
        LEFT JOIN diyi_maker_tax_record mtr ON pm.id = mtr.pay_maker_id AND mtr.is_deleted = 0 WHERE pe.is_deleted = 0 AND pm.is_deleted = 0 AND mi.is_deleted = 0
        AND sp.is_deleted = 0 and mi.id = #{param1}
    </select>

    <select id="queryPayMakerListInvoice" resultMap="payMakerListInvoiceVO">
        SELECT t2.id, t2.name, t2.idcard_no, t1.maker_net_income, t1.maker_tax_fee, t1.audit_fee, t1.pay_fee, t1.total_fee, t1.service_rate, mi.maker_voice_url,
        mt.maker_tax_url FROM diyi_pay_maker t1 INNER JOIN diyi_maker t2 ON t1.maker_id = t2.id LEFT JOIN diyi_maker_invoice mi ON mi.pay_maker_id = t1.id
        LEFT JOIN diyi_maker_tax_record mt ON mt.pay_maker_id = t1.id AND t2.is_deleted = 0 WHERE t1.is_deleted = 0 AND t1.pay_enterprise_id = #{param1}
    </select>

    <select id="getPayMakerListByPayEnterprise" resultMap="payMakerListServiceProviderVO">
        SELECT t1.id, t2.name, t2.idcard_no, t1.maker_net_income, t1.maker_tax_fee, t1.audit_fee, t1.pay_fee, t1.total_fee, t1.service_rate,
        IF(((SELECT COUNT(id) FROM diyi_accept_paysheet WHERE is_deleted = 0 AND pay_maker_id = t1.id) > 0 OR (SELECT COUNT(id) FROM diyi_accept_paysheet_list
        WHERE is_deleted = 0 AND pay_maker_id = t1.id) > 0), TRUE, FALSE) AS bool_accept_sheet, (SELECT GROUP_CONCAT(maker_pay_receipt_url)
        FROM diyi_pay_maker_receipt WHERE is_deleted = 0 AND pay_maker_id = t1.id) AS maker_pay_receipt_urls FROM diyi_pay_maker t1 INNER JOIN diyi_maker t2
        ON t1.maker_id = t2.id WHERE t1.is_deleted = 0 AND t2.is_deleted = 0 AND t1.pay_enterprise_id = #{param1}
    </select>

    <select id="transactionByEnterprise" resultMap="transactionVO">
        SELECT t1.month_pay AS total_sub_month_pay, t1.year_pay AS total_sub_year_pay, t1.all_pay AS total_sub_all_pay, t2.month_pay AS crowd_month_pay,
        t2.year_pay AS crowd_year_pay, t2.all_pay AS crowd_all_pay, (SELECT COUNT(DISTINCT id) FROM diyi_maker_enterprise WHERE is_deleted = 0
        AND relationship_type != 'NORELATION' AND enterprise_id = #{param1}) AS maker_num, (SELECT COUNT(id) FROM diyi_enterprise_service_provider WHERE is_deleted = 0
        AND cooperate_status = 'COOPERATING' AND enterprise_id = #{param1}) AS service_provider_num FROM (SELECT IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 30,
        pay_to_platform_amount, 0)), 0) AS month_pay, IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 365, pay_to_platform_amount, 0)), 0) AS year_pay,
        IFNULL(SUM(pay_to_platform_amount), 0) AS all_pay FROM diyi_pay_enterprise WHERE is_deleted = 0 AND audit_state = 'APPROVED'
        AND enterprise_id = #{param1}) t1, (SELECT IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 30, total_pay_provider_fee, 0)), 0) AS month_pay,
        IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 365, total_pay_provider_fee, 0)), 0) AS year_pay, IFNULL(SUM(total_pay_provider_fee), 0) AS all_pay
        FROM diyi_self_help_invoice WHERE is_deleted = 0 AND (current_state = 'PAID' AND current_state = 'INVOICED') AND apply_enterprise_id = #{param1}) t2
    </select>

    <select id="transactionByServiceProvider" resultMap="transactionVO">
        SELECT t1.month_pay AS total_sub_month_pay, t1.year_pay AS total_sub_year_pay, t1.all_pay AS total_sub_all_pay,
        t2.month_pay AS crowd_month_pay, t2.year_pay AS crowd_year_pay, t2.all_pay AS crowd_all_pay,
        (SELECT COUNT(DISTINCT id) FROM diyi_service_provider_maker WHERE is_deleted = 0 AND service_provider_id = #{param1}) AS maker_num,
        (SELECT COUNT(id) FROM diyi_enterprise_service_provider WHERE is_deleted = 0 AND cooperate_status = 'COOPERATING' AND service_provider_id = #{param1})
        AS enterprise_num FROM (SELECT IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 30, pay_to_platform_amount, 0)), 0) AS month_pay,
        IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 365, pay_to_platform_amount, 0)), 0) AS year_pay,
        IFNULL(SUM(pay_to_platform_amount), 0) AS all_pay FROM diyi_pay_enterprise WHERE is_deleted = 0 AND
        audit_state = 'APPROVED' AND service_provider_id = #{param1}) t1,
        (SELECT IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 30, charge_money_num, 0)), 0) AS month_pay,
        IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 365, charge_money_num, 0)), 0) AS year_pay,
        IFNULL(SUM(charge_money_num), 0) AS all_pay FROM diyi_self_help_invoice_sp WHERE is_deleted = 0
        AND (apply_state = 'SUBMITTED' OR apply_state = 'INVOICED') AND service_provider_id = #{param1}) t2
    </select>

    <select id="queryTotalSubYearTradeByEnterprise" resultMap="yearTradeVO">
        SELECT IFNULL(SUM(IF(MONTH(create_time) = 1, pay_to_platform_amount, 0)), 0) AS jan_income, IFNULL(SUM(IF(MONTH(create_time) = 2, pay_to_platform_amount, 0)), 0) AS feb_income,
        IFNULL(SUM(IF(MONTH(create_time) = 3, pay_to_platform_amount, 0)), 0) AS mar_income, IFNULL(SUM(IF(MONTH(create_time) = 4, pay_to_platform_amount, 0)), 0) AS apr_income,
        IFNULL(SUM(IF(MONTH(create_time) = 5, pay_to_platform_amount, 0)), 0) AS may_income, IFNULL(SUM(IF(MONTH(create_time) = 6, pay_to_platform_amount, 0)), 0) AS jun_income,
        IFNULL(SUM(IF(MONTH(create_time) = 7, pay_to_platform_amount, 0)), 0) AS jul_income, IFNULL(SUM(IF(MONTH(create_time) = 8, pay_to_platform_amount, 0)), 0) AS aug_income,
        IFNULL(SUM(IF(MONTH(create_time) = 9, pay_to_platform_amount, 0)), 0) AS sep_income, IFNULL(SUM(IF(MONTH(create_time) = 10, pay_to_platform_amount, 0)), 0) AS oct_income,
        IFNULL(SUM(IF(MONTH(create_time) = 11, pay_to_platform_amount, 0)), 0) AS nov_income, IFNULL(SUM(IF(MONTH(create_time) = 12, pay_to_platform_amount, 0)), 0) AS dec_income
        FROM diyi_pay_enterprise WHERE is_deleted = 0 AND audit_state = 'APPROVED' AND YEAR(create_time) = YEAR(NOW()) AND enterprise_id = #{param1}
    </select>

    <select id="queryTotalSubYearTradeByServiceProvider" resultMap="yearTradeVO">
        SELECT IFNULL(SUM(IF(MONTH(create_time) = 1, pay_to_platform_amount, 0)), 0) AS jan_income, IFNULL(SUM(IF(MONTH(create_time) = 2, pay_to_platform_amount, 0)), 0) AS feb_income,
        IFNULL(SUM(IF(MONTH(create_time) = 3, pay_to_platform_amount, 0)), 0) AS mar_income, IFNULL(SUM(IF(MONTH(create_time) = 4, pay_to_platform_amount, 0)), 0) AS apr_income,
        IFNULL(SUM(IF(MONTH(create_time) = 5, pay_to_platform_amount, 0)), 0) AS may_income, IFNULL(SUM(IF(MONTH(create_time) = 6, pay_to_platform_amount, 0)), 0) AS jun_income,
        IFNULL(SUM(IF(MONTH(create_time) = 7, pay_to_platform_amount, 0)), 0) AS jul_income, IFNULL(SUM(IF(MONTH(create_time) = 8, pay_to_platform_amount, 0)), 0) AS aug_income,
        IFNULL(SUM(IF(MONTH(create_time) = 9, pay_to_platform_amount, 0)), 0) AS sep_income, IFNULL(SUM(IF(MONTH(create_time) = 10, pay_to_platform_amount, 0)), 0) AS oct_income,
        IFNULL(SUM(IF(MONTH(create_time) = 11, pay_to_platform_amount, 0)), 0) AS nov_income, IFNULL(SUM(IF(MONTH(create_time) = 12, pay_to_platform_amount, 0)), 0) AS dec_income
        FROM diyi_pay_enterprise WHERE is_deleted = 0 AND audit_state = 'APPROVED' AND YEAR(create_time) = YEAR(NOW()) AND service_provider_id = #{param1}
    </select>

    <select id="queryTotalSubMonthTradeByEnterprise" resultMap="monthTradeVO">
        SELECT IFNULL(SUM(IF(DAY(create_time) = 1, pay_to_platform_amount, 0)), 0) AS one_day_income, IFNULL(SUM(IF(DAY(create_time) = 2, pay_to_platform_amount, 0)), 0) AS two_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 3, pay_to_platform_amount, 0)), 0) AS three_day_income, IFNULL(SUM(IF(DAY(create_time) = 4, pay_to_platform_amount, 0)), 0) AS four_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 5, pay_to_platform_amount, 0)), 0) AS five_day_income, IFNULL(SUM(IF(DAY(create_time) = 6, pay_to_platform_amount, 0)), 0) AS six_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 7, pay_to_platform_amount, 0)), 0) AS seven_day_income, IFNULL(SUM(IF(DAY(create_time) = 8, pay_to_platform_amount, 0)), 0) AS eight_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 9, pay_to_platform_amount, 0)), 0) AS nine_day_income, IFNULL(SUM(IF(DAY(create_time) = 10, pay_to_platform_amount, 0)), 0) AS ten_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 11, pay_to_platform_amount, 0)), 0) AS eleven_day_income, IFNULL(SUM(IF(DAY(create_time) = 12, pay_to_platform_amount, 0)), 0) AS twelve_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 13, pay_to_platform_amount, 0)), 0) AS thirteen_day_income, IFNULL(SUM(IF(DAY(create_time) = 14, pay_to_platform_amount, 0)), 0) AS fourteen_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 15, pay_to_platform_amount, 0)), 0) AS fifteen_day_income, IFNULL(SUM(IF(DAY(create_time) = 16, pay_to_platform_amount, 0)), 0) AS sixteen_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 17, pay_to_platform_amount, 0)), 0) AS seventeen_day_income, IFNULL(SUM(IF(DAY(create_time) = 18, pay_to_platform_amount, 0)), 0) AS eighteen_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 19, pay_to_platform_amount, 0)), 0) AS nineteen_day_income, IFNULL(SUM(IF(DAY(create_time) = 20, pay_to_platform_amount, 0)), 0) AS twenty_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 21, pay_to_platform_amount, 0)), 0) AS twenty_one_day_income, IFNULL(SUM(IF(DAY(create_time) = 22, pay_to_platform_amount, 0)), 0) AS twenty_two_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 23, pay_to_platform_amount, 0)), 0) AS twenty_three_day_income, IFNULL(SUM(IF(DAY(create_time) = 24, pay_to_platform_amount, 0)), 0) AS twenty_four_day_income,
		IFNULL(SUM(IF(DAY(create_time) = 25, pay_to_platform_amount, 0)), 0) AS twenty_five_day_income, IFNULL(SUM(IF(DAY(create_time) = 26, pay_to_platform_amount, 0)), 0) AS twenty_six_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 27, pay_to_platform_amount, 0)), 0) AS twenty_seven_day_income, IFNULL(SUM(IF(DAY(create_time) = 28, pay_to_platform_amount, 0)), 0) AS twenty_eight_day_income,
        IF(DAY(LAST_DAY(NOW())) >= 29, IFNULL(SUM(IF(DAY(create_time) = 29, pay_to_platform_amount, 0)), 0), NULL) AS twenty_nine_day_income,
        IF(DAY(LAST_DAY(NOW())) >= 30, IFNULL(SUM(IF(DAY(create_time) = 30, pay_to_platform_amount, 0)), 0), NULL) AS thirty_day_income,
		IF(DAY(LAST_DAY(NOW())) >= 31, IFNULL(SUM(IF(DAY(create_time) = 31, pay_to_platform_amount, 0)), 0), NULL) AS thirty_one_day_income
        FROM diyi_pay_enterprise WHERE is_deleted = 0 AND audit_state = 'APPROVED' AND YEAR(create_time) = YEAR(NOW())
		AND MONTH(create_time) = MONTH(NOW()) AND enterprise_id = #{param1}
    </select>

    <select id="queryTotalSubMonthTradeByServiceProvider" resultMap="monthTradeVO">
        SELECT IFNULL(SUM(IF(DAY(create_time) = 1, pay_to_platform_amount, 0)), 0) AS one_day_income, IFNULL(SUM(IF(DAY(create_time) = 2, pay_to_platform_amount, 0)), 0) AS two_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 3, pay_to_platform_amount, 0)), 0) AS three_day_income, IFNULL(SUM(IF(DAY(create_time) = 4, pay_to_platform_amount, 0)), 0) AS four_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 5, pay_to_platform_amount, 0)), 0) AS five_day_income, IFNULL(SUM(IF(DAY(create_time) = 6, pay_to_platform_amount, 0)), 0) AS six_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 7, pay_to_platform_amount, 0)), 0) AS seven_day_income, IFNULL(SUM(IF(DAY(create_time) = 8, pay_to_platform_amount, 0)), 0) AS eight_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 9, pay_to_platform_amount, 0)), 0) AS nine_day_income, IFNULL(SUM(IF(DAY(create_time) = 10, pay_to_platform_amount, 0)), 0) AS ten_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 11, pay_to_platform_amount, 0)), 0) AS eleven_day_income, IFNULL(SUM(IF(DAY(create_time) = 12, pay_to_platform_amount, 0)), 0) AS twelve_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 13, pay_to_platform_amount, 0)), 0) AS thirteen_day_income, IFNULL(SUM(IF(DAY(create_time) = 14, pay_to_platform_amount, 0)), 0) AS fourteen_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 15, pay_to_platform_amount, 0)), 0) AS fifteen_day_income, IFNULL(SUM(IF(DAY(create_time) = 16, pay_to_platform_amount, 0)), 0) AS sixteen_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 17, pay_to_platform_amount, 0)), 0) AS seventeen_day_income, IFNULL(SUM(IF(DAY(create_time) = 18, pay_to_platform_amount, 0)), 0) AS eighteen_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 19, pay_to_platform_amount, 0)), 0) AS nineteen_day_income, IFNULL(SUM(IF(DAY(create_time) = 20, pay_to_platform_amount, 0)), 0) AS twenty_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 21, pay_to_platform_amount, 0)), 0) AS twenty_one_day_income, IFNULL(SUM(IF(DAY(create_time) = 22, pay_to_platform_amount, 0)), 0) AS twenty_two_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 23, pay_to_platform_amount, 0)), 0) AS twenty_three_day_income, IFNULL(SUM(IF(DAY(create_time) = 24, pay_to_platform_amount, 0)), 0) AS twenty_four_day_income,
		IFNULL(SUM(IF(DAY(create_time) = 25, pay_to_platform_amount, 0)), 0) AS twenty_five_day_income, IFNULL(SUM(IF(DAY(create_time) = 26, pay_to_platform_amount, 0)), 0) AS twenty_six_day_income,
        IFNULL(SUM(IF(DAY(create_time) = 27, pay_to_platform_amount, 0)), 0) AS twenty_seven_day_income, IFNULL(SUM(IF(DAY(create_time) = 28, pay_to_platform_amount, 0)), 0) AS twenty_eight_day_income,
        IF(DAY(LAST_DAY(NOW())) >= 29, IFNULL(SUM(IF(DAY(create_time) = 29, pay_to_platform_amount, 0)), 0), NULL) AS twenty_nine_day_income,
        IF(DAY(LAST_DAY(NOW())) >= 30, IFNULL(SUM(IF(DAY(create_time) = 30, pay_to_platform_amount, 0)), 0), NULL) AS thirty_day_income,
		IF(DAY(LAST_DAY(NOW())) >= 31, IFNULL(SUM(IF(DAY(create_time) = 31, pay_to_platform_amount, 0)), 0), NULL) AS thirty_one_day_income
        FROM diyi_pay_enterprise WHERE is_deleted = 0 AND audit_state = 'APPROVED' AND YEAR(create_time) = YEAR(NOW())
		AND MONTH(create_time) = MONTH(NOW()) AND service_provider_id = #{param1}
    </select>

    <select id="queryTotalSubWeekTradeByEnterprise" resultMap="weekTradeVO">
        SELECT IFNULL(SUM(IF(WEEKDAY(create_time) = 0, pay_to_platform_amount, 0)), 0) AS mon_income, IFNULL(SUM(IF(WEEKDAY(create_time) = 1, pay_to_platform_amount, 0)), 0) AS tue_income,
        IFNULL(SUM(IF(WEEKDAY(create_time) = 2, pay_to_platform_amount, 0)), 0) AS wed_income, IFNULL(SUM(IF(WEEKDAY(create_time) = 3, pay_to_platform_amount, 0)), 0) AS thu_income,
        IFNULL(SUM(IF(WEEKDAY(create_time) = 4, pay_to_platform_amount, 0)), 0) AS fri_income, IFNULL(SUM(IF(WEEKDAY(create_time) = 5, pay_to_platform_amount, 0)), 0) AS sat_income,
        IFNULL(SUM(IF(WEEKDAY(create_time) = 6, pay_to_platform_amount, 0)), 0) AS sun_income
        FROM diyi_pay_enterprise WHERE is_deleted = 0 AND audit_state = 'APPROVED' AND WEEK(create_time) = WEEK(NOW()) AND enterprise_id = #{param1}
    </select>

    <select id="queryTotalSubWeekTradeByServiceProvider" resultMap="weekTradeVO">
        SELECT IFNULL(SUM(IF(WEEKDAY(create_time) = 0, pay_to_platform_amount, 0)), 0) AS mon_income, IFNULL(SUM(IF(WEEKDAY(create_time) = 1, pay_to_platform_amount, 0)), 0) AS tue_income,
        IFNULL(SUM(IF(WEEKDAY(create_time) = 2, pay_to_platform_amount, 0)), 0) AS wed_income, IFNULL(SUM(IF(WEEKDAY(create_time) = 3, pay_to_platform_amount, 0)), 0) AS thu_income,
        IFNULL(SUM(IF(WEEKDAY(create_time) = 4, pay_to_platform_amount, 0)), 0) AS fri_income, IFNULL(SUM(IF(WEEKDAY(create_time) = 5, pay_to_platform_amount, 0)), 0) AS sat_income,
        IFNULL(SUM(IF(WEEKDAY(create_time) = 6, pay_to_platform_amount, 0)), 0) AS sun_income
        FROM diyi_pay_enterprise WHERE is_deleted = 0 AND audit_state = 'APPROVED' AND WEEK(create_time) = WEEK(NOW()) AND service_provider_id = #{param1}
    </select>

    <select id="queryTotalSubDayTradeByEnterprise" resultMap="dayTradeVO">
        SELECT IFNULL(SUM(IF(HOUR(create_time) = 1, pay_to_platform_amount, 0)), 0) AS one_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 2, pay_to_platform_amount, 0)), 0) AS two_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 3, pay_to_platform_amount, 0)), 0) AS three_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 4, pay_to_platform_amount, 0)), 0) AS four_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 5, pay_to_platform_amount, 0)), 0) AS five_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 6, pay_to_platform_amount, 0)), 0) AS six_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 7, pay_to_platform_amount, 0)), 0) AS seven_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 8, pay_to_platform_amount, 0)), 0) AS eight_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 9, pay_to_platform_amount, 0)), 0) AS nine_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 10, pay_to_platform_amount, 0)), 0) AS ten_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 11, pay_to_platform_amount, 0)), 0) AS eleven_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 12, pay_to_platform_amount, 0)), 0) AS twelve_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 13, pay_to_platform_amount, 0)), 0) AS thirteen_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 14, pay_to_platform_amount, 0)), 0) AS fourteen_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 15, pay_to_platform_amount, 0)), 0) AS fifteen_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 16, pay_to_platform_amount, 0)), 0) AS sixteen_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 17, pay_to_platform_amount, 0)), 0) AS seventeen_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 18, pay_to_platform_amount, 0)), 0) AS eighteen_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 19, pay_to_platform_amount, 0)), 0) AS nineteen_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 20, pay_to_platform_amount, 0)), 0) AS twenty_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 21, pay_to_platform_amount, 0)), 0) AS twenty_one_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 22, pay_to_platform_amount, 0)), 0) AS twenty_two_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 23, pay_to_platform_amount, 0)), 0) AS twenty_three_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 0, pay_to_platform_amount, 0)), 0) AS twenty_four_hour_income
        FROM diyi_pay_enterprise WHERE is_deleted = 0 AND audit_state = 'APPROVED' AND DATE(create_time) = DATE(NOW()) AND enterprise_id = #{param1}
    </select>

    <select id="queryTotalSubDayTradeByServiceProvider" resultMap="dayTradeVO">
        SELECT IFNULL(SUM(IF(HOUR(create_time) = 1, pay_to_platform_amount, 0)), 0) AS one_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 2, pay_to_platform_amount, 0)), 0) AS two_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 3, pay_to_platform_amount, 0)), 0) AS three_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 4, pay_to_platform_amount, 0)), 0) AS four_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 5, pay_to_platform_amount, 0)), 0) AS five_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 6, pay_to_platform_amount, 0)), 0) AS six_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 7, pay_to_platform_amount, 0)), 0) AS seven_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 8, pay_to_platform_amount, 0)), 0) AS eight_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 9, pay_to_platform_amount, 0)), 0) AS nine_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 10, pay_to_platform_amount, 0)), 0) AS ten_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 11, pay_to_platform_amount, 0)), 0) AS eleven_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 12, pay_to_platform_amount, 0)), 0) AS twelve_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 13, pay_to_platform_amount, 0)), 0) AS thirteen_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 14, pay_to_platform_amount, 0)), 0) AS fourteen_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 15, pay_to_platform_amount, 0)), 0) AS fifteen_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 16, pay_to_platform_amount, 0)), 0) AS sixteen_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 17, pay_to_platform_amount, 0)), 0) AS seventeen_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 18, pay_to_platform_amount, 0)), 0) AS eighteen_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 19, pay_to_platform_amount, 0)), 0) AS nineteen_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 20, pay_to_platform_amount, 0)), 0) AS twenty_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 21, pay_to_platform_amount, 0)), 0) AS twenty_one_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 22, pay_to_platform_amount, 0)), 0) AS twenty_two_hour_income,
        IFNULL(SUM(IF(HOUR(create_time) = 23, pay_to_platform_amount, 0)), 0) AS twenty_three_hour_income, IFNULL(SUM(IF(HOUR(create_time) = 0, pay_to_platform_amount, 0)), 0) AS twenty_four_hour_income
        FROM diyi_pay_enterprise WHERE is_deleted = 0 AND audit_state = 'APPROVED' AND DATE(create_time) = DATE(NOW()) AND service_provider_id = #{param1}
    </select>

    <select id="getServiceLumpSumInvoiceDetails" resultMap="InvoiceServiceLumpDetailsMap">
        SELECT pe.id AS pay_enterprise_id, e.id AS enterprise_id, a.id AS address_id, pi.id AS invoice_print_id, pil.id AS invoice_detail_id, pe.pay_to_platform_amount, ( SELECT invoice_catalog_name FROM diyi_enterprise_provider_invoice_catalogs ic WHERE ic.id = ia.invoice_catalog_id ) AS invoice_catalog_name, e.enterprise_name, e.invoice_enterprise_name, e.invoice_tax_no, e.invoice_address_phone, e.invoice_bank_name_account, sp.service_provider_name, pe.charge_list_url, pe.worksheet_id, pe.company_invoice_state, pe.create_time, a.address_name, a.address_phone, a.area, a.city, a.province, a.detailed_address, pi.express_sheet_no, pi.express_company_name, pil.company_invoice_url, pil.invoice_type_no, pil.invoice_serial_no, pil.invoice_category, pi.invoice_desc FROM diyi_pay_enterprise pe INNER JOIN diyi_enterprise e ON pe.enterprise_id = e.id left JOIN diyi_address a ON a.object_id = pe.enterprise_id AND a.is_default = 1 AND a.object_type = 'ENTERPRISEPEOPLE' INNER JOIN diyi_service_provider sp ON sp.id = pe.service_provider_id LEFT JOIN diyi_platform_invoice_pay_list pl ON pl.pay_enterprise_id = pe.id LEFT JOIN diyi_platform_invoice pi ON pl.invoice_print_id = pi.id LEFT JOIN diyi_platform_invoice_list pil ON pil.invoice_print_id = pi.id LEFT JOIN diyi_invoice_application_pay_list iapl ON iapl.pay_enterprise_id = pe.id LEFT JOIN diyi_invoice_application ia ON ia.id = iapl.application_id AND ia.application_state IN ( 'APPLYING', 'ISSUEDINFULL', 'PARTIALLYISSUED' ) WHERE pe.id = #{param1}
    </select>

    <select id="getSubcontractInvoice" resultMap="invoiceServiceSubcontractMap">
        SELECT pe.id AS pay_enterprise_id, e.id AS enterprise_id,pe.maker_invoice_type, e.enterprise_name,
        pe.charge_list_url, IF (( SELECT COUNT(*) FROM diyi_PAY_ENTERPRISE_RECEIPT per WHERE per.pay_enterprise_id =
        pe.id ) > 0, '是', '否' ) AS isPayEnterpriseReceipt, pe.subcontracting_invoice_state, pe.create_time FROM
        diyi_pay_enterprise pe INNER JOIN diyi_enterprise e ON e.id = pe.enterprise_id
        where pe.subcontracting_invoice_state = 'UNOPEN'
        <if test="param1 !=null">
            and pe.service_provider_id = #{param1}
        </if>
        <if test="param2 !=null and param2 != ''">
            AND e.enterprise_name LIKE concat('%', #{param2}, '%')
        </if>
        <if test="param3 !=null and param3 != ''">
            AND pe.create_time > #{param3}
        </if>
        <if test="param4 !=null and param4 != ''">
            AND pe.create_time &lt; #{param4}
        </if>
    </select>

    <select id="getSubcontractInvoiceDetails" resultMap="invoiceServiceSubDetailsMap">
        SELECT pe.id AS pay_enterprise_id, e.id AS enterprise_id, pe.pay_to_platform_amount, e.enterprise_name, e.invoice_tax_no, e.invoice_address_phone,
        e.invoice_bank_name_account, sp.service_provider_name, pe.charge_list_url, pe.worksheet_id, pe.subcontracting_invoice_state, pe.create_time
        FROM diyi_pay_enterprise pe INNER JOIN diyi_enterprise e ON pe.enterprise_id = e.id INNER JOIN diyi_service_provider sp ON sp.id = pe.service_provider_id
        where pe.id=#{param1}
    </select>

    <select id="getServiceSummaryInvoice" resultMap="invoiceServiceSubcontractMap">
        SELECT pe.id AS pay_enterprise_id, e.id AS enterprise_id, pe.maker_invoice_type, e.enterprise_name,
        pe.charge_list_url, IF (( SELECT COUNT(*) FROM diyi_PAY_ENTERPRISE_RECEIPT per WHERE per.pay_enterprise_id =
        pe.id ) > 0, '是', '否' ) AS isPayEnterpriseReceipt, pe.subcontracting_invoice_state, pe.create_time FROM
        diyi_pay_enterprise pe INNER JOIN diyi_enterprise e ON e.id = pe.enterprise_id INNER JOIN
        diyi_MAKER_TOTAL_INVOICE m ON m.pay_enterprise_id = pe.id
        where pe.subcontracting_invoice_state = 'OPENED'
        <if test="param1 !=null">
            AND pe.service_provider_id = #{param1}
        </if>
        <if test="param2 !=null and param2 != ''">
            AND e.enterprise_name LIKE concat('%', #{param2}, '%')
        </if>
        <if test="param3 !=null and param3 != ''">
            AND pe.create_time > #{param3}
        </if>
        <if test="param4 !=null and param4 != ''">
            AND pe.create_time &lt; #{param4}
        </if>
    </select>

    <select id="getServicePortalSignInvoice" resultMap="invoiceServiceSubcontractMap">
        SELECT pe.id AS pay_enterprise_id, e.id AS enterprise_id, pe.maker_invoice_type, e.enterprise_name,
        pe.charge_list_url, IF (( SELECT COUNT(*) FROM diyi_PAY_ENTERPRISE_RECEIPT per WHERE per.pay_enterprise_id =
        pe.id ) > 0, '是', '否' ) AS isPayEnterpriseReceipt, pe.subcontracting_invoice_state, pe.create_time FROM
        diyi_pay_enterprise pe INNER JOIN diyi_enterprise e ON e.id = pe.enterprise_id INNER JOIN diyi_pay_maker pm ON
        pm.pay_enterprise_id = pe.id INNER JOIN diyi_maker_invoice mi ON mi.pay_maker_id = pm.id
        where pe.subcontracting_invoice_state = 'OPENED'
        <if test="param1 !=null">
            AND pe.service_provider_id = #{param1}
        </if>
        <if test="param2 !=null and param2 != ''">
            AND e.enterprise_name LIKE concat('%', #{param2}, '%')
        </if>
        <if test="param3 !=null and param3 != ''">
            AND pe.create_time > #{param3}
        </if>
        <if test="param4 !=null and param4 != ''">
            AND pe.create_time &lt; #{param4}
        </if>
    </select>

    <!--查询相关局匹配的服务商流水统计-->
    <select id="transactionByBureauServiceProvider" resultMap="transactionVO">
        SELECT t1.month_pay AS total_sub_month_pay,
        t1.year_pay AS total_sub_year_pay,
        t1.all_pay AS total_sub_all_pay,
        t2.month_pay AS crowd_month_pay,
        t2.year_pay AS crowd_year_pay,
        t2.all_pay AS crowd_all_pay,
        (SELECT COUNT(DISTINCT id) FROM diyi_service_provider_maker WHERE service_provider_id IN
        (SELECT GROUP_CONCAT(service_provider_id) FROM diyi_rel_bureau_service_provider WHERE rel_bureau_id = #{bureauId})) AS maker_num,
        (SELECT COUNT(id) FROM diyi_rel_bureau_service_provider WHERE rel_bureau_id = #{bureauId}) AS service_provider_num FROM
        (SELECT IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) &lt;= 30, pay_to_platform_amount, 0)), 0) AS month_pay,
        IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) &lt;= 365, pay_to_platform_amount, 0)), 0) AS year_pay,
        IFNULL(SUM(pay_to_platform_amount), 0) AS all_pay
        FROM diyi_pay_enterprise WHERE is_deleted = 0
        AND audit_state = 'APPROVED'
        AND service_provider_id IN
        (SELECT GROUP_CONCAT(service_provider_id) FROM diyi_rel_bureau_service_provider WHERE rel_bureau_id = #{bureauId})) t1,
        (SELECT IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) &lt;= 30, charge_money_num, 0)), 0) AS month_pay,
        IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) &lt;= 365, charge_money_num, 0)), 0) AS year_pay,
        IFNULL(SUM(charge_money_num), 0) AS all_pay
        FROM diyi_self_help_invoice_sp
        WHERE is_deleted = 0
        AND (apply_state = 'SUBMITTED' OR apply_state = 'INVOICED')
        AND service_provider_id IN
        (SELECT GROUP_CONCAT(service_provider_id) FROM diyi_rel_bureau_service_provider WHERE rel_bureau_id = #{bureauId})) t2
    </select>

    <!--查询相关局匹配的服务商基本信息及交易金额-->
    <select id="transactionByBureauServiceProviderInfo" resultMap="transactionByBureauServiceProviderInfoVO">
        SELECT t1.id,t1.service_provider_name,t2.total_money,t3.bureau_service_provider_status,t3.create_time,t3.id as bureau_service_provider_id
        FROM diyi_service_provider t1 JOIN (
        (SELECT (IFNULL(total.all_pay,0) + IFNULL(many.all_pay,0)) as 'total_money',
        total.service_provider_id FROM
        (SELECT IFNULL(SUM(pay_to_platform_amount), 0) AS all_pay,
        service_provider_id
        FROM diyi_pay_enterprise WHERE is_deleted = 0
        AND audit_state = 'APPROVED'
        GROUP BY service_provider_id) total
        LEFT JOIN
        (SELECT IFNULL(SUM(charge_money_num), 0) AS all_pay ,
        service_provider_id
        FROM diyi_self_help_invoice_sp
        WHERE is_deleted = 0
        AND (apply_state = 'SUBMITTED' OR apply_state = 'INVOICED')
        GROUP BY service_provider_id) many
        ON total.service_provider_id = many.service_provider_id)
        UNION
        (SELECT (IFNULL(total.all_pay,0) + IFNULL(many.all_pay,0)) as 'total_money',
        many.service_provider_id FROM
        (SELECT IFNULL(SUM(pay_to_platform_amount), 0) AS all_pay,
        service_provider_id
        FROM diyi_pay_enterprise WHERE is_deleted = 0
        AND audit_state = 'APPROVED'
        GROUP BY service_provider_id) total
        RIGHT JOIN
        (SELECT IFNULL(SUM(charge_money_num), 0) AS all_pay ,
        service_provider_id
        FROM diyi_self_help_invoice_sp
        WHERE is_deleted = 0
        AND (apply_state = 'SUBMITTED' OR apply_state = 'INVOICED')
        GROUP BY service_provider_id) many
        ON total.service_provider_id = many.service_provider_id)) t2
        ON t1.id = t2.service_provider_id
        JOIN diyi_rel_bureau_service_provider t3
        ON t3.service_provider_id = t1.id
        WHERE t3.rel_bureau_id = #{bureauId}
    </select>

    <select id="getTransactionByAgentMainId" resultMap="agentMainTransactionVO">
        SELECT SUM(t1.month_pay) AS total_sub_month_pay, SUM(t1.year_pay) AS total_sub_year_pay, SUM(t1.all_pay) AS total_sub_all_pay, SUM(t2.month_pay)
        AS crowd_month_pay, SUM(t2.year_pay) AS crowd_year_pay, SUM(t2.all_pay) AS crowd_all_pay, ( SELECT COUNT(1) FROM diyi_agent_provider WHERE is_deleted = 0
        AND agent_main_id = #{param1}) AS service_provider_num, ( SELECT COUNT(DISTINCT id) FROM diyi_service_provider_maker WHERE service_provider_id
        IN ( SELECT GROUP_CONCAT(service_provider_id) FROM diyi_agent_provider WHERE is_deleted = 0 AND agent_main_id = #{param1})) AS maker_num FROM
        (SELECT IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 30, pay_to_platform_amount, 0 )), 0 ) AS month_pay, IFNULL( SUM( IF ( DATEDIFF(NOW(),
        create_time) <![CDATA[ < ]]> 365, pay_to_platform_amount, 0 )), 0 ) AS year_pay, IFNULL( SUM(pay_to_platform_amount), 0 ) AS all_pay FROM diyi_pay_enterprise
        WHERE is_deleted = 0 AND audit_state = 'APPROVED' AND service_provider_id IN (SELECT GROUP_CONCAT(service_provider_id) FROM diyi_agent_provider WHERE is_deleted = 0
        AND agent_main_id = #{param1} )) t1, ( SELECT IFNULL( SUM( IF ( DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 30, charge_money_num, 0 )), 0 )
        AS month_pay, IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 365, charge_money_num, 0 )), 0 ) AS year_pay, IFNULL(SUM(charge_money_num), 0)
        AS all_pay FROM diyi_self_help_invoice_sp WHERE is_deleted = 0 AND ( apply_state = 'SUBMITTED' OR apply_state = 'INVOICED' ) AND service_provider_id
        IN (SELECT GROUP_CONCAT(service_provider_id) FROM diyi_agent_provider WHERE is_deleted = 0 AND agent_main_id = #{param1})) t2
    </select>

    <select id="getAgentMainServiceProviderList" resultMap="adminAgentMainServiceProviderListVO">
        SELECT t3.id,t1.id as service_provider_id,t1.service_provider_name,t2.total_money,t3.cooperate_status,t3.start_datetime
        FROM diyi_service_provider t1 JOIN (
        (SELECT (IFNULL(total.all_pay,0) + IFNULL(many.all_pay,0)) as 'total_money',
        total.service_provider_id FROM
        (SELECT IFNULL(SUM(pay_to_platform_amount), 0) AS all_pay,
        service_provider_id
        FROM diyi_pay_enterprise WHERE is_deleted = 0
        AND audit_state = 'APPROVED'
        GROUP BY service_provider_id) total
        LEFT JOIN
        (SELECT IFNULL(SUM(charge_money_num), 0) AS all_pay ,
        service_provider_id
        FROM diyi_self_help_invoice_sp
        WHERE is_deleted = 0
        AND (apply_state = 'SUBMITTED' OR apply_state = 'INVOICED')
        GROUP BY service_provider_id) many
        ON total.service_provider_id = many.service_provider_id)
        UNION
        (SELECT (IFNULL(total.all_pay,0) + IFNULL(many.all_pay,0)) as 'total_money',
        many.service_provider_id FROM
        (SELECT IFNULL(SUM(pay_to_platform_amount), 0) AS all_pay,
        service_provider_id
        FROM diyi_pay_enterprise WHERE is_deleted = 0
        AND audit_state = 'APPROVED'
        GROUP BY service_provider_id) total
        RIGHT JOIN
        (SELECT IFNULL(SUM(charge_money_num), 0) AS all_pay ,
        service_provider_id
        FROM diyi_self_help_invoice_sp
        WHERE is_deleted = 0
        AND (apply_state = 'SUBMITTED' OR apply_state = 'INVOICED')
        GROUP BY service_provider_id) many
        ON total.service_provider_id = many.service_provider_id)) t2
        ON t1.id = t2.service_provider_id
        JOIN diyi_agent_provider t3
        ON t3.service_provider_id = t1.id
        WHERE t3.agent_main_id = #{param1}
    </select>


    <select id="getAllTransaction" resultMap="agentMainTransactionVO">
        SELECT t1.month_pay AS total_sub_month_pay,
        t1.year_pay AS total_sub_year_pay,
        t1.all_pay AS total_sub_all_pay,
        t2.month_pay AS crowd_month_pay,
        t2.year_pay AS crowd_year_pay,
        t2.all_pay AS crowd_all_pay,
        (SELECT COUNT(DISTINCT id) FROM diyi_service_provider_maker ) AS maker_num,
        (SELECT COUNT(id) FROM diyi_service_provider) AS service_provider_num FROM
        (SELECT IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 30, pay_to_platform_amount, 0)), 0) AS month_pay,
        IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 365, pay_to_platform_amount, 0)), 0) AS year_pay,
        IFNULL(SUM(pay_to_platform_amount), 0) AS all_pay
        FROM diyi_pay_enterprise WHERE is_deleted = 0
        AND audit_state = 'APPROVED') t1,
        (SELECT IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 30, charge_money_num, 0)), 0) AS month_pay,
        IFNULL(SUM(IF(DATEDIFF(NOW(), create_time) <![CDATA[ < ]]> 365, charge_money_num, 0)), 0) AS year_pay,
        IFNULL(SUM(charge_money_num), 0) AS all_pay
        FROM diyi_self_help_invoice_sp
        WHERE is_deleted = 0
        AND (apply_state = 'SUBMITTED' OR apply_state = 'INVOICED')) t2
    </select>

    <select id="getPartnerAllServiceProvider" resultMap="partnerServiceProviderListVO">
        SELECT t1.id as service_provider_id,t1.service_provider_name,t2.total_money,t1.create_time
        FROM diyi_service_provider t1 JOIN (
        (SELECT (IFNULL(total.all_pay,0) + IFNULL(many.all_pay,0)) as total_money,
        total.service_provider_id FROM
        (SELECT IFNULL(SUM(pay_to_platform_amount), 0) AS all_pay,
        service_provider_id
        FROM diyi_pay_enterprise WHERE is_deleted = 0
        AND audit_state = 'APPROVED'
        GROUP BY service_provider_id) total
        LEFT JOIN
        (SELECT IFNULL(SUM(charge_money_num), 0) AS all_pay ,
        service_provider_id
        FROM diyi_self_help_invoice_sp
        WHERE is_deleted = 0
        AND (apply_state = 'SUBMITTED' OR apply_state = 'INVOICED')
        GROUP BY service_provider_id) many
        ON total.service_provider_id = many.service_provider_id)
        UNION
        (SELECT (IFNULL(total.all_pay,0) + IFNULL(many.all_pay,0)) as total_money,
        many.service_provider_id FROM
        (SELECT IFNULL(SUM(pay_to_platform_amount), 0) AS all_pay,
        service_provider_id
        FROM diyi_pay_enterprise WHERE is_deleted = 0
        AND audit_state = 'APPROVED'
        GROUP BY service_provider_id) total
        RIGHT JOIN
        (SELECT IFNULL(SUM(charge_money_num), 0) AS all_pay ,
        service_provider_id
        FROM diyi_self_help_invoice_sp
        WHERE is_deleted = 0
        AND (apply_state = 'SUBMITTED' OR apply_state = 'INVOICED')
        GROUP BY service_provider_id) many
        ON total.service_provider_id = many.service_provider_id)) t2
        ON t1.id = t2.service_provider_id
    </select>

    <select id="queryTotalInvoiceListEnterprise" resultMap="totalInvoiceListEnterVOMap">
        SELECT * FROM ( SELECT a.id AS invoice_application_pay_list_id, b.id AS application_id, null AS platform_invoice_pay_list_id, null AS invoice_print_id, d.enterprise_name, e.service_provider_name, b.application_state, null AS company_invoice_state, b.create_time, 1 AS apply_state, ( SELECT sum(pay_to_platform_amount) FROM diyi_invoice_application t1 INNER JOIN diyi_invoice_application_pay_list t2 ON t1.id = t2.application_id INNER JOIN diyi_pay_enterprise t3 ON t3.id = t2.pay_enterprise_id WHERE t1.id = b.id ) AS pay_to_platform_amount FROM diyi_INVOICE_APPLICATION_PAY_LIST a INNER JOIN diyi_INVOICE_APPLICATION b ON b.id = a.application_id INNER JOIN diyi_pay_enterprise c ON c.id = a.pay_enterprise_id INNER JOIN diyi_enterprise d ON d.id = c.enterprise_id INNER JOIN diyi_service_provider e ON e.id = c.service_provider_id WHERE d.id = #{param1}
            AND b.application_state IN ( 'APPLYING', 'ISSUEDINFULL', 'PARTIALLYISSUED' ) AND c.audit_state = 'APPROVED' UNION ALL SELECT null AS invoice_application_pay_list_id, null AS invoice_application_id, a.id AS platform_invoice_pay_list_id, b.id AS invoice_print_id, d.enterprise_name, e.service_provider_name, 0 AS application_state, c.company_invoice_state, b.create_time, if(b.application_id is null,0,1) as  apply_state, ( SELECT sum(pay_to_platform_amount) FROM diyi_platform_invoice t1 INNER JOIN diyi_platform_invoice_pay_list t2 ON t1.id = t2.invoice_print_id INNER JOIN diyi_pay_enterprise t3 ON t3.id = t2.pay_enterprise_id WHERE t1.id = b.id ) AS pay_to_platform_amount FROM diyi_platform_invoice_pay_list a INNER JOIN diyi_platform_invoice b ON a.invoice_print_id = b.id INNER JOIN diyi_pay_enterprise c ON c.id = a.pay_enterprise_id INNER JOIN diyi_enterprise d ON d.id = c.enterprise_id INNER JOIN diyi_service_provider e ON e.id = c.service_provider_id WHERE d.id = #{param1} AND c.company_invoice_state = 'OPENED' AND c.audit_state = 'APPROVED' ) AS tmp WHERE 1 = 1
<!--        <if test="param2 !=null and param2 != ''">-->
<!--             AND enterprise_name like concat('%', #{param2}, '%')-->
<!--        </if>-->
        <if test="param2 !=null and param2 != ''">
            AND service_provider_name like concat('%', #{param2}, '%')
        </if>
    </select>

    <select id="queryRelationEnterpriseService" resultMap="relationEnterpriseServiceVOMap">
        SELECT a.service_provider_id, b.service_provider_name, a.cooperate_status FROM diyi_enterprise_service_provider a INNER JOIN diyi_service_provider b
        ON a.service_provider_id = b.id WHERE cooperate_status = 'COOPERATING' AND a.enterprise_id = #{param1}
        <if test="param2 !=null and param2 != ''">
             AND b.service_provider_name like concat('%', #{param2}, '%')
        </if>
    </select>

    <select id="queryEnterpriseServicePayList" resultMap="enterpriseServicePayListVOMap">
        SELECT a.id pay_enterprise_id, y.service_provider_name, a.create_time, a.charge_list_url FROM diyi_pay_enterprise a INNER JOIN diyi_service_provider y
        ON a.service_provider_id = y.id WHERE a.service_provider_id = #{param2} AND a.enterprise_id = #{param1} AND a.audit_state = 'APPROVED' AND a.company_invoice_state = 'UNOPEN' AND a.id
        NOT IN (SELECT GROUP_CONCAT(d.pay_enterprise_id) FROM diyi_invoice_application c INNER JOIN diyi_invoice_application_pay_list d ON c.id = d.application_id
        WHERE c.application_state NOT IN ( 'APPLYING', 'ISSUEDINFULL', 'PARTIALLYISSUED' ))
    </select>


    <select id="getServiceLumpSumInvoice" resultMap="invoiceServiceLumpMap">
        SELECT * FROM ( SELECT a.id AS invoice_application_pay_list_id, b.id AS invoice_application_id, null AS pay_enterprise_id, d.enterprise_name,
        e.service_provider_name, b.application_state, null AS company_invoice_state, b.create_time, b.application_desc, 1 AS apply_state,null as invoice_print_id
        FROM diyi_INVOICE_APPLICATION_PAY_LIST a INNER JOIN diyi_INVOICE_APPLICATION b ON b.id = a.application_id INNER JOIN diyi_pay_enterprise c
        ON c.id = a.pay_enterprise_id INNER JOIN diyi_enterprise d ON d.id = c.enterprise_id INNER JOIN diyi_service_provider e ON e.id = c.service_provider_id
        WHERE 1=1
        <if test="param1 != null">
            and e.id = #{param1}
        </if>
        AND b.application_state = 'APPLYING' and c.audit_state = 'APPROVED' GROUP BY b.create_time UNION ALL SELECT null AS invoice_application_pay_list_id, null AS invoice_application_id, a.id AS pay_enterprise_id, b.enterprise_name, c.service_provider_name, null AS application_state, a.company_invoice_state, a.create_time, null AS application_desc, 0 AS apply_state,null as invoice_print_id FROM diyi_pay_enterprise a INNER JOIN diyi_enterprise b ON b.id = a.enterprise_id INNER JOIN diyi_service_provider c ON c.id = a.service_provider_id WHERE a.company_invoice_state = 'UNOPEN' and a.audit_state = 'APPROVED' AND a.id NOT IN ( SELECT d.pay_enterprise_id FROM diyi_invoice_application c INNER JOIN diyi_invoice_application_pay_list d ON c.id = d.application_id WHERE c.application_state NOT IN ( 'APPLYING', 'ISSUEDINFULL', 'PARTIALLYISSUED' ))
        <if test="param1 != null">
            AND a.service_provider_id = #{param1}
        </if>
        ) AS tmp where 1 = 1
        <if test="param2 !=null and param2 != ''">
            AND tmp.enterprise_name LIKE concat('%', #{param2}, '%')
        </if>
        <if test="param3 !=null and param3 != ''">
            AND tmp.create_time > #{param3}
        </if>
        <if test="param4 !=null and param4 != ''">
            AND tmp.create_time &lt; #{param4}
        </if>
    </select>

    <select id="getServiceOpenedLumpSumInvoice" resultMap="invoiceServiceLumpMap">
       SELECT null AS invoice_application_pay_list_id, tmp.application_id AS invoice_application_id, t3.id AS pay_enterprise_id, b.enterprise_name, c.service_provider_name, null AS application_state, t3.company_invoice_state, tmp.create_time, tmp.invoice_desc AS application_desc, IF ( tmp.application_id IS NULL, 0, 1 ) AS apply_state, tmp.id AS invoice_print_id FROM diyi_platform_invoice tmp INNER JOIN diyi_platform_invoice_pay_list t2 ON tmp.id = t2.invoice_print_id INNER JOIN diyi_pay_enterprise t3 ON t3.id = t2.pay_enterprise_id INNER JOIN diyi_enterprise b ON b.id = t3.enterprise_id INNER JOIN diyi_service_provider c ON c.id = t3.service_provider_id INNER JOIN diyi_platform_invoice_list t4 ON t4.invoice_print_id = tmp.id WHERE 1 = 1
        <if test="param1">
            and c.id = #{param1}
        </if>
        <if test="param2 !=null and param2 != ''">
            AND b.enterprise_name LIKE concat('%', #{param2}, '%')
        </if>
        <if test="param3 !=null and param3 != ''">
            AND tmp.create_time > #{param3}
        </if>
        <if test="param4 !=null and param4 != ''">
            AND tmp.create_time &lt; #{param4}
        </if>
        GROUP BY tmp.id
    </select>

    <select id="findServiceSubcontractSummary" resultMap="EnterpriseSubcontractSummaryMap">
        SELECT pe.id AS pay_enterprise_id, mt.id AS maker_total_invoice_id, sp.id AS service_provider_id, mt.invoice_serial_no, mt.company_invoice_url, mt.maker_tax_url, pe.subcontracting_invoice_state, sp.service_provider_name, mt.create_time AS invoice_print_date, e.enterprise_name, pe.maker_invoice_type FROM diyi_pay_enterprise pe INNER JOIN diyi_service_provider sp ON sp.id = pe.service_provider_id INNER JOIN diyi_enterprise e ON e.id = pe.enterprise_id LEFT JOIN diyi_maker_total_invoice mt ON mt.pay_enterprise_id = pe.id AND mt.is_deleted = 0 WHERE pe.is_deleted = 0 AND sp.is_deleted = 0 and pe.audit_state ='APPROVED' AND sp.id = #{param1} and pe.subcontracting_invoice_state = #{param3}
        <if test="param2 !=null and param2 != ''">
            AND e.enterprise_name LIKE concat('%', #{param2}, '%')
        </if>

    </select>

    <select id="findServiceDetailSummary" resultMap="InvoiceServiceDetailSummaryVO">
        SELECT a.id AS pay_enterprise_id, b.id AS enterprise_id, a.pay_to_platform_amount, b.enterprise_name, b.invoice_tax_no, b.invoice_address_phone, b.invoice_bank_name_account, c.service_provider_name, a.charge_list_url, a.worksheet_id, a.subcontracting_invoice_state, a.create_time, e.company_invoice_url, e.maker_tax_url, a.maker_invoice_type FROM diyi_pay_enterprise a INNER JOIN diyi_enterprise b ON a.enterprise_id = b.id INNER JOIN diyi_service_provider c ON c.id = a.service_provider_id LEFT JOIN diyi_maker_total_invoice e ON e.pay_enterprise_id = a.id WHERE a.id = #{param1}
    </select>

    <select id="getPayMakerLists" resultMap="payMakerListsVO">
        SELECT t1.id AS pay_maker_id, t2.id AS maker_id, t2.name, t2.idcard_no, t1.maker_net_income, t1.maker_tax_fee, t1.audit_fee, t1.pay_fee, t1.total_fee, t1.service_rate, mi.maker_voice_url, mt.maker_tax_url FROM diyi_pay_maker t1 INNER JOIN diyi_maker t2 ON t1.maker_id = t2.id LEFT JOIN diyi_maker_invoice mi ON mi.pay_maker_id = t1.id LEFT JOIN diyi_maker_tax_record mt ON mt.pay_maker_id = t1.id AND t2.is_deleted = 0 WHERE t1.is_deleted = 0 AND t1.pay_enterprise_id in (#{param1})
    </select>

    <select id="queryPayEnterpriseDetail" resultMap="payEnterpriseDetailVO">
        SELECT t1.id, t2.enterprise_name, t3.service_provider_name, t1.charge_list_url, t1.worksheet_id, t1.audit_state, t1.create_time, t1.maker_invoice_type,
        t1.pay_state, t1.company_invoice_state, t1.subcontracting_invoice_state, t1.pay_to_platform_amount, (SELECT GROUP_CONCAT(enterprise_pay_receipt_url)
        FROM diyi_pay_enterprise_receipt WHERE is_deleted = 0 AND pay_enterprise_id = t1.id) AS enterprise_pay_receipt_urls, (SELECT GROUP_CONCAT(accept_paysheet_url)
        FROM diyi_accept_paysheet WHERE is_deleted = 0 AND pay_enterprise_id = t1.id) AS accept_paysheet_urls
        FROM diyi_pay_enterprise t1 INNER JOIN diyi_enterprise t2 ON t1.enterprise_id = t2.id INNER JOIN diyi_service_provider t3 ON t1.service_provider_id = t3.id
        WHERE t1.is_deleted = 0 AND t2.is_deleted = 0 AND t3.is_deleted = 0 AND t1.id = #{param1}
    </select>

    <select id="queryPayEnterpriseUpdateDetail" resultMap="payEnterpriseUpdateDetailVO">
        SELECT t1.id, t2.id AS service_provider_id, t2.service_provider_name, t1.maker_type, t1.charge_list_url, t1.worksheet_id, t3.worksheet_no, t3.worksheet_name,
        t3.create_time AS worksheet_create_time, t1.pay_to_platform_amount, t1.total_tax_fee, t1.total_maker_net_income, t1.service_rate, t1.sourcing_amount, t1.enterprise_business_annual_fee,
        t1.identify_fee, t1.service_fee, t1.maker_num, t1.pay_memo, (SELECT GROUP_CONCAT(enterprise_pay_receipt_url) FROM diyi_pay_enterprise_receipt WHERE is_deleted = 0
        AND pay_enterprise_id = t1.id) AS enterprise_pay_receipt_urls FROM diyi_pay_enterprise t1 INNER JOIN diyi_service_provider t2 ON t1.service_provider_id = t2.id
        LEFT JOIN diyi_worksheet t3 ON t1.worksheet_id = t3.id AND t3.is_deleted = 0 WHERE t1.is_deleted = 0 AND t2.is_deleted = 0 AND t1.id = #{param1}
    </select>



    <select id="queryTotalInvoiceListEnterpriseApplyDetails" resultMap="enterpriseApplyDetailVoMap">
        SELECT t1.id AS invoice_application_id, t3.id AS pay_enterprise_id, t4.enterprise_name, t3.charge_list_url, ( SELECT GROUP_CONCAT( per.enterprise_pay_receipt_url ) FROM diyi_pay_enterprise_receipt per WHERE t3.id = per.pay_enterprise_id ) AS enterprise_pay_receipt_url, t3.worksheet_id, ( SELECT GROUP_CONCAT(ap.accept_paysheet_url) FROM diyi_accept_paysheet ap WHERE accept_paysheet_type = 'MANY' AND ap.pay_enterprise_id = t3.id ) AS accept_paysheet_url, 1 AS apply_state, t1.application_desc, ( SELECT invoice_catalog_name FROM diyi_enterprise_provider_invoice_catalogs esp WHERE t1.invoice_catalog_id = esp.id ) AS invoice_catalog_name, t3.pay_to_platform_amount, t5.service_provider_name, t1.application_state, t1.create_time, t4.invoice_enterprise_name, t4.invoice_tax_no, t4.invoice_address_phone, t4.invoice_bank_name_account, t6.address_name, t6.address_phone, t6.area, t6.city, t6.province, t6.detailed_address FROM diyi_invoice_application t1 INNER JOIN diyi_invoice_application_pay_list t2 ON t2.application_id = t1.id INNER JOIN diyi_pay_enterprise t3 ON t3.id = t2.pay_enterprise_id INNER JOIN diyi_enterprise t4 ON t4.id = t3.enterprise_id INNER JOIN diyi_service_provider t5 ON t5.id = t3.service_provider_id left JOIN diyi_address t6 ON t6.object_id = t4.id AND t6.object_type = 'ENTERPRISEPEOPLE' AND t6.is_default = 1 AND t6.is_deleted = 0 WHERE t1.is_deleted = 0 AND t2.is_deleted = 0 AND t3.is_deleted = 0 AND t4.is_deleted = 0 AND t5.is_deleted = 0 and t1.id = #{param1}
    </select>

    <select id="queryTotalInvoiceListEnterpriseInvoiceDetails" resultMap="enterpriseInvoiceDetailVoMap">
        SELECT t1.id AS invoice_print_id, t3.id AS pay_enterprise_id, t4.enterprise_name, t3.charge_list_url, ( SELECT GROUP_CONCAT( per.enterprise_pay_receipt_url ) FROM diyi_pay_enterprise_receipt per WHERE t3.id = per.pay_enterprise_id ) AS enterprise_pay_receipt_url, t3.worksheet_id, ( SELECT GROUP_CONCAT(ap.accept_paysheet_url) FROM diyi_accept_paysheet ap WHERE accept_paysheet_type = 'MANY' AND ap.pay_enterprise_id = t3.id ) AS accept_paysheet_url, ( IF ( t1.application_id IS NULL, 0, 1 )) AS apply_state, t1.invoice_desc, ( SELECT invoice_category FROM diyi_platform_invoice_list esp WHERE t1.id = esp.invoice_print_id ) AS invoice_category, t3.pay_to_platform_amount, t5.service_provider_name, t3.company_invoice_state, t1.create_time, t4.invoice_enterprise_name, t4.invoice_tax_no, t4.invoice_address_phone, t4.invoice_bank_name_account, t6.address_name, t6.address_phone, t6.area, t6.city, t6.province, t6.detailed_address, ( SELECT GROUP_CONCAT(company_invoice_url) FROM diyi_platform_invoice_list pli WHERE pli.invoice_print_id = t1.id ) AS company_invoice_url, t1.express_sheet_no, t1.express_company_name FROM diyi_platform_invoice t1 INNER JOIN diyi_platform_invoice_pay_list t2 ON t1.id = t2.invoice_print_id INNER JOIN diyi_pay_enterprise t3 ON t3.id = t2.pay_enterprise_id INNER JOIN diyi_enterprise t4 ON t4.id = t3.enterprise_id INNER JOIN diyi_service_provider t5 ON t5.id = t3.service_provider_id left JOIN diyi_address t6 ON t6.object_id = t4.id AND t6.object_type = 'ENTERPRISEPEOPLE' AND t6.is_default = 1 AND t6.is_deleted = 0 WHERE t1.is_deleted = 0 AND t2.is_deleted = 0 AND t3.is_deleted = 0 AND t4.is_deleted = 0 AND t5.is_deleted = 0 AND t1.id = #{param1}
    </select>

    <select id="queryTotalMergeInvoice" resultMap="totalMergeInvoiceVoMap">
        SELECT t3.id AS pay_enterprise_id, t4.enterprise_name, t3.charge_list_url, ( SELECT GROUP_CONCAT( per.enterprise_pay_receipt_url ) FROM diyi_pay_enterprise_receipt per WHERE t3.id = per.pay_enterprise_id ) AS enterprise_pay_receipt_url, t3.worksheet_id, ( SELECT GROUP_CONCAT(ap.accept_paysheet_url) FROM diyi_accept_paysheet ap WHERE accept_paysheet_type = 'MANY' AND ap.pay_enterprise_id = t3.id ) AS accept_paysheet_url, t3.pay_to_platform_amount, t5.service_provider_name, t4.invoice_enterprise_name, t4.invoice_tax_no, t4.invoice_address_phone, t4.invoice_bank_name_account, t6.address_name, t6.address_phone, t6.area, t6.city, t6.province, t6.detailed_address, t3.company_invoice_state, t3.create_time FROM diyi_pay_enterprise t3 INNER JOIN diyi_enterprise t4 ON t4.id = t3.enterprise_id INNER JOIN diyi_service_provider t5 ON t5.id = t3.service_provider_id left JOIN diyi_address t6 ON t6.object_id = t4.id AND t6.object_type = 'ENTERPRISEPEOPLE' AND t6.is_default = 1 AND t6.is_deleted = 0 WHERE t3.is_deleted = 0 AND t4.is_deleted = 0 AND t5.is_deleted = 0 AND t3.id IN (#{param1})
    </select>
</mapper>

